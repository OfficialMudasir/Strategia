"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[82592],{82592:(k,d,i)=>{i.r(d),i.d(d,{MaintenanceModule:()=>P});var p=i(91170),h=i(64369),b=i(58127),s=i(37857);const w=function v(n){return function(l){return n?.[l]}}({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});var y=i(76506),m=/[&<>"']/g,S=RegExp(m.source);var A=i(28746),e=i(41571),N=i(83824),f=i(36895),u=i(59241),_=i(55317),L=i(73565),R=i(34201);function E(n,l){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",21),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.sendNewVersionAvailableNotification())}),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()}2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"SendNewVersionNotification")," "))}function O(n,l){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",22),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.clearAllCaches())}),e.\u0275\u0275element(1,"i",23),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd()}2&n&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,1,"ClearAll")," "))}function z(n,l){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tr")(1,"td")(2,"span"),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"button",24),e.\u0275\u0275listener("click",function(){const r=e.\u0275\u0275restoreView(t).$implicit,c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.clearCache(r.name))}),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275elementEnd()()()}if(2&n){const t=l.$implicit;e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.name),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(6,2,"Clear")," ")}}function F(n,l){if(1&n&&(e.\u0275\u0275elementStart(0,"span",25)(1,"span"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()),2&n){const t=l.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275classMap(a.getLogClass(t)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(a.getLogType(t)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",a.getRawLogContent(t)," ")}}const T=[{path:"",component:(()=>{class n extends b.c{constructor(t,a,o,r,c){super(t),this._cacheService=a,this._webLogService=o,this._fileDownloadService=r,this._notificationService=c,this.loading=!1,this.caches=null,this.canClearAllCaches=!1,this.logs="",this.downloadWebLogs=function(){const g=this;g._webLogService.downloadWebLogs().subscribe(j=>{g._fileDownloadService.downloadTempFile(j)})}}sendNewVersionAvailableNotification(){abp.message.confirm(this.l("SendNewVersionNotificationWarningMessage"),null,t=>{t&&this._notificationService.createNewVersionReleasedNotification().subscribe(a=>{abp.notify.info(this.l("SuccessfullySentNewVersionNotification"))})})}getCaches(){const t=this;t.loading=!0,t._cacheService.getAllCaches().pipe((0,A.x)(()=>{t.loading=!1})).subscribe(a=>{t.caches=a.items})}clearCache(t){const a=this,o=new s.IRy;o.id=t,a._cacheService.clearCache(o).subscribe(()=>{a.notify.success(a.l("CacheSuccessfullyCleared"))})}clearAllCaches(){const t=this;t._cacheService.clearAllCaches().subscribe(()=>{t.notify.success(t.l("AllCachesSuccessfullyCleared"))})}getWebLogs(){const t=this;t._webLogService.getLatestWebLogs().subscribe(a=>{t.logs=a.latestWebLogLines,t.fixWebLogsPanelHeight()})}setCanClearAllCaches(){this._cacheService.canClearAllCaches().subscribe(t=>{this.canClearAllCaches=t})}getLogClass(t){return t.startsWith("DEBUG")?"badge badge-dark":t.startsWith("INFO")?"badge badge-info":t.startsWith("WARN")?"badge badge-warning":t.startsWith("ERROR")||t.startsWith("FATAL")?"badge badge-danger":""}getLogType(t){return t.startsWith("DEBUG")?"DEBUG":t.startsWith("INFO")?"INFO":t.startsWith("WARN")?"WARN":t.startsWith("ERROR")?"ERROR":t.startsWith("FATAL")?"FATAL":""}getRawLogContent(t){return function I(n){return(n=(0,y.Z)(n))&&S.test(n)?n.replace(m,w):n}(t).replace("DEBUG","").replace("INFO","").replace("WARN","").replace("ERROR","").replace("FATAL","")}fixWebLogsPanelHeight(){let t=document.getElementsByClassName("full-height")[0];const a=document.body.clientHeight,o=t.clientHeight;t.style.height=o+(a-o)-420+"px"}onResize(t){this.fixWebLogsPanelHeight()}ngOnInit(){const t=this;t.getCaches(),t.getWebLogs(),t.setCanClearAllCaches()}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(e.Injector),e.\u0275\u0275directiveInject(s.riO),e.\u0275\u0275directiveInject(s.jf7),e.\u0275\u0275directiveInject(N._),e.\u0275\u0275directiveInject(s.IMf))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["ng-component"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:44,vars:30,consts:[[3,"resize"],[3,"title"],["role","actions"],["id","SendNewVersionNotification","class","btn btn-primary",3,"click",4,"ngIf"],[1,"card","card-custom","gutter-b"],[1,"card-body"],[3,"heading"],[1,"row","m-3"],[1,"col-xl-6"],[1,"mt-5"],[1,"col-xl-6","text-end"],["class","btn btn-primary float-end",3,"click",4,"ngIf"],[1,"col-xl-12"],[1,"table","table-striped","table-hover","table-bordered"],[4,"ngFor","ngForOf"],[1,"btn","btn-secondary","me-2",3,"click"],[1,"fa","fa-download"],[1,"btn","btn-primary",3,"click"],[1,"bi","bi-arrow-repeat"],[1,"web-log-view","full-height"],["class","log-line",4,"ngFor","ngForOf"],["id","SendNewVersionNotification",1,"btn","btn-primary",3,"click"],[1,"btn","btn-primary","float-end",3,"click"],[1,"fa","fa-recycle"],[1,"btn","btn-primary","btn-sm","pull-right",3,"click"],[1,"log-line"]],template:function(t,a){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275listener("resize",function(r){return a.onResize(r)},!1,e.\u0275\u0275resolveWindow),e.\u0275\u0275elementStart(1,"sub-header",1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementStart(3,"div",2),e.\u0275\u0275template(4,E,3,3,"button",3),e.\u0275\u0275pipe(5,"permission"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"div")(7,"div",4)(8,"div",5)(9,"tabset")(10,"tab",6),e.\u0275\u0275pipe(11,"localize"),e.\u0275\u0275elementStart(12,"div",7)(13,"div",8)(14,"p",9),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"localize"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(17,"div",10),e.\u0275\u0275template(18,O,4,3,"button",11),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(19,"div",7)(20,"div",12)(21,"table",13)(22,"tbody"),e.\u0275\u0275template(23,z,7,4,"tr",14),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(24,"tab",6),e.\u0275\u0275pipe(25,"localize"),e.\u0275\u0275elementStart(26,"div",7)(27,"div",8)(28,"p",9),e.\u0275\u0275text(29),e.\u0275\u0275pipe(30,"localize"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(31,"div",10)(32,"button",15),e.\u0275\u0275listener("click",function(){return a.downloadWebLogs()}),e.\u0275\u0275element(33,"i",16),e.\u0275\u0275text(34),e.\u0275\u0275pipe(35,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(36,"button",17),e.\u0275\u0275listener("click",function(){return a.getWebLogs()}),e.\u0275\u0275element(37,"i",18),e.\u0275\u0275text(38),e.\u0275\u0275pipe(39,"localize"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(40,"div",7)(41,"div",12)(42,"div",19),e.\u0275\u0275template(43,F,4,4,"span",20),e.\u0275\u0275elementEnd()()()()()()()()()),2&t&&(e.\u0275\u0275property("@routerTransition",void 0),e.\u0275\u0275advance(1),e.\u0275\u0275property("title",e.\u0275\u0275pipeBind1(2,14,"Maintenance")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(5,16,"Pages_Administration_NewVersion_Create")),e.\u0275\u0275advance(2),e.\u0275\u0275classMap(a.containerClass),e.\u0275\u0275advance(4),e.\u0275\u0275propertyInterpolate1("heading"," ",e.\u0275\u0275pipeBind1(11,18,"Caches"),""),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(16,20,"CachesHeaderInfo")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",a.canClearAllCaches),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngForOf",a.caches),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("heading",e.\u0275\u0275pipeBind1(25,22,"WebSiteLogs")),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(30,24,"WebSiteLogsHeaderInfo")),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(35,26,"DownloadAll")," "),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(39,28,"Refresh")," "),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngForOf",a.logs))},dependencies:[f.sg,f.O5,u.wW,u.AH,_.$,L.F,R.a],styles:[".web-log-view[_ngcontent-%COMP%]{font-family:Courier New;overflow-x:scroll;overflow-y:scroll;height:100%;white-space:nowrap}.web-log-view[_ngcontent-%COMP%]   span.log-line[_ngcontent-%COMP%]{margin-bottom:5px;display:block}.web-log-view[_ngcontent-%COMP%]   span.log-line[_ngcontent-%COMP%]   span.label[_ngcontent-%COMP%]{width:50px;display:inline-block}"],data:{animation:[(0,h.MH)()]}}),n})(),pathMatch:"full"}];let B=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.Bz.forChild(T),p.Bz]}),n})();var V=i(75603),H=i(60263);let P=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({imports:[H.o,V.g,B]}),n})()}}]);