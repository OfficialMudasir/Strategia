(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[53436],{53436:(st,U,l)=>{"use strict";l.r(U),l.d(U,{AccountModule:()=>at,getRecaptchaLanguage:()=>Je});var h=l(36895),T=l(80529),A=l(26647),k=l(24006),P=l(57887),K=l(80607),ne=l(94700),le=l(20388),_e=l(91170),Ae=l(85079),he=l(58127),D=l(8736),mt=l(51257),p=l(41571),O=l(30659),ut=l(87940),dt=l(49927),ue=l(37857),qe=l(28746),Te=l(61228),se=l(438),j=l(73565);const z=["tenantChangeModal"],W=["tenancyNameInput"];function Ce(H,B){1&H&&(p.\u0275\u0275elementStart(0,"span",24),p.\u0275\u0275text(1),p.\u0275\u0275pipe(2,"localize"),p.\u0275\u0275elementEnd()),2&H&&(p.\u0275\u0275advance(1),p.\u0275\u0275textInterpolate1(" ",p.\u0275\u0275pipeBind1(2,1,"TenancyNameRequired")," "))}const v=function(H){return{edited:H}};function fe(H,B){if(1&H){const S=p.\u0275\u0275getCurrentView();p.\u0275\u0275elementStart(0,"form",5,6),p.\u0275\u0275listener("ngSubmit",function(){p.\u0275\u0275restoreView(S);const ee=p.\u0275\u0275nextContext();return p.\u0275\u0275resetView(ee.save())}),p.\u0275\u0275elementStart(2,"div",7)(3,"h5",8)(4,"span"),p.\u0275\u0275text(5),p.\u0275\u0275pipe(6,"localize"),p.\u0275\u0275elementEnd()(),p.\u0275\u0275elementStart(7,"button",9),p.\u0275\u0275listener("click",function(){p.\u0275\u0275restoreView(S);const ee=p.\u0275\u0275nextContext();return p.\u0275\u0275resetView(ee.close())}),p.\u0275\u0275elementEnd()(),p.\u0275\u0275elementStart(8,"div",10)(9,"div",11)(10,"label",12),p.\u0275\u0275text(11),p.\u0275\u0275pipe(12,"localize"),p.\u0275\u0275elementEnd(),p.\u0275\u0275elementStart(13,"div",13)(14,"label",14)(15,"input",15),p.\u0275\u0275listener("ngModelChange",function(ee){p.\u0275\u0275restoreView(S);const rt=p.\u0275\u0275nextContext();return p.\u0275\u0275resetView(rt.isSwitchToTenant=ee)})("change",function(ee){p.\u0275\u0275restoreView(S);const rt=p.\u0275\u0275nextContext();return p.\u0275\u0275resetView(rt.switchToTenant(ee))}),p.\u0275\u0275elementEnd()()()(),p.\u0275\u0275elementStart(16,"div",16)(17,"label",12)(18,"label"),p.\u0275\u0275text(19),p.\u0275\u0275pipe(20,"localize"),p.\u0275\u0275elementEnd()(),p.\u0275\u0275elementStart(21,"label",13)(22,"input",17,18),p.\u0275\u0275listener("ngModelChange",function(ee){p.\u0275\u0275restoreView(S);const rt=p.\u0275\u0275nextContext();return p.\u0275\u0275resetView(rt.tenancyName=ee)}),p.\u0275\u0275pipe(24,"localize"),p.\u0275\u0275elementEnd(),p.\u0275\u0275template(25,Ce,3,3,"span",19),p.\u0275\u0275elementEnd()()(),p.\u0275\u0275elementStart(26,"div",20)(27,"button",21),p.\u0275\u0275listener("click",function(){p.\u0275\u0275restoreView(S);const ee=p.\u0275\u0275nextContext();return p.\u0275\u0275resetView(ee.close())}),p.\u0275\u0275text(28),p.\u0275\u0275pipe(29,"localize"),p.\u0275\u0275elementEnd(),p.\u0275\u0275elementStart(30,"button",22),p.\u0275\u0275element(31,"i",23),p.\u0275\u0275elementStart(32,"span"),p.\u0275\u0275text(33),p.\u0275\u0275elementEnd()()()()}if(2&H){const S=p.\u0275\u0275reference(1),Q=p.\u0275\u0275reference(23),ee=p.\u0275\u0275nextContext();p.\u0275\u0275advance(5),p.\u0275\u0275textInterpolate(p.\u0275\u0275pipeBind1(6,16,"ChangeTenant")),p.\u0275\u0275advance(6),p.\u0275\u0275textInterpolate(p.\u0275\u0275pipeBind1(12,18,"SwitchToTenant")),p.\u0275\u0275advance(4),p.\u0275\u0275propertyInterpolate("value",ee.isSwitchToTenant?"true":"false"),p.\u0275\u0275property("ngModel",ee.isSwitchToTenant),p.\u0275\u0275advance(4),p.\u0275\u0275textInterpolate(p.\u0275\u0275pipeBind1(20,20,"TenancyName")),p.\u0275\u0275advance(3),p.\u0275\u0275propertyInterpolate("placeholder",ee.isSwitchToTenant?p.\u0275\u0275pipeBind1(24,22,"EnterTenancyName"):""),p.\u0275\u0275property("ngClass",p.\u0275\u0275pureFunction1(26,v,ee.tenancyName))("ngModel",ee.tenancyName)("disabled",!ee.isSwitchToTenant),p.\u0275\u0275advance(3),p.\u0275\u0275property("ngIf",ee.isSwitchToTenant&&!Q.pristine&&!ee.tenancyName),p.\u0275\u0275advance(2),p.\u0275\u0275property("disabled",ee.saving),p.\u0275\u0275advance(1),p.\u0275\u0275textInterpolate1(" ",p.\u0275\u0275pipeBind1(29,24,"Cancel")," "),p.\u0275\u0275advance(2),p.\u0275\u0275property("disabled",!S.form.valid)("buttonBusy",ee.saving)("busyText",ee.l("ProcessingWithThreeDot")),p.\u0275\u0275advance(3),p.\u0275\u0275textInterpolate(ee.submitButtonText)}}const b=function(){return{backdrop:"static"}};let M=(()=>{class H extends he.c{constructor(S,Q){super(Q),this._accountService=S,this.tenancyName="",this.tenancyNameBuffer="",this.submitButtonText="",this.isSwitchToTenant=!1,this.active=!1,this.saving=!1}focusTenancyNameInput(){setTimeout(()=>{document.getElementById("tenancyNameInput").focus()},100)}updateSubmitButtonText(){this.submitButtonText=this.l(this.isSwitchToTenant?"SwitchToTheTenant":"SwitchToTheHost")}show(S){this.tenancyName=S,this.isSwitchToTenant=!!S,this.updateSubmitButtonText(),this.active=!0,this.modal.show()}onShown(){this.focusTenancyNameInput()}switchToTenant(S){S.target.checked?(this.tenancyName=this.tenancyNameBuffer,this.focusTenancyNameInput()):(this.tenancyNameBuffer=this.tenancyName,this.tenancyName=""),this.updateSubmitButtonText()}save(){if(!this.tenancyName)return abp.multiTenancy.setTenantIdCookie(void 0),this.close(),void location.reload();let S=new ue.i_h;S.tenancyName=this.tenancyName,this.saving=!0,this._accountService.isTenantAvailable(S).pipe((0,qe.x)(()=>{this.saving=!1})).subscribe(Q=>{switch(Q.state){case ue.z6R.Available:return abp.multiTenancy.setTenantIdCookie(Q.tenantId),this.close(),void location.reload();case ue.z6R.InActive:this.message.warn(this.l("TenantIsNotActive",this.tenancyName)),this.focusTenancyNameInput();break;case ue.z6R.NotFound:this.message.warn(this.l("ThereIsNoTenantDefinedWithName{0}",this.tenancyName)),this.focusTenancyNameInput()}})}close(){this.active=!1,this.modal.hide()}}return H.\u0275fac=function(S){return new(S||H)(p.\u0275\u0275directiveInject(ue.k4Y),p.\u0275\u0275directiveInject(p.Injector))},H.\u0275cmp=p.\u0275\u0275defineComponent({type:H,selectors:[["tenantChangeModal"]],viewQuery:function(S,Q){if(1&S&&(p.\u0275\u0275viewQuery(z,7),p.\u0275\u0275viewQuery(W,7)),2&S){let ee;p.\u0275\u0275queryRefresh(ee=p.\u0275\u0275loadQuery())&&(Q.modal=ee.first),p.\u0275\u0275queryRefresh(ee=p.\u0275\u0275loadQuery())&&(Q.tenancyNameInput=ee.first)}},features:[p.\u0275\u0275InheritDefinitionFeature],decls:5,vars:3,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","tenantChangeModal","aria-hidden","true",1,"modal","fade",3,"config","onShown"],["tenantChangeModal","bs-modal"],[1,"modal-dialog"],[1,"modal-content"],["novalidate","","class","form form-label-right",3,"ngSubmit",4,"ngIf"],["novalidate","",1,"form","form-label-right",3,"ngSubmit"],["changeTenantForm","ngForm"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-hidden","true",1,"btn-close",3,"click"],[1,"modal-body"],[1,"row","text-left","mb-0"],[1,"col-4","col-form-label"],[1,"col"],[1,"form-check","form-check-custom","form-check-solid","form-switch","py-1"],["type","checkbox","name","SwitchToTenant","checked","checked",1,"form-check-input",3,"ngModel","value","ngModelChange","change"],[1,"row","mb-0"],["type","text","id","tenancyNameInput","name","tenancyNameInput","required","","maxlength","64",1,"form-control",3,"ngClass","ngModel","disabled","placeholder","ngModelChange"],["tenancyNameInput","ngModel"],["class","form-text text-danger text-left",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline","btn-outline-primary","fw-bold",3,"disabled","click"],["type","submit",1,"btn","btn-primary","fw-bold","save-button",3,"disabled","buttonBusy","busyText"],[1,"fa","fa-arrow-circle-right"],[1,"form-text","text-danger","text-left"]],template:function(S,Q){1&S&&(p.\u0275\u0275elementStart(0,"div",0,1),p.\u0275\u0275listener("onShown",function(){return Q.onShown()}),p.\u0275\u0275elementStart(2,"div",2)(3,"div",3),p.\u0275\u0275template(4,fe,34,28,"form",4),p.\u0275\u0275elementEnd()()()),2&S&&(p.\u0275\u0275property("config",p.\u0275\u0275pureFunction0(2,b)),p.\u0275\u0275advance(4),p.\u0275\u0275property("ngIf",Q.active))},dependencies:[h.mk,h.O5,k.\u0275NgNoValidate,k.DefaultValueAccessor,k.CheckboxControlValueAccessor,k.NgControlStatus,k.NgControlStatusGroup,k.RequiredValidator,k.MaxLengthValidator,k.NgModel,k.NgForm,Te.L,se.Z,j.F],encapsulation:2}),H})();const G=["tenantChangeModal"];function ae(H,B){if(1&H&&(p.\u0275\u0275elementStart(0,"span",4)(1,"strong"),p.\u0275\u0275text(2),p.\u0275\u0275elementEnd()()),2&H){const S=p.\u0275\u0275nextContext(2);p.\u0275\u0275propertyInterpolate("title",S.name),p.\u0275\u0275advance(2),p.\u0275\u0275textInterpolate(S.tenancyName)}}function Z(H,B){1&H&&(p.\u0275\u0275elementStart(0,"span"),p.\u0275\u0275text(1),p.\u0275\u0275pipe(2,"localize"),p.\u0275\u0275elementEnd()),2&H&&(p.\u0275\u0275advance(1),p.\u0275\u0275textInterpolate(p.\u0275\u0275pipeBind1(2,1,"NotSelected")))}function Ze(H,B){if(1&H){const S=p.\u0275\u0275getCurrentView();p.\u0275\u0275elementStart(0,"span"),p.\u0275\u0275text(1),p.\u0275\u0275pipe(2,"localize"),p.\u0275\u0275template(3,ae,3,2,"span",1),p.\u0275\u0275template(4,Z,3,3,"span",0),p.\u0275\u0275text(5," ( "),p.\u0275\u0275elementStart(6,"a",2),p.\u0275\u0275listener("click",function(){p.\u0275\u0275restoreView(S);const ee=p.\u0275\u0275nextContext();return p.\u0275\u0275resetView(ee.showChangeModal())}),p.\u0275\u0275text(7),p.\u0275\u0275elementEnd(),p.\u0275\u0275text(8," ) "),p.\u0275\u0275element(9,"tenantChangeModal",null,3),p.\u0275\u0275elementEnd()}if(2&H){const S=p.\u0275\u0275nextContext();p.\u0275\u0275advance(1),p.\u0275\u0275textInterpolate1(" ",p.\u0275\u0275pipeBind1(2,4,"CurrentTenant"),": "),p.\u0275\u0275advance(2),p.\u0275\u0275property("ngIf",S.tenancyName),p.\u0275\u0275advance(1),p.\u0275\u0275property("ngIf",!S.tenancyName),p.\u0275\u0275advance(3),p.\u0275\u0275textInterpolate(S.l("Change"))}}let be=(()=>{class H extends he.c{constructor(S,Q){super(S),this._accountService=Q}get isMultiTenancyEnabled(){return abp.multiTenancy.isEnabled}ngOnInit(){this.appSession.tenant&&(this.tenancyName=this.appSession.tenant.tenancyName,this.name=this.appSession.tenant.name)}showChangeModal(){this.tenantChangeModal.show(this.tenancyName)}}return H.\u0275fac=function(S){return new(S||H)(p.\u0275\u0275directiveInject(p.Injector),p.\u0275\u0275directiveInject(ue.k4Y))},H.\u0275cmp=p.\u0275\u0275defineComponent({type:H,selectors:[["tenant-change"]],viewQuery:function(S,Q){if(1&S&&p.\u0275\u0275viewQuery(G,5),2&S){let ee;p.\u0275\u0275queryRefresh(ee=p.\u0275\u0275loadQuery())&&(Q.tenantChangeModal=ee.first)}},features:[p.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[[4,"ngIf"],[3,"title",4,"ngIf"],["href","javascript:;",3,"click"],["tenantChangeModal",""],[3,"title"]],template:function(S,Q){1&S&&p.\u0275\u0275template(0,Ze,11,6,"span",0),2&S&&p.\u0275\u0275property("ngIf",Q.isMultiTenancyEnabled)},dependencies:[h.O5,M,j.F],encapsulation:2}),H})();function We(H,B){if(1&H){const S=p.\u0275\u0275getCurrentView();p.\u0275\u0275elementStart(0,"div",3),p.\u0275\u0275listener("click",function(){const rt=p.\u0275\u0275restoreView(S).$implicit,ht=p.\u0275\u0275nextContext(2);return p.\u0275\u0275resetView(ht.changeLanguage(rt))}),p.\u0275\u0275element(1,"i"),p.\u0275\u0275elementEnd()}if(2&H){const S=B.$implicit;p.\u0275\u0275propertyInterpolate("title",S.displayName),p.\u0275\u0275advance(1),p.\u0275\u0275classMap(S.icon),p.\u0275\u0275attribute("aria-label",S.displayName)}}function Ht(H,B){if(1&H&&(p.\u0275\u0275elementStart(0,"div",1),p.\u0275\u0275template(1,We,2,5,"div",2),p.\u0275\u0275elementEnd()),2&H){const S=p.\u0275\u0275nextContext();p.\u0275\u0275advance(1),p.\u0275\u0275property("ngForOf",S.languages)}}let _t=(()=>{class H extends he.c{constructor(S){super(S),this.languages=[]}ngOnInit(){this.languages=(0,D.Z)(abp.localization.languages,S=>!1===S.isDisabled),this.currentLanguage=abp.localization.currentLanguage}changeLanguage(S){abp.utils.setCookieValue("Abp.Localization.CultureName",S.name,new Date((new Date).getTime()+15768e7),abp.appPath),location.reload()}}return H.\u0275fac=function(S){return new(S||H)(p.\u0275\u0275directiveInject(p.Injector))},H.\u0275cmp=p.\u0275\u0275defineComponent({type:H,selectors:[["language-switch"]],features:[p.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[["class","ms-1 mx-auto",4,"ngIf"],[1,"ms-1","mx-auto"],["class","btn language-switch-btn btn-clean btn-icon p-0 me-1",3,"title","click",4,"ngFor","ngForOf"],[1,"btn","language-switch-btn","btn-clean","btn-icon","p-0","me-1",3,"title","click"]],template:function(S,Q){1&S&&p.\u0275\u0275template(0,Ht,2,1,"div",0),2&S&&p.\u0275\u0275property("ngIf",Q.languages.length>1)},dependencies:[h.sg,h.O5],styles:[".language-switch-btn[_ngcontent-%COMP%]{width:auto;height:auto}"]}),H})();function St(H,B){if(1&H&&p.\u0275\u0275element(0,"img",11),2&H){const S=p.\u0275\u0275nextContext();p.\u0275\u0275classProp("mb-20",S.isSelectEditionPage()),p.\u0275\u0275property("src",S.defaultLogo,p.\u0275\u0275sanitizeUrl)}}function Qe(H,B){if(1&H&&p.\u0275\u0275element(0,"img",11),2&H){const S=p.\u0275\u0275nextContext();p.\u0275\u0275property("src",S.remoteServiceBaseUrl+"/TenantCustomization/GetTenantLogo?skin="+S.getLogoSkin()+"&tenantId="+S.appSession.tenant.id,p.\u0275\u0275sanitizeUrl)}}function Ue(H,B){1&H&&(p.\u0275\u0275elementStart(0,"div",14),p.\u0275\u0275element(1,"tenant-change"),p.\u0275\u0275elementEnd())}function oe(H,B){if(1&H&&(p.\u0275\u0275elementStart(0,"div",12),p.\u0275\u0275template(1,Ue,2,0,"div",13),p.\u0275\u0275element(2,"router-outlet"),p.\u0275\u0275elementEnd()),2&H){const S=p.\u0275\u0275nextContext();p.\u0275\u0275advance(1),p.\u0275\u0275property("ngIf",S.showTenantChange())}}function et(H,B){1&H&&(p.\u0275\u0275elementStart(0,"div",14),p.\u0275\u0275element(1,"tenant-change"),p.\u0275\u0275elementEnd())}function Ve(H,B){if(1&H&&(p.\u0275\u0275elementStart(0,"div",15),p.\u0275\u0275template(1,et,2,0,"div",13),p.\u0275\u0275element(2,"router-outlet"),p.\u0275\u0275elementEnd()),2&H){const S=p.\u0275\u0275nextContext();p.\u0275\u0275advance(1),p.\u0275\u0275property("ngIf",S.showTenantChange())}}let Dt=(()=>{class H extends he.c{constructor(S,Q,ee,rt,ht,Be){super(S),this._router=Q,this._loginService=ee,this._uiCustomizationService=rt,this._dateTimeService=ht,this.currentYear=this._dateTimeService.getYear(),this.remoteServiceBaseUrl=Ae.g.remoteServiceBaseUrl,this.skin=this.appSession.theme.baseSettings.layout.darkMode?"dark":"light",this.defaultLogo=Ae.g.appBaseUrl+"/assets/common/images/app-logo-on-"+this.skin+".png",this.backgroundImageName=this.appSession.theme.baseSettings.layout.darkMode?"login-dark":"login",this.tenantChangeDisabledRoutes=["select-edition","buy","upgrade","extend","register-tenant","stripe-purchase","stripe-subscribe","stripe-update-subscription","paypal-purchase","stripe-payment-result","payment-completed","stripe-cancel-payment","session-locked"],this.viewContainerRef=Be}showTenantChange(){return!(!this._router.url||(0,D.Z)(this.tenantChangeDisabledRoutes,S=>this._router.url.indexOf("/account/"+S)>=0).length)&&abp.multiTenancy.isEnabled&&!this.supportsTenancyNameInUrl()}isSelectEditionPage(){return this._router.url.indexOf("/account/select-edition")>=0}ngOnInit(){this._loginService.init(),document.body.className=this._uiCustomizationService.getAccountModuleBodyClass()}goToHome(){window.location.href="/"}getBgUrl(){return"url(./assets/metronic/themes/"+this.currentTheme.baseSettings.theme+"/images/bg/bg-4.jpg)"}getLogoSkin(){return this.currentTheme.baseSettings.layout.darkMode?"light":"dark"}supportsTenancyNameInUrl(){return null!=mt.y.resolveTenancyName(Ae.g.appBaseUrlFormat)}}return H.\u0275fac=function(S){return new(S||H)(p.\u0275\u0275directiveInject(p.Injector),p.\u0275\u0275directiveInject(_e.F0),p.\u0275\u0275directiveInject(O.r),p.\u0275\u0275directiveInject(ut.n),p.\u0275\u0275directiveInject(dt.C),p.\u0275\u0275directiveInject(p.ViewContainerRef))},H.\u0275cmp=p.\u0275\u0275defineComponent({type:H,selectors:[["ng-component"]],features:[p.\u0275\u0275InheritDefinitionFeature],decls:11,vars:15,consts:[[1,"d-flex","flex-column","flex-root"],[1,"d-flex","flex-column","flex-column-fluid","bgi-position-y-bottom","position-x-center","bgi-no-repeat","bgi-size-contain","bgi-attachment-fixed"],[1,"d-flex","flex-center","flex-column","flex-column-fluid","p-10"],["href","",1,"d-flex","justify-content-center",3,"click"],["alt","logo","class","h-40px",3,"src","mb-20",4,"ngIf"],["alt","logo","class","h-40px",3,"src",4,"ngIf"],["class","container-xxl mx-auto",4,"ngIf"],["class","w-lg-500px bg-body rounded shadow-sm p-10 p-lg-10 mx-auto",4,"ngIf"],[1,"d-flex","flex-center","flex-column-auto","p-10"],[1,"d-flex","align-items-center","fw-bold","fs-6"],[1,"mx-auto"],["alt","logo",1,"h-40px",3,"src"],[1,"container-xxl","mx-auto"],["class","tenant-change-box mb-5 tenant-change-box",4,"ngIf"],[1,"tenant-change-box","mb-5","tenant-change-box"],[1,"w-lg-500px","bg-body","rounded","shadow-sm","p-10","p-lg-10","mx-auto"]],template:function(S,Q){1&S&&(p.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),p.\u0275\u0275listener("click",function(){return Q.goToHome()}),p.\u0275\u0275template(4,St,1,3,"img",4),p.\u0275\u0275template(5,Qe,1,1,"img",5),p.\u0275\u0275elementEnd(),p.\u0275\u0275template(6,oe,3,1,"div",6),p.\u0275\u0275template(7,Ve,3,1,"div",7),p.\u0275\u0275elementEnd(),p.\u0275\u0275elementStart(8,"div",8)(9,"div",9),p.\u0275\u0275element(10,"language-switch",10),p.\u0275\u0275elementEnd()()()()),2&S&&(p.\u0275\u0275advance(1),p.\u0275\u0275styleMapInterpolate1("background-image: url(/assets/metronic/assets/media/svg/illustrations/",Q.backgroundImageName,".png)"),p.\u0275\u0275advance(1),p.\u0275\u0275classProp("pb-lg-20",!Q.isSelectEditionPage())("pb-0",Q.isSelectEditionPage()),p.\u0275\u0275advance(1),p.\u0275\u0275classProp("mb-12",!Q.isSelectEditionPage()),p.\u0275\u0275advance(1),p.\u0275\u0275property("ngIf",!Q.appSession.tenant||!Q.appSession.tenant.HasLogo()),p.\u0275\u0275advance(1),p.\u0275\u0275property("ngIf",Q.appSession.tenant&&Q.appSession.tenant.HasLogo()),p.\u0275\u0275advance(1),p.\u0275\u0275property("ngIf",Q.isSelectEditionPage()),p.\u0275\u0275advance(1),p.\u0275\u0275property("ngIf",!Q.isSelectEditionPage()),p.\u0275\u0275advance(1),p.\u0275\u0275classProp("pt-0",Q.isSelectEditionPage()))},dependencies:[h.O5,_e.lC,be,_t],styles:[".login.login-1 .login-aside .aside-img{min-height:450px}.login.login-1 .login-signin,.login.login-1 .login-signup,.login.login-1 .login-forgot,.login.login-1.login-signin-on .login-signup{display:none}.login.login-1.login-signin-on .login-signin{display:block}.login.login-1.login-signin-on .login-forgot{display:none}.login.login-1.login-signup-on .login-signup{display:block}.login.login-1.login-signup-on .login-signin,.login.login-1.login-signup-on .login-forgot,.login.login-1.login-forgot-on .login-signup,.login.login-1.login-forgot-on .login-signin{display:none}.login.login-1.login-forgot-on .login-forgot{display:block}@media (min-width: 992px){.login.login-1 .login-aside{width:100%;max-width:600px}.login.login-1 .login-content{width:100%;max-width:500px}.login.login-1 .login-content .login-form{width:100%;max-width:450px}}@media (min-width: 992px) and (max-width: 1399.98px){.login.login-1 .login-aside{width:100%;max-width:450px}}@media (max-width: 991.98px){.login.login-1 .login-content .login-form{width:100%;max-width:400px}}@media (max-width: 575.98px){.login.login-1 .aside-img{min-height:300px!important;background-size:400px}.login.login-1 .login-content .login-form{width:100%;max-width:100%}}.has-danger .form-control-feedback{color:#fd397a;margin-top:.2rem;font-size:.85rem;text-align:left}ul.text-danger{list-style:none;color:#f4516c;margin-top:.2rem;font-size:.85rem;text-align:left;padding-left:0}.captcha-container{margin:auto;width:70%}\n"],encapsulation:2}),H})();var Pt=l(3410),Rt=l(34845);let xe=(()=>{class H{constructor(S,Q,ee){this._permissionChecker=S,this._router=Q,this._sessionService=ee}canActivate(S,Q){return!(!S.queryParams.ss||"true"!==S.queryParams.ss)||!this._sessionService.user||(this._router.navigate([this.selectBestRoute()]),!1)}selectBestRoute(){return this._permissionChecker.isGranted("Pages.Administration.Host.Dashboard")?"/app/admin/hostDashboard":this._permissionChecker.isGranted("Pages.Tenant.Dashboard")?"/app/main/dashboard":"/app/notifications"}}return H.\u0275fac=function(S){return new(S||H)(p.\u0275\u0275inject(Pt.qT),p.\u0275\u0275inject(_e.F0),p.\u0275\u0275inject(Rt.c))},H.\u0275prov=p.\u0275\u0275defineInjectable({token:H,factory:H.\u0275fac}),H})(),Le=(()=>{class H{constructor(S,Q){this.router=S,this._uiCustomizationService=Q,S.events.subscribe(ee=>{setTimeout(()=>{this.toggleBodyCssClass(ee.url)},0)})}toggleBodyCssClass(S){S?S.indexOf("/account/")>=0?this.setAccountModuleBodyClassInternal():document.body.className=this._uiCustomizationService.getAppModuleBodyClass():this.setAccountModuleBodyClassInternal()}setAccountModuleBodyClassInternal(){let Q="";document.body.className.indexOf("swal2-toast-shown")>=0&&(Q+=" swal2-toast-shown"),document.body.className=this._uiCustomizationService.getAccountModuleBodyClass()+" "+Q}}return H.\u0275fac=function(S){return new(S||H)(p.\u0275\u0275inject(_e.F0),p.\u0275\u0275inject(ut.n))},H.\u0275mod=p.\u0275\u0275defineNgModule({type:H}),H.\u0275inj=p.\u0275\u0275defineInjector({imports:[_e.Bz.forChild([{path:"",component:Dt,children:[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",loadChildren:()=>l.e(92139).then(l.bind(l,92139)).then(B=>B.LoginModule),canActivate:[xe]},{path:"register",loadChildren:()=>l.e(98275).then(l.bind(l,98275)).then(B=>B.RegisterModule),canActivate:[xe]},{path:"register-tenant",loadChildren:()=>l.e(23987).then(l.bind(l,23987)).then(B=>B.RegisterTenantModule),canActivate:[xe]},{path:"register-tenant-result",loadChildren:()=>l.e(31611).then(l.bind(l,31611)).then(B=>B.RegisterTenantResultModule),canActivate:[xe]},{path:"forgot-password",loadChildren:()=>Promise.all([l.e(75603),l.e(7119)]).then(l.bind(l,7119)).then(B=>B.ForgotPasswordModule),canActivate:[xe]},{path:"reset-password",loadChildren:()=>l.e(71817).then(l.bind(l,71817)).then(B=>B.ResetPasswordModule),canActivate:[xe]},{path:"email-activation",loadChildren:()=>l.e(85422).then(l.bind(l,85422)).then(B=>B.EmailActivationModule),canActivate:[xe]},{path:"confirm-email",loadChildren:()=>l.e(27960).then(l.bind(l,27960)).then(B=>B.EmailConfirmModule),canActivate:[xe]},{path:"send-code",loadChildren:()=>l.e(15524).then(l.bind(l,15524)).then(B=>B.SendTwoFactorCodeModule),canActivate:[xe]},{path:"verify-code",loadChildren:()=>l.e(6066).then(l.bind(l,6066)).then(B=>B.ValidateTwoFactorCodeModule),canActivate:[xe]},{path:"buy",loadChildren:()=>l.e(8321).then(l.bind(l,8321)).then(B=>B.BuyModule)},{path:"extend",loadChildren:()=>l.e(53218).then(l.bind(l,53218)).then(B=>B.ExtendModule)},{path:"upgrade",loadChildren:()=>Promise.all([l.e(68592),l.e(20975)]).then(l.bind(l,20975)).then(B=>B.UpgradeModule)},{path:"select-edition",loadChildren:()=>Promise.all([l.e(68592),l.e(13365)]).then(l.bind(l,13365)).then(B=>B.SelectEditionModule)},{path:"paypal-purchase",loadChildren:()=>l.e(84330).then(l.bind(l,84330)).then(B=>B.PaypalPurchaseModule)},{path:"stripe-purchase",loadChildren:()=>l.e(45058).then(l.bind(l,45058)).then(B=>B.StripePurchaseModule)},{path:"stripe-payment-result",loadChildren:()=>l.e(89977).then(l.bind(l,89977)).then(B=>B.StripePaymentResultModule)},{path:"stripe-cancel-payment",loadChildren:()=>l.e(81345).then(l.bind(l,81345)).then(B=>B.StripeCancelPaymentModule)},{path:"payment-completed",loadChildren:()=>l.e(74215).then(l.bind(l,74215)).then(B=>B.PaymentCompletedModule)},{path:"session-locked",loadChildren:()=>l.e(38404).then(l.bind(l,38404)).then(B=>B.SessionLockScreenModule)},{path:"**",redirectTo:"login"}]}]),_e.Bz]}),H})();var ke=l(91363),ge=l(76447),bt=l(6004),kt=l(77959),Oe=l(73425),Pe=l(79883),ye=l(12749),tt=l(15260);function Je(){return(new kt.O).map("recaptcha",abp.localization.currentLanguage.name)}let at=(()=>{class H{}return H.\u0275fac=function(S){return new(S||H)},H.\u0275mod=p.\u0275\u0275defineNgModule({type:H}),H.\u0275inj=p.\u0275\u0275defineInjector({providers:[O.r,ke.K,bt.T,xe,tt.o,{provide:ne.We,useValue:Ae.g.recaptchaSiteKey}],imports:[h.ez,k.FormsModule,T.JF,T.Ed,ne.dw,le.zk.forRoot(),A.$,K.A,P.L,Le,ge.zr.forRoot(),Oe.gz,Pe._,ye.y]}),H})()},30659:(st,U,l)=>{"use strict";l.d(U,{r:()=>Fn});var h=l(85079),T=l(87737),A=l(37857),k=l(32351),P=l(8736),K=l(22957),ne=l(28746),le=l(76447),_e=l(70685),Ae=function(n,e){return(Ae=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])})(n,e)};function he(n,e){function t(){this.constructor=n}Ae(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}var D=function(){return D=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},D.apply(this,arguments)};function mt(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]])}return t}function p(n,e,t,r){return new(t||(t=Promise))(function(i,s){function c(g){try{d(r.next(g))}catch(C){s(C)}}function u(g){try{d(r.throw(g))}catch(C){s(C)}}function d(g){g.done?i(g.value):function o(i){return i instanceof t?i:new t(function(s){s(i)})}(g.value).then(c,u)}d((r=r.apply(n,e||[])).next())})}function O(n,e){var r,o,i,s,t={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(d){return function(g){return function u(d){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(i=2&d[0]?o.return:d[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,d[1])).done)return i;switch(o=0,i&&(d=[2&d[0],i.value]),d[0]){case 0:case 1:i=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,o=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(!(i=(i=t.trys).length>0&&i[i.length-1])&&(6===d[0]||2===d[0])){t=0;continue}if(3===d[0]&&(!i||d[1]>i[0]&&d[1]<i[3])){t.label=d[1];break}if(6===d[0]&&t.label<i[1]){t.label=i[1],i=d;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(d);break}i[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(n,t)}catch(g){d=[6,g],o=0}finally{r=i=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([d,g])}}}function ut(n,e){var t="function"==typeof Symbol&&n[Symbol.iterator];if(!t)return n;var o,s,r=t.call(n),i=[];try{for(;(void 0===e||e-- >0)&&!(o=r.next()).done;)i.push(o.value)}catch(c){s={error:c}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(s)throw s.error}}return i}function dt(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(ut(arguments[e]));return n}var ue=(()=>{return(n=ue||(ue={})).AcquireTokenByCode="acquireTokenByCode",n.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",n.AcquireTokenSilent="acquireTokenSilent",n.AcquireTokenSilentAsync="acquireTokenSilentAsync",n.AcquireTokenPopup="acquireTokenPopup",n.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",n.CryptoOptsSignJwt="cryptoOptsSignJwt",n.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",n.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",n.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",n.SsoSilent="ssoSilent",n.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",n.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",n.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken",n.BaseClientCreateTokenRequestHeaders="baseClientCreateTokenRequestHeaders",n.BrokerHandhshake="brokerHandshake",n.AcquireTokenByRefreshTokenInBroker="acquireTokenByRefreshTokenInBroker",n.AcquireTokenByBroker="acquireTokenByBroker",n.RefreshTokenClientExecuteTokenRequest="refreshTokenClientExecuteTokenRequest",n.RefreshTokenClientAcquireToken="refreshTokenClientAcquireToken",n.RefreshTokenClientAcquireTokenWithCachedRefreshToken="refreshTokenClientAcquireTokenWithCachedRefreshToken",ue;var n})(),qe=(()=>{return(n=qe||(qe={}))[n.NotStarted=0]="NotStarted",n[n.InProgress=1]="InProgress",n[n.Completed=2]="Completed",qe;var n})(),Te=function(n,e){return(Te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])})(n,e)};function se(n,e){function t(){this.constructor=n}Te(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}var j=function(){return j=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},j.apply(this,arguments)};function z(n,e,t,r){return new(t||(t=Promise))(function(i,s){function c(g){try{d(r.next(g))}catch(C){s(C)}}function u(g){try{d(r.throw(g))}catch(C){s(C)}}function d(g){g.done?i(g.value):function o(i){return i instanceof t?i:new t(function(s){s(i)})}(g.value).then(c,u)}d((r=r.apply(n,e||[])).next())})}function W(n,e){var r,o,i,s,t={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(d){return function(g){return function u(d){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(i=2&d[0]?o.return:d[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,d[1])).done)return i;switch(o=0,i&&(d=[2&d[0],i.value]),d[0]){case 0:case 1:i=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,o=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(!(i=(i=t.trys).length>0&&i[i.length-1])&&(6===d[0]||2===d[0])){t=0;continue}if(3===d[0]&&(!i||d[1]>i[0]&&d[1]<i[3])){t.label=d[1];break}if(6===d[0]&&t.label<i[1]){t.label=i[1],i=d;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(d);break}i[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(n,t)}catch(g){d=[6,g],o=0}finally{r=i=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([d,g])}}}function Ce(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;var r=Array(n),o=0;for(e=0;e<t;e++)for(var i=arguments[e],s=0,c=i.length;s<c;s++,o++)r[o]=i[s];return r}var v={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",REGIONAL_AUTH_NON_MSI_QUERY_STRING:"allowestsrnonmsi=true",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},fe=[v.OPENID_SCOPE,v.PROFILE_SCOPE,v.OFFLINE_ACCESS_SCOPE],b=Ce(fe,[v.EMAIL_SCOPE]),M=(()=>{return(n=M||(M={})).CONTENT_TYPE="Content-Type",n.RETRY_AFTER="Retry-After",n.CCS_HEADER="X-AnchorMailbox",n.WWWAuthenticate="WWW-Authenticate",n.AuthenticationInfo="Authentication-Info",n.X_MS_REQUEST_ID="x-ms-request-id",M;var n})(),G=(()=>{return(n=G||(G={})).ID_TOKEN="idtoken",n.CLIENT_INFO="client.info",n.ADAL_ID_TOKEN="adal.idtoken",n.ERROR="error",n.ERROR_DESC="error.description",n.ACTIVE_ACCOUNT="active-account",n.ACTIVE_ACCOUNT_FILTERS="active-account-filters",G;var n})(),ae=(()=>{return(n=ae||(ae={})).COMMON="common",n.ORGANIZATIONS="organizations",n.CONSUMERS="consumers",ae;var n})(),Z=(()=>{return(n=Z||(Z={})).CLIENT_ID="client_id",n.REDIRECT_URI="redirect_uri",n.RESPONSE_TYPE="response_type",n.RESPONSE_MODE="response_mode",n.GRANT_TYPE="grant_type",n.CLAIMS="claims",n.SCOPE="scope",n.ERROR="error",n.ERROR_DESCRIPTION="error_description",n.ACCESS_TOKEN="access_token",n.ID_TOKEN="id_token",n.REFRESH_TOKEN="refresh_token",n.EXPIRES_IN="expires_in",n.STATE="state",n.NONCE="nonce",n.PROMPT="prompt",n.SESSION_STATE="session_state",n.CLIENT_INFO="client_info",n.CODE="code",n.CODE_CHALLENGE="code_challenge",n.CODE_CHALLENGE_METHOD="code_challenge_method",n.CODE_VERIFIER="code_verifier",n.CLIENT_REQUEST_ID="client-request-id",n.X_CLIENT_SKU="x-client-SKU",n.X_CLIENT_VER="x-client-VER",n.X_CLIENT_OS="x-client-OS",n.X_CLIENT_CPU="x-client-CPU",n.X_CLIENT_CURR_TELEM="x-client-current-telemetry",n.X_CLIENT_LAST_TELEM="x-client-last-telemetry",n.X_MS_LIB_CAPABILITY="x-ms-lib-capability",n.X_APP_NAME="x-app-name",n.X_APP_VER="x-app-ver",n.POST_LOGOUT_URI="post_logout_redirect_uri",n.ID_TOKEN_HINT="id_token_hint",n.DEVICE_CODE="device_code",n.CLIENT_SECRET="client_secret",n.CLIENT_ASSERTION="client_assertion",n.CLIENT_ASSERTION_TYPE="client_assertion_type",n.TOKEN_TYPE="token_type",n.REQ_CNF="req_cnf",n.OBO_ASSERTION="assertion",n.REQUESTED_TOKEN_USE="requested_token_use",n.ON_BEHALF_OF="on_behalf_of",n.FOCI="foci",n.CCS_HEADER="X-AnchorMailbox",n.RETURN_SPA_CODE="return_spa_code",n.NATIVE_BROKER="nativebroker",n.LOGOUT_HINT="logout_hint",Z;var n})(),Ze=(()=>{return(n=Ze||(Ze={})).ACCESS_TOKEN="access_token",n.XMS_CC="xms_cc",Ze;var n})(),be={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},We=(()=>{return(n=We||(We={})).ACCOUNT="account",n.SID="sid",n.LOGIN_HINT="login_hint",n.ID_TOKEN="id_token",n.DOMAIN_HINT="domain_hint",n.ORGANIZATIONS="organizations",n.CONSUMERS="consumers",n.ACCOUNT_ID="accountIdentifier",n.HOMEACCOUNT_ID="homeAccountIdentifier",We;var n})(),Ht={PLAIN:"plain",S256:"S256"},_t=(()=>{return(n=_t||(_t={})).QUERY="query",n.FRAGMENT="fragment",n.FORM_POST="form_post",_t;var n})(),St=(()=>{return(n=St||(St={})).IMPLICIT_GRANT="implicit",n.AUTHORIZATION_CODE_GRANT="authorization_code",n.CLIENT_CREDENTIALS_GRANT="client_credentials",n.RESOURCE_OWNER_PASSWORD_GRANT="password",n.REFRESH_TOKEN_GRANT="refresh_token",n.DEVICE_CODE_GRANT="device_code",n.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer",St;var n})(),Qe=(()=>{return(n=Qe||(Qe={})).MSSTS_ACCOUNT_TYPE="MSSTS",n.ADFS_ACCOUNT_TYPE="ADFS",n.MSAV1_ACCOUNT_TYPE="MSA",n.GENERIC_ACCOUNT_TYPE="Generic",Qe;var n})(),Ue=(()=>{return(n=Ue||(Ue={})).CACHE_KEY_SEPARATOR="-",n.CLIENT_INFO_SEPARATOR=".",Ue;var n})(),oe=(()=>{return(n=oe||(oe={})).ID_TOKEN="IdToken",n.ACCESS_TOKEN="AccessToken",n.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",n.REFRESH_TOKEN="RefreshToken",oe;var n})(),et=(()=>{return(n=et||(et={})).ACCOUNT="Account",n.CREDENTIAL="Credential",n.ID_TOKEN="IdToken",n.ACCESS_TOKEN="AccessToken",n.REFRESH_TOKEN="RefreshToken",n.APP_METADATA="AppMetadata",n.TEMPORARY="TempCache",n.TELEMETRY="Telemetry",n.UNDEFINED="Undefined",n.THROTTLING="Throttling",et;var n})(),Ve=(()=>{return(n=Ve||(Ve={}))[n.ADFS=1001]="ADFS",n[n.MSA=1002]="MSA",n[n.MSSTS=1003]="MSSTS",n[n.GENERIC=1004]="GENERIC",n[n.ACCESS_TOKEN=2001]="ACCESS_TOKEN",n[n.REFRESH_TOKEN=2002]="REFRESH_TOKEN",n[n.ID_TOKEN=2003]="ID_TOKEN",n[n.APP_METADATA=3001]="APP_METADATA",n[n.UNDEFINED=9999]="UNDEFINED",Ve;var n})(),Dt="appmetadata",Le=(()=>{return(n=Le||(Le={})).CONFIG="config",n.CACHE="cache",n.NETWORK="network",n.HARDCODED_VALUES="hardcoded_values",Le;var n})(),ke={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},ge=(()=>{return(n=ge||(ge={})).BEARER="Bearer",n.POP="pop",n.SSH="ssh-cert",ge;var n})(),Oe=(()=>{return(n=Oe||(Oe={})).username="username",n.password="password",Oe;var n})(),Pe=(()=>{return(n=Pe||(Pe={}))[n.httpSuccess=200]="httpSuccess",n[n.httpBadRequest=400]="httpBadRequest",Pe;var n})(),ye=(()=>{return(n=ye||(ye={})).FAILED_AUTO_DETECTION="1",n.INTERNAL_CACHE="2",n.ENVIRONMENT_VARIABLE="3",n.IMDS="4",ye;var n})(),tt=(()=>{return(n=tt||(tt={})).CONFIGURED_MATCHES_DETECTED="1",n.CONFIGURED_NO_AUTO_DETECTION="2",n.CONFIGURED_NOT_DETECTED="3",n.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",n.AUTO_DETECTION_REQUESTED_FAILED="5",tt;var n})(),Je=(()=>{return(n=Je||(Je={})).NO_CACHE_HIT="0",n.FORCE_REFRESH="1",n.NO_CACHED_ACCESS_TOKEN="2",n.CACHED_ACCESS_TOKEN_EXPIRED="3",n.REFRESH_CACHED_ACCESS_TOKEN="4",Je;var n})(),at=(()=>{return(n=at||(at={})).Jwt="JWT",n.Jwk="JWK",at;var n})(),B_unexpectedError_code="unexpected_error",B_unexpectedError_desc="Unexpected error in authentication.",B_postRequestFailed_code="post_request_failed",B_postRequestFailed_desc="Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details.",S=function(n){function e(t,r,o){var i=this;return i=n.call(this,r?t+": "+r:t)||this,Object.setPrototypeOf(i,e.prototype),i.errorCode=t||v.EMPTY_STRING,i.errorMessage=r||v.EMPTY_STRING,i.subError=o||v.EMPTY_STRING,i.name="AuthError",i}return se(e,n),e.prototype.setCorrelationId=function(t){this.correlationId=t},e.createUnexpectedError=function(t){return new e(B_unexpectedError_code,B_unexpectedError_desc+": "+t)},e.createPostRequestFailed=function(t){return new e(B_postRequestFailed_code,B_postRequestFailed_desc+": "+t)},e}(Error),Q=function(n){function e(t,r,o){var i=n.call(this,t,r,o)||this;return i.name="ServerError",Object.setPrototypeOf(i,e.prototype),i}return se(e,n),e}(S),ee=["interaction_required","consent_required","login_required"],rt=["message_only","additional_action","basic_action","user_password_expired","consent_required"],ht_noTokensFoundError_code="no_tokens_found",ht_noTokensFoundError_desc="No refresh token found in the cache. Please sign-in.",ht_native_account_unavailable_code="native_account_unavailable",ht_native_account_unavailable_desc="The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",Be=function(n){function e(t,r,o){var i=n.call(this,t,r,o)||this;return i.name="InteractionRequiredAuthError",Object.setPrototypeOf(i,e.prototype),i}return se(e,n),e.isInteractionRequiredError=function(t,r,o){var i=!!t&&ee.indexOf(t)>-1,s=!!o&&rt.indexOf(o)>-1,c=!!r&&ee.some(function(u){return r.indexOf(u)>-1});return i||c||s},e.createNoTokensFoundError=function(){return new e(ht_noTokensFoundError_code,ht_noTokensFoundError_desc)},e.createNativeAccountUnavailableError=function(){return new e(ht_native_account_unavailable_code,ht_native_account_unavailable_desc)},e}(S),wt_CHANNEL_ID="53ee284d-920a-4b59-9d30-a60315b26836",ct=(()=>{return(n=ct||(ct={})).HandshakeRequest="Handshake",n.HandshakeResponse="HandshakeResponse",n.GetToken="GetToken",n.Response="Response",ct;var n})(),Me=(()=>{return(n=Me||(Me={})).LocalStorage="localStorage",n.SessionStorage="sessionStorage",n.MemoryStorage="memoryStorage",Me;var n})(),nt=(()=>{return(n=nt||(nt={})).GET="GET",n.POST="POST",nt;var n})(),pe=(()=>{return(n=pe||(pe={})).AUTHORITY="authority",n.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",n.SESSION_STATE="session.state",n.REQUEST_STATE="request.state",n.NONCE_IDTOKEN="nonce.id_token",n.ORIGIN_URI="request.origin",n.RENEW_STATUS="token.renew.status",n.URL_HASH="urlHash",n.REQUEST_PARAMS="request.params",n.SCOPES="scopes",n.INTERACTION_STATUS_KEY="interaction.status",n.CCS_CREDENTIAL="ccs.credential",n.CORRELATION_ID="request.correlationId",n.NATIVE_REQUEST="request.native",n.REDIRECT_CONTEXT="request.redirect.context",pe;var n})(),Nt=(()=>{return(n=Nt||(Nt={})).WRAPPER_SKU="wrapper.sku",n.WRAPPER_VER="wrapper.version",Nt;var n})(),Se=(()=>{return(n=Se||(Se={}))[n.acquireTokenRedirect=861]="acquireTokenRedirect",n[n.acquireTokenPopup=862]="acquireTokenPopup",n[n.ssoSilent=863]="ssoSilent",n[n.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",n[n.handleRedirectPromise=865]="handleRedirectPromise",n[n.acquireTokenByCode=866]="acquireTokenByCode",n[n.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",n[n.logout=961]="logout",n[n.logoutPopup=962]="logoutPopup",Se;var n})(),V=(()=>{return(n=V||(V={})).Redirect="redirect",n.Popup="popup",n.Silent="silent",n.None="none",V;var n})(),rr={scopes:fe},Ot="jwk",Ft="msal.db",Ke=(()=>{return(n=Ke||(Ke={}))[n.Default=0]="Default",n[n.AccessToken=1]="AccessToken",n[n.AccessTokenAndRefreshToken=2]="AccessTokenAndRefreshToken",n[n.RefreshToken=3]="RefreshToken",n[n.RefreshTokenAndNetwork=4]="RefreshTokenAndNetwork",n[n.Skip=5]="Skip",Ke;var n})(),Bt_missingKidError_code="missing_kid_error",Bt_missingKidError_desc="The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",Bt_missingAlgError_code="missing_alg_error",Bt_missingAlgError_desc="The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided.",or=function(n){function e(t,r){var o=n.call(this,t,r)||this;return o.name="JoseHeaderError",Object.setPrototypeOf(o,e.prototype),o}return se(e,n),e.createMissingKidError=function(){return new e(Bt_missingKidError_code,Bt_missingKidError_desc)},e.createMissingAlgError=function(){return new e(Bt_missingAlgError_code,Bt_missingAlgError_desc)},e}(S),Er=function(){function n(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}return n.getShrHeaderString=function(e){if(!e.kid)throw or.createMissingKidError();if(!e.alg)throw or.createMissingAlgError();var t=new n({typ:e.typ||at.Jwt,kid:e.kid,alg:e.alg});return JSON.stringify(t)},n}(),He=function(){function n(){}return n.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},n}(),Tr=function(){function n(e){this.cryptoObj=e}return n.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,He.decimalToHex(e[0])+He.decimalToHex(e[1])+He.decimalToHex(e[2])+He.decimalToHex(e[3])+"-"+He.decimalToHex(e[4])+He.decimalToHex(e[5])+"-"+He.decimalToHex(e[6])+He.decimalToHex(e[7])+"-"+He.decimalToHex(e[8])+He.decimalToHex(e[9])+"-"+He.decimalToHex(e[10])+He.decimalToHex(e[11])+He.decimalToHex(e[12])+He.decimalToHex(e[13])+He.decimalToHex(e[14])+He.decimalToHex(e[15])}catch{for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",o=0,i=v.EMPTY_STRING,s=0;s<36;s++)"-"!==t[s]&&"4"!==t[s]&&(o=16*Math.random()|0),"x"===t[s]?i+=r[o]:"y"===t[s]?(o&=3,i+=r[o|=8]):i+=t[s];return i}},n.prototype.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},n}(),vt=function(){function n(){}return n.stringToUtf8Arr=function(e){for(var t,r=0,o=e.length,i=0;i<o;i++)r+=(t=e.charCodeAt(i))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var s=new Uint8Array(r),c=0,u=0;c<r;u++)(t=e.charCodeAt(u))<128?s[c++]=t:t<2048?(s[c++]=192+(t>>>6),s[c++]=128+(63&t)):t<65536?(s[c++]=224+(t>>>12),s[c++]=128+(t>>>6&63),s[c++]=128+(63&t)):t<2097152?(s[c++]=240+(t>>>18),s[c++]=128+(t>>>12&63),s[c++]=128+(t>>>6&63),s[c++]=128+(63&t)):t<67108864?(s[c++]=248+(t>>>24),s[c++]=128+(t>>>18&63),s[c++]=128+(t>>>12&63),s[c++]=128+(t>>>6&63),s[c++]=128+(63&t)):(s[c++]=252+(t>>>30),s[c++]=128+(t>>>24&63),s[c++]=128+(t>>>18&63),s[c++]=128+(t>>>12&63),s[c++]=128+(t>>>6&63),s[c++]=128+(63&t));return s},n.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);return t},n.utf8ArrToString=function(e){for(var t=v.EMPTY_STRING,r=void 0,o=e.length,i=0;i<o;i++)r=e[i],t+=String.fromCharCode(r>251&&r<254&&i+5<o?1073741824*(r-252)+(e[++i]-128<<24)+(e[++i]-128<<18)+(e[++i]-128<<12)+(e[++i]-128<<6)+e[++i]-128:r>247&&r<252&&i+4<o?(r-248<<24)+(e[++i]-128<<18)+(e[++i]-128<<12)+(e[++i]-128<<6)+e[++i]-128:r>239&&r<248&&i+3<o?(r-240<<18)+(e[++i]-128<<12)+(e[++i]-128<<6)+e[++i]-128:r>223&&r<240&&i+2<o?(r-224<<12)+(e[++i]-128<<6)+e[++i]-128:r>191&&r<224&&i+1<o?(r-192<<6)+e[++i]-128:r);return t},n.getSortedObjectString=function(e){return JSON.stringify(e,Object.keys(e).sort())},n}(),R=function(){function n(){}return n.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,v.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},n.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,v.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},n.prototype.encode=function(e){var t=vt.stringToUtf8Arr(e);return this.base64EncArr(t)},n.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r=v.EMPTY_STRING,o=void 0,i=e.length,s=0,c=0;c<i;c++)s|=e[c]<<(16>>>(o=c%3)&24),(2===o||e.length-c==1)&&(r+=String.fromCharCode(this.uint6ToB64(s>>>18&63),this.uint6ToB64(s>>>12&63),this.uint6ToB64(s>>>6&63),this.uint6ToB64(63&s)),s=0);return 0===t?r:r.substring(0,r.length-t)+(1===t?"=":"==")},n.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},n}(),w=function(){function n(){}return n.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return vt.utf8ArrToString(r)},n.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,v.EMPTY_STRING),o=r.length,i=t?Math.ceil((3*o+1>>>2)/t)*t:3*o+1>>>2,s=new Uint8Array(i),c=void 0,u=void 0,d=0,g=0,C=0;C<o;C++)if(u=3&C,d|=this.b64ToUint6(r.charCodeAt(C))<<18-6*u,3===u||o-C==1){for(c=0;c<3&&g<i;c++,g++)s[g]=d>>>(16>>>c&24)&255;d=0}return s},n.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},n}(),a_clientInfoDecodingError_code="client_info_decoding_error",a_clientInfoDecodingError_desc="The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause.",a_clientInfoEmptyError_code="client_info_empty_error",a_clientInfoEmptyError_desc="The client info was empty. Please review the trace to determine the root cause.",a_tokenParsingError_code="token_parsing_error",a_tokenParsingError_desc="Token cannot be parsed. Please review stack trace to determine root cause.",a_nullOrEmptyToken_code="null_or_empty_token",a_nullOrEmptyToken_desc="The token is null or empty. Please review the trace to determine the root cause.",a_endpointResolutionError_code="endpoints_resolution_error",a_endpointResolutionError_desc="Error: could not resolve endpoints. Please check network and try again.",a_networkError_code="network_error",a_networkError_desc="Network request failed. Please check network trace to determine root cause.",a_unableToGetOpenidConfigError_code="openid_config_error",a_unableToGetOpenidConfigError_desc="Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",a_hashNotDeserialized_code="hash_not_deserialized",a_hashNotDeserialized_desc="The hash parameters could not be deserialized. Please review the trace to determine the root cause.",a_invalidStateError_code="invalid_state",a_invalidStateError_desc="State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState().",a_stateMismatchError_code="state_mismatch",a_stateMismatchError_desc="State mismatch error. Please check your network. Continued requests may cause cache overflow.",a_stateNotFoundError_code="state_not_found",a_stateNotFoundError_desc="State not found",a_nonceMismatchError_code="nonce_mismatch",a_nonceMismatchError_desc="Nonce mismatch error. This may be caused by a race condition in concurrent requests.",a_nonceNotFoundError_code="nonce_not_found",a_nonceNotFoundError_desc="nonce not found",a_authTimeNotFoundError_code="auth_time_not_found",a_authTimeNotFoundError_desc="Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",a_maxAgeTranspiredError_code="max_age_transpired",a_maxAgeTranspiredError_desc="Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",a_multipleMatchingTokens_code="multiple_matching_tokens",a_multipleMatchingTokens_desc="The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",a_multipleMatchingAccounts_code="multiple_matching_accounts",a_multipleMatchingAccounts_desc="The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",a_multipleMatchingAppMetadata_code="multiple_matching_appMetadata",a_multipleMatchingAppMetadata_desc="The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",a_tokenRequestCannotBeMade_code="request_cannot_be_made",a_tokenRequestCannotBeMade_desc="Token request cannot be made without authorization code or refresh token.",a_appendEmptyScopeError_code="cannot_append_empty_scope",a_appendEmptyScopeError_desc="Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info.",a_removeEmptyScopeError_code="cannot_remove_empty_scope",a_removeEmptyScopeError_desc="Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info.",a_appendScopeSetError_code="cannot_append_scopeset",a_appendScopeSetError_desc="Cannot append ScopeSet due to error.",a_emptyInputScopeSetError_code="empty_input_scopeset",a_emptyInputScopeSetError_desc="Empty input ScopeSet cannot be processed.",a_DeviceCodePollingCancelled_code="device_code_polling_cancelled",a_DeviceCodePollingCancelled_desc="Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",a_DeviceCodeExpired_code="device_code_expired",a_DeviceCodeExpired_desc="Device code is expired.",a_DeviceCodeUnknownError_code="device_code_unknown_error",a_DeviceCodeUnknownError_desc="Device code stopped polling for unknown reasons.",a_NoAccountInSilentRequest_code="no_account_in_silent_request",a_NoAccountInSilentRequest_desc="Please pass an account object, silent flow is not supported without account information",a_invalidCacheRecord_code="invalid_cache_record",a_invalidCacheRecord_desc="Cache record object was null or undefined.",a_invalidCacheEnvironment_code="invalid_cache_environment",a_invalidCacheEnvironment_desc="Invalid environment when attempting to create cache entry",a_noAccountFound_code="no_account_found",a_noAccountFound_desc="No account found in cache for given key.",a_CachePluginError_code="no cache plugin set on CacheManager",a_CachePluginError_desc="ICachePlugin needs to be set before using readFromStorage or writeFromStorage",a_noCryptoObj_code="no_crypto_object",a_noCryptoObj_desc="No crypto object detected. This is required for the following operation: ",a_invalidCacheType_code="invalid_cache_type",a_invalidCacheType_desc="Invalid cache type",a_unexpectedAccountType_code="unexpected_account_type",a_unexpectedAccountType_desc="Unexpected account type.",a_unexpectedCredentialType_code="unexpected_credential_type",a_unexpectedCredentialType_desc="Unexpected credential type.",a_invalidAssertion_code="invalid_assertion",a_invalidAssertion_desc="Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",a_invalidClientCredential_code="invalid_client_credential",a_invalidClientCredential_desc="Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",a_tokenRefreshRequired_code="token_refresh_required",a_tokenRefreshRequired_desc="Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",a_userTimeoutReached_code="user_timeout_reached",a_userTimeoutReached_desc="User defined timeout for device code polling reached",a_tokenClaimsRequired_code="token_claims_cnf_required_for_signedjwt",a_tokenClaimsRequired_desc="Cannot generate a POP jwt if the token_claims are not populated",a_noAuthorizationCodeFromServer_code="authorization_code_missing_from_server_response",a_noAuthorizationCodeFromServer_desc="Server response does not contain an authorization code to proceed",a_bindingKeyNotRemovedError_code="binding_key_not_removed",a_bindingKeyNotRemovedError_desc="Could not remove the credential's binding key from storage.",a_logoutNotSupported_code="end_session_endpoint_not_supported",a_logoutNotSupported_desc="Provided authority does not support logout.",a_keyIdMissing_code="key_id_missing",a_keyIdMissing_desc="A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",f=function(n){function e(t,r){var o=n.call(this,t,r)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,e.prototype),o}return se(e,n),e.createClientInfoDecodingError=function(t){return new e(a_clientInfoDecodingError_code,a_clientInfoDecodingError_desc+" Failed with error: "+t)},e.createClientInfoEmptyError=function(){return new e(a_clientInfoEmptyError_code,""+a_clientInfoEmptyError_desc)},e.createTokenParsingError=function(t){return new e(a_tokenParsingError_code,a_tokenParsingError_desc+" Failed with error: "+t)},e.createTokenNullOrEmptyError=function(t){return new e(a_nullOrEmptyToken_code,a_nullOrEmptyToken_desc+" Raw Token Value: "+t)},e.createEndpointDiscoveryIncompleteError=function(t){return new e(a_endpointResolutionError_code,a_endpointResolutionError_desc+" Detail: "+t)},e.createNetworkError=function(t,r){return new e(a_networkError_code,a_networkError_desc+" | Fetch client threw: "+r+" | Attempted to reach: "+t.split("?")[0])},e.createUnableToGetOpenidConfigError=function(t){return new e(a_unableToGetOpenidConfigError_code,a_unableToGetOpenidConfigError_desc+" Attempted to retrieve endpoints from: "+t)},e.createHashNotDeserializedError=function(t){return new e(a_hashNotDeserialized_code,a_hashNotDeserialized_desc+" Given Object: "+t)},e.createInvalidStateError=function(t,r){return new e(a_invalidStateError_code,a_invalidStateError_desc+" Invalid State: "+t+", Root Err: "+r)},e.createStateMismatchError=function(){return new e(a_stateMismatchError_code,a_stateMismatchError_desc)},e.createStateNotFoundError=function(t){return new e(a_stateNotFoundError_code,a_stateNotFoundError_desc+":  "+t)},e.createNonceMismatchError=function(){return new e(a_nonceMismatchError_code,a_nonceMismatchError_desc)},e.createAuthTimeNotFoundError=function(){return new e(a_authTimeNotFoundError_code,a_authTimeNotFoundError_desc)},e.createMaxAgeTranspiredError=function(){return new e(a_maxAgeTranspiredError_code,a_maxAgeTranspiredError_desc)},e.createNonceNotFoundError=function(t){return new e(a_nonceNotFoundError_code,a_nonceNotFoundError_desc+":  "+t)},e.createMultipleMatchingTokensInCacheError=function(){return new e(a_multipleMatchingTokens_code,a_multipleMatchingTokens_desc+".")},e.createMultipleMatchingAccountsInCacheError=function(){return new e(a_multipleMatchingAccounts_code,a_multipleMatchingAccounts_desc)},e.createMultipleMatchingAppMetadataInCacheError=function(){return new e(a_multipleMatchingAppMetadata_code,a_multipleMatchingAppMetadata_desc)},e.createTokenRequestCannotBeMadeError=function(){return new e(a_tokenRequestCannotBeMade_code,a_tokenRequestCannotBeMade_desc)},e.createAppendEmptyScopeToSetError=function(t){return new e(a_appendEmptyScopeError_code,a_appendEmptyScopeError_desc+" Given Scope: "+t)},e.createRemoveEmptyScopeFromSetError=function(t){return new e(a_removeEmptyScopeError_code,a_removeEmptyScopeError_desc+" Given Scope: "+t)},e.createAppendScopeSetError=function(t){return new e(a_appendScopeSetError_code,a_appendScopeSetError_desc+" Detail Error: "+t)},e.createEmptyInputScopeSetError=function(){return new e(a_emptyInputScopeSetError_code,""+a_emptyInputScopeSetError_desc)},e.createDeviceCodeCancelledError=function(){return new e(a_DeviceCodePollingCancelled_code,""+a_DeviceCodePollingCancelled_desc)},e.createDeviceCodeExpiredError=function(){return new e(a_DeviceCodeExpired_code,""+a_DeviceCodeExpired_desc)},e.createDeviceCodeUnknownError=function(){return new e(a_DeviceCodeUnknownError_code,""+a_DeviceCodeUnknownError_desc)},e.createNoAccountInSilentRequestError=function(){return new e(a_NoAccountInSilentRequest_code,""+a_NoAccountInSilentRequest_desc)},e.createNullOrUndefinedCacheRecord=function(){return new e(a_invalidCacheRecord_code,a_invalidCacheRecord_desc)},e.createInvalidCacheEnvironmentError=function(){return new e(a_invalidCacheEnvironment_code,a_invalidCacheEnvironment_desc)},e.createNoAccountFoundError=function(){return new e(a_noAccountFound_code,a_noAccountFound_desc)},e.createCachePluginError=function(){return new e(a_CachePluginError_code,""+a_CachePluginError_desc)},e.createNoCryptoObjectError=function(t){return new e(a_noCryptoObj_code,""+a_noCryptoObj_desc+t)},e.createInvalidCacheTypeError=function(){return new e(a_invalidCacheType_code,""+a_invalidCacheType_desc)},e.createUnexpectedAccountTypeError=function(){return new e(a_unexpectedAccountType_code,""+a_unexpectedAccountType_desc)},e.createUnexpectedCredentialTypeError=function(){return new e(a_unexpectedCredentialType_code,""+a_unexpectedCredentialType_desc)},e.createInvalidAssertionError=function(){return new e(a_invalidAssertion_code,""+a_invalidAssertion_desc)},e.createInvalidCredentialError=function(){return new e(a_invalidClientCredential_code,""+a_invalidClientCredential_desc)},e.createRefreshRequiredError=function(){return new e(a_tokenRefreshRequired_code,a_tokenRefreshRequired_desc)},e.createUserTimeoutReachedError=function(){return new e(a_userTimeoutReached_code,a_userTimeoutReached_desc)},e.createTokenClaimsRequiredError=function(){return new e(a_tokenClaimsRequired_code,a_tokenClaimsRequired_desc)},e.createNoAuthCodeInServerResponseError=function(){return new e(a_noAuthorizationCodeFromServer_code,a_noAuthorizationCodeFromServer_desc)},e.createBindingKeyNotRemovedError=function(){return new e(a_bindingKeyNotRemovedError_code,a_bindingKeyNotRemovedError_desc)},e.createLogoutNotSupportedError=function(){return new e(a_logoutNotSupported_code,a_logoutNotSupported_desc)},e.createKeyIdMissingError=function(){return new e(a_keyIdMissing_code,a_keyIdMissing_desc)},e}(S),y=function(){function n(){}return n.decodeAuthToken=function(e){if(n.isEmpty(e))throw f.createTokenNullOrEmptyError(e);var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!r||r.length<4)throw f.createTokenParsingError("Given token is malformed: "+JSON.stringify(e));return{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},n.isEmpty=function(e){return typeof e>"u"||!e||0===e.length},n.isEmptyObj=function(e){if(e&&!n.isEmpty(e))try{var t=JSON.parse(e);return 0===Object.keys(t).length}catch{}return!0},n.startsWith=function(e,t){return 0===e.indexOf(t)},n.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},n.queryStringToObject=function(e){var t={},r=e.split("&"),o=function(i){return decodeURIComponent(i.replace(/\+/g," "))};return r.forEach(function(i){if(i.trim()){var s=i.split(/=(.+)/g,2),c=s[0],u=s[1];c&&u&&(t[o(c)]=o(u))}}),t},n.trimArrayEntries=function(e){return e.map(function(t){return t.trim()})},n.removeEmptyStringsFromArray=function(e){return e.filter(function(t){return!n.isEmpty(t)})},n.jsonParseHelper=function(e){try{return JSON.parse(e)}catch{return null}},n.matchPattern=function(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)},n}(),m_pkceNotGenerated_code="pkce_not_created",m_pkceNotGenerated_desc="The PKCE code challenge and verifier could not be generated.",m_cryptoDoesNotExist_code="crypto_nonexistent",m_cryptoDoesNotExist_desc="The crypto object or function is not available.",m_httpMethodNotImplementedError_code="http_method_not_implemented",m_httpMethodNotImplementedError_desc="The HTTP method given has not been implemented in this library.",m_emptyNavigateUriError_code="empty_navigate_uri",m_emptyNavigateUriError_desc="Navigation URI is empty. Please check stack trace for more info.",m_hashEmptyError_code="hash_empty_error",m_hashEmptyError_desc="Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. For more visit: aka.ms/msaljs/browser-errors.",m_hashDoesNotContainStateError_code="no_state_in_hash",m_hashDoesNotContainStateError_desc="Hash does not contain state. Please verify that the request originated from msal.",m_hashDoesNotContainKnownPropertiesError_code="hash_does_not_contain_known_properties",m_hashDoesNotContainKnownPropertiesError_desc="Hash does not contain known properites. Please verify that your redirectUri is not changing the hash. For more visit: aka.ms/msaljs/browser-errors.",m_unableToParseStateError_code="unable_to_parse_state",m_unableToParseStateError_desc="Unable to parse state. Please verify that the request originated from msal.",m_stateInteractionTypeMismatchError_code="state_interaction_type_mismatch",m_stateInteractionTypeMismatchError_desc="Hash contains state but the interaction type does not match the caller.",m_interactionInProgress_code="interaction_in_progress",m_interactionInProgress_desc="Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors.",m_popupWindowError_code="popup_window_error",m_popupWindowError_desc="Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",m_emptyWindowError_code="empty_window_error",m_emptyWindowError_desc="window.open returned null or undefined window object.",m_userCancelledError_code="user_cancelled",m_userCancelledError_desc="User cancelled the flow.",m_monitorPopupTimeoutError_code="monitor_window_timeout",m_monitorPopupTimeoutError_desc="Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors.",m_monitorIframeTimeoutError_code="monitor_window_timeout",m_monitorIframeTimeoutError_desc="Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors.",m_redirectInIframeError_code="redirect_in_iframe",m_redirectInIframeError_desc="Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",m_blockTokenRequestsInHiddenIframeError_code="block_iframe_reload",m_blockTokenRequestsInHiddenIframeError_desc="Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors",m_blockAcquireTokenInPopupsError_code="block_nested_popups",m_blockAcquireTokenInPopupsError_desc="Request was blocked inside a popup because MSAL detected it was running in a popup.",m_iframeClosedPrematurelyError_code="iframe_closed_prematurely",m_iframeClosedPrematurelyError_desc="The iframe being monitored was closed prematurely.",m_silentLogoutUnsupportedError_code="silent_logout_unsupported",m_silentLogoutUnsupportedError_desc="Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",m_noAccountError_code="no_account_error",m_noAccountError_desc="No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",m_silentPromptValueError_code="silent_prompt_value_error",m_silentPromptValueError_desc="The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",m_noTokenRequestCacheError_code="no_token_request_cache_error",m_noTokenRequestCacheError_desc="No token request found in cache.",m_unableToParseTokenRequestCacheError_code="unable_to_parse_token_request_cache_error",m_unableToParseTokenRequestCacheError_desc="The cached token request could not be parsed.",m_noCachedAuthorityError_code="no_cached_authority_error",m_noCachedAuthorityError_desc="No cached authority found.",m_authRequestNotSet_code="auth_request_not_set_error",m_authRequestNotSet_desc="Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",m_invalidCacheType_code="invalid_cache_type",m_invalidCacheType_desc="Invalid cache type",m_notInBrowserEnvironment_code="non_browser_environment",m_notInBrowserEnvironment_desc="Login and token requests are not supported in non-browser environments.",m_databaseNotOpen_code="database_not_open",m_databaseNotOpen_desc="Database is not open!",m_noNetworkConnectivity_code="no_network_connectivity",m_noNetworkConnectivity_desc="No network connectivity. Check your internet connection.",m_postRequestFailed_code="post_request_failed",m_postRequestFailed_desc="Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",m_getRequestFailed_code="get_request_failed",m_getRequestFailed_desc="Network request failed. Please check the network trace to determine root cause.",m_failedToParseNetworkResponse_code="failed_to_parse_response",m_failedToParseNetworkResponse_desc="Failed to parse network response. Check network trace.",m_unableToLoadTokenError_code="unable_to_load_token",m_unableToLoadTokenError_desc="Error loading token to cache.",m_signingKeyNotFoundInStorage_code="crypto_key_not_found",m_signingKeyNotFoundInStorage_desc="Cryptographic Key or Keypair not found in browser storage.",m_authCodeRequired_code="auth_code_required",m_authCodeRequired_desc="An authorization code must be provided (as the `code` property on the request) to this flow.",m_authCodeOrNativeAccountRequired_code="auth_code_or_nativeAccountId_required",m_authCodeOrNativeAccountRequired_desc="An authorization code or nativeAccountId must be provided to this flow.",m_databaseUnavailable_code="database_unavailable",m_databaseUnavailable_desc="IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",m_unableToAcquireTokenFromNativePlatform_code="unable_to_acquire_token_from_native_platform",m_unableToAcquireTokenFromNativePlatform_desc="Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors.",m_nativeHandshakeTimeout_code="native_handshake_timeout",m_nativeHandshakeTimeout_desc="Timed out while attempting to establish connection to browser extension",m_nativeExtensionNotInstalled_code="native_extension_not_installed",m_nativeExtensionNotInstalled_desc="Native extension is not installed. If you think this is a mistake call the initialize function.",m_nativeConnectionNotEstablished_code="native_connection_not_established",m_nativeConnectionNotEstablished_desc="Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors.",m_nativeBrokerCalledBeforeInitialize_code="native_broker_called_before_initialize",m_nativeBrokerCalledBeforeInitialize_desc="You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors.",m_nativePromptNotSupported_code="native_prompt_not_supported",m_nativePromptNotSupported_desc="The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",E=function(n){function e(t,r){var o=n.call(this,t,r)||this;return Object.setPrototypeOf(o,e.prototype),o.name="BrowserAuthError",o}return he(e,n),e.createPkceNotGeneratedError=function(t){return new e(m_pkceNotGenerated_code,m_pkceNotGenerated_desc+" Detail:"+t)},e.createCryptoNotAvailableError=function(t){return new e(m_cryptoDoesNotExist_code,m_cryptoDoesNotExist_desc+" Detail:"+t)},e.createHttpMethodNotImplementedError=function(t){return new e(m_httpMethodNotImplementedError_code,m_httpMethodNotImplementedError_desc+" Given Method: "+t)},e.createEmptyNavigationUriError=function(){return new e(m_emptyNavigateUriError_code,m_emptyNavigateUriError_desc)},e.createEmptyHashError=function(t){return new e(m_hashEmptyError_code,m_hashEmptyError_desc+" Given Url: "+t)},e.createHashDoesNotContainStateError=function(){return new e(m_hashDoesNotContainStateError_code,m_hashDoesNotContainStateError_desc)},e.createHashDoesNotContainKnownPropertiesError=function(){return new e(m_hashDoesNotContainKnownPropertiesError_code,m_hashDoesNotContainKnownPropertiesError_desc)},e.createUnableToParseStateError=function(){return new e(m_unableToParseStateError_code,m_unableToParseStateError_desc)},e.createStateInteractionTypeMismatchError=function(){return new e(m_stateInteractionTypeMismatchError_code,m_stateInteractionTypeMismatchError_desc)},e.createInteractionInProgressError=function(){return new e(m_interactionInProgress_code,m_interactionInProgress_desc)},e.createPopupWindowError=function(t){var r=m_popupWindowError_desc;return r=y.isEmpty(t)?r:r+" Details: "+t,new e(m_popupWindowError_code,r)},e.createEmptyWindowCreatedError=function(){return new e(m_emptyWindowError_code,m_emptyWindowError_desc)},e.createUserCancelledError=function(){return new e(m_userCancelledError_code,m_userCancelledError_desc)},e.createMonitorPopupTimeoutError=function(){return new e(m_monitorPopupTimeoutError_code,m_monitorPopupTimeoutError_desc)},e.createMonitorIframeTimeoutError=function(){return new e(m_monitorIframeTimeoutError_code,m_monitorIframeTimeoutError_desc)},e.createRedirectInIframeError=function(t){return new e(m_redirectInIframeError_code,m_redirectInIframeError_desc+" (window.parent !== window) => "+t)},e.createBlockReloadInHiddenIframeError=function(){return new e(m_blockTokenRequestsInHiddenIframeError_code,m_blockTokenRequestsInHiddenIframeError_desc)},e.createBlockAcquireTokenInPopupsError=function(){return new e(m_blockAcquireTokenInPopupsError_code,m_blockAcquireTokenInPopupsError_desc)},e.createIframeClosedPrematurelyError=function(){return new e(m_iframeClosedPrematurelyError_code,m_iframeClosedPrematurelyError_desc)},e.createSilentLogoutUnsupportedError=function(){return new e(m_silentLogoutUnsupportedError_code,m_silentLogoutUnsupportedError_desc)},e.createNoAccountError=function(){return new e(m_noAccountError_code,m_noAccountError_desc)},e.createSilentPromptValueError=function(t){return new e(m_silentPromptValueError_code,m_silentPromptValueError_desc+" Given value: "+t)},e.createUnableToParseTokenRequestCacheError=function(){return new e(m_unableToParseTokenRequestCacheError_code,m_unableToParseTokenRequestCacheError_desc)},e.createNoTokenRequestCacheError=function(){return new e(m_noTokenRequestCacheError_code,m_noTokenRequestCacheError_desc)},e.createAuthRequestNotSetError=function(){return new e(m_authRequestNotSet_code,m_authRequestNotSet_desc)},e.createNoCachedAuthorityError=function(){return new e(m_noCachedAuthorityError_code,m_noCachedAuthorityError_desc)},e.createInvalidCacheTypeError=function(){return new e(m_invalidCacheType_code,""+m_invalidCacheType_desc)},e.createNonBrowserEnvironmentError=function(){return new e(m_notInBrowserEnvironment_code,m_notInBrowserEnvironment_desc)},e.createDatabaseNotOpenError=function(){return new e(m_databaseNotOpen_code,m_databaseNotOpen_desc)},e.createNoNetworkConnectivityError=function(){return new e(m_noNetworkConnectivity_code,m_noNetworkConnectivity_desc)},e.createPostRequestFailedError=function(t,r){return new e(m_postRequestFailed_code,m_postRequestFailed_desc+" | Network client threw: "+t+" | Attempted to reach: "+r.split("?")[0])},e.createGetRequestFailedError=function(t,r){return new e(m_getRequestFailed_code,m_getRequestFailed_desc+" | Network client threw: "+t+" | Attempted to reach: "+r.split("?")[0])},e.createFailedToParseNetworkResponseError=function(t){return new e(m_failedToParseNetworkResponse_code,m_failedToParseNetworkResponse_desc+" | Attempted to reach: "+t.split("?")[0])},e.createUnableToLoadTokenError=function(t){return new e(m_unableToLoadTokenError_code,m_unableToLoadTokenError_desc+" | "+t)},e.createSigningKeyNotFoundInStorageError=function(t){return new e(m_signingKeyNotFoundInStorage_code,m_signingKeyNotFoundInStorage_desc+" | No match found for KeyId: "+t)},e.createAuthCodeRequiredError=function(){return new e(m_authCodeRequired_code,m_authCodeRequired_desc)},e.createAuthCodeOrNativeAccountIdRequiredError=function(){return new e(m_authCodeOrNativeAccountRequired_code,m_authCodeOrNativeAccountRequired_desc)},e.createDatabaseUnavailableError=function(){return new e(m_databaseUnavailable_code,m_databaseUnavailable_desc)},e.createUnableToAcquireTokenFromNativePlatformError=function(){return new e(m_unableToAcquireTokenFromNativePlatform_code,m_unableToAcquireTokenFromNativePlatform_desc)},e.createNativeHandshakeTimeoutError=function(){return new e(m_nativeHandshakeTimeout_code,m_nativeHandshakeTimeout_desc)},e.createNativeExtensionNotInstalledError=function(){return new e(m_nativeExtensionNotInstalled_code,m_nativeExtensionNotInstalled_desc)},e.createNativeConnectionNotEstablishedError=function(){return new e(m_nativeConnectionNotEstablished_code,m_nativeConnectionNotEstablished_desc)},e.createNativeBrokerCalledBeforeInitialize=function(){return new e(m_nativeBrokerCalledBeforeInitialize_code,m_nativeBrokerCalledBeforeInitialize_desc)},e.createNativePromptParameterNotSupportedError=function(){return new e(m_nativePromptNotSupported_code,m_nativePromptNotSupported_desc)},e}(S),x=function(){function n(e){this.base64Encode=new R,this.cryptoObj=e}return n.prototype.generateCodes=function(){return p(this,void 0,void 0,function(){var e,t;return O(this,function(r){switch(r.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=r.sent(),[2,{verifier:e,challenge:t}]}})})},n.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(r){throw E.createPkceNotGeneratedError(r)}},n.prototype.generateCodeChallengeFromVerifier=function(e){return p(this,void 0,void 0,function(){var t,r;return O(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=o.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=o.sent(),E.createPkceNotGeneratedError(r);case 3:return[2]}})})},n}(),J=function(){function n(){}return n.prototype.getRandomValues=function(e){return window.crypto.getRandomValues(e)},n.prototype.generateKey=function(e,t,r){return p(this,void 0,void 0,function(){return O(this,function(o){return[2,window.crypto.subtle.generateKey(e,t,r)]})})},n.prototype.exportKey=function(e){return p(this,void 0,void 0,function(){return O(this,function(t){return[2,window.crypto.subtle.exportKey(Ot,e)]})})},n.prototype.importKey=function(e,t,r,o){return p(this,void 0,void 0,function(){return O(this,function(i){return[2,window.crypto.subtle.importKey(Ot,e,t,r,o)]})})},n.prototype.sign=function(e,t,r){return p(this,void 0,void 0,function(){return O(this,function(o){return[2,window.crypto.subtle.sign(e,t,r)]})})},n.prototype.digest=function(e,t){return p(this,void 0,void 0,function(){return O(this,function(r){return[2,window.crypto.subtle.digest(e,t)]})})},n}(),X=function(){function n(){}return n.prototype.initPrng=function(e){return window.msrCrypto.initPrng(dt(e))},n.prototype.getRandomValues=function(e){return window.msrCrypto.getRandomValues(e)},n.prototype.generateKey=function(e,t,r){return p(this,void 0,void 0,function(){return O(this,function(o){return[2,window.msrCrypto.subtle.generateKey(e,t,r)]})})},n.prototype.exportKey=function(e){return p(this,void 0,void 0,function(){return O(this,function(t){return[2,window.msrCrypto.subtle.exportKey(Ot,e)]})})},n.prototype.importKey=function(e,t,r,o){return p(this,void 0,void 0,function(){return O(this,function(i){return[2,window.msrCrypto.subtle.importKey(Ot,e,t,r,o)]})})},n.prototype.sign=function(e,t,r){return p(this,void 0,void 0,function(){return O(this,function(o){return[2,window.msrCrypto.subtle.sign(e,t,r)]})})},n.prototype.digest=function(e,t){return p(this,void 0,void 0,function(){return O(this,function(r){return[2,window.msrCrypto.subtle.digest(e,t)]})})},n}(),L=function(){function n(){}return n.prototype.getRandomValues=function(e){return window.msCrypto.getRandomValues(e)},n.prototype.generateKey=function(e,t,r){return p(this,void 0,void 0,function(){return O(this,function(o){return[2,new Promise(function(i,s){var c=window.msCrypto.subtle.generateKey(e,t,r);c.addEventListener("complete",function(u){i(u.target.result)}),c.addEventListener("error",function(u){s(u)})})]})})},n.prototype.exportKey=function(e){return p(this,void 0,void 0,function(){return O(this,function(t){return[2,new Promise(function(r,o){var i=window.msCrypto.subtle.exportKey(Ot,e);i.addEventListener("complete",function(s){var u=vt.utf8ArrToString(new Uint8Array(s.target.result)).replace(/\r/g,v.EMPTY_STRING).replace(/\n/g,v.EMPTY_STRING).replace(/\t/g,v.EMPTY_STRING).split(" ").join(v.EMPTY_STRING).replace("\0",v.EMPTY_STRING);try{r(JSON.parse(u))}catch(d){o(d)}}),i.addEventListener("error",function(s){o(s)})})]})})},n.prototype.importKey=function(e,t,r,o){return p(this,void 0,void 0,function(){var i,s;return O(this,function(c){return i=vt.getSortedObjectString(e),s=vt.stringToArrayBuffer(i),[2,new Promise(function(u,d){var g=window.msCrypto.subtle.importKey(Ot,s,t,r,o);g.addEventListener("complete",function(C){u(C.target.result)}),g.addEventListener("error",function(C){d(C)})})]})})},n.prototype.sign=function(e,t,r){return p(this,void 0,void 0,function(){return O(this,function(o){return[2,new Promise(function(i,s){var c=window.msCrypto.subtle.sign(e,t,r);c.addEventListener("complete",function(u){i(u.target.result)}),c.addEventListener("error",function(u){s(u)})})]})})},n.prototype.digest=function(e,t){return p(this,void 0,void 0,function(){return O(this,function(r){return[2,new Promise(function(o,i){var s=window.msCrypto.subtle.digest(e,t.buffer);s.addEventListener("complete",function(c){o(c.target.result)}),s.addEventListener("error",function(c){i(c)})})]})})},n}(),Y_redirectUriNotSet_code="redirect_uri_empty",Y_redirectUriNotSet_desc="A redirect URI is required for all calls, and none has been set.",Y_postLogoutUriNotSet_code="post_logout_uri_empty",Y_postLogoutUriNotSet_desc="A post logout redirect has not been set.",Y_storageNotSupportedError_code="storage_not_supported",Y_storageNotSupportedError_desc="Given storage configuration option was not supported.",Y_noRedirectCallbacksSet_code="no_redirect_callbacks",Y_noRedirectCallbacksSet_desc="No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics.",Y_stubPcaInstanceCalled_code="stubbed_public_client_application_called",Y_stubPcaInstanceCalled_desc="Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",Y_inMemRedirectUnavailable_code="in_mem_redirect_unavailable",Y_inMemRedirectUnavailable_desc="Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true.",Y_entropyNotProvided_code="entropy_not_provided",Y_entropyNotProvided_desc="The available browser crypto interface requires entropy set via system.cryptoOptions.entropy configuration option.",$=function(n){function e(t,r){var o=n.call(this,t,r)||this;return o.name="BrowserConfigurationAuthError",Object.setPrototypeOf(o,e.prototype),o}return he(e,n),e.createRedirectUriEmptyError=function(){return new e(Y_redirectUriNotSet_code,Y_redirectUriNotSet_desc)},e.createPostLogoutRedirectUriEmptyError=function(){return new e(Y_postLogoutUriNotSet_code,Y_postLogoutUriNotSet_desc)},e.createStorageNotSupportedError=function(t){return new e(Y_storageNotSupportedError_code,Y_storageNotSupportedError_desc+" Given Location: "+t)},e.createRedirectCallbacksNotSetError=function(){return new e(Y_noRedirectCallbacksSet_code,Y_noRedirectCallbacksSet_desc)},e.createStubPcaInstanceCalledError=function(){return new e(Y_stubPcaInstanceCalled_code,Y_stubPcaInstanceCalled_desc)},e.createInMemoryRedirectUnavailableError=function(){return new e(Y_inMemRedirectUnavailable_code,Y_inMemRedirectUnavailable_desc)},e.createEntropyNotProvided=function(){return new e(Y_entropyNotProvided_code,Y_entropyNotProvided_desc)},e}(S),Re="SHA-256",pt=new Uint8Array([1,0,1]),me=function(){function n(e,t){var r,o;if(this.logger=e,this.cryptoOptions=t,this.hasBrowserCrypto())this.logger.verbose("BrowserCrypto: modern crypto interface available"),this.subtleCrypto=new J;else if(this.hasIECrypto())this.logger.verbose("BrowserCrypto: MS crypto interface available"),this.subtleCrypto=new L;else{if(!this.hasMsrCrypto()||!(null===(r=this.cryptoOptions)||void 0===r?void 0:r.useMsrCrypto))throw this.hasMsrCrypto()&&this.logger.info("BrowserCrypto: MSR Crypto interface available but system.cryptoOptions.useMsrCrypto not enabled"),this.logger.error("BrowserCrypto: No crypto interfaces available."),E.createCryptoNotAvailableError("Browser crypto, msCrypto, or msrCrypto interfaces not available.");this.logger.verbose("BrowserCrypto: MSR crypto interface available"),this.subtleCrypto=new X}if(this.subtleCrypto.initPrng){if(this.logger.verbose("BrowserCrypto: Interface requires entropy"),null===(o=this.cryptoOptions)||void 0===o||!o.entropy)throw this.logger.error("BrowserCrypto: Interface requires entropy but none provided."),$.createEntropyNotProvided();this.logger.verbose("BrowserCrypto: Entropy provided"),this.subtleCrypto.initPrng(this.cryptoOptions.entropy)}this.keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:Re,modulusLength:2048,publicExponent:pt}}return n.prototype.hasIECrypto=function(){return"msCrypto"in window},n.prototype.hasBrowserCrypto=function(){return"crypto"in window},n.prototype.hasMsrCrypto=function(){return"msrCrypto"in window},n.prototype.sha256Digest=function(e){return p(this,void 0,void 0,function(){var t;return O(this,function(r){return t=vt.stringToUtf8Arr(e),[2,this.subtleCrypto.digest({name:Re},t)]})})},n.prototype.getRandomValues=function(e){return this.subtleCrypto.getRandomValues(e)},n.prototype.generateKeyPair=function(e,t){return p(this,void 0,void 0,function(){return O(this,function(r){return[2,this.subtleCrypto.generateKey(this.keygenAlgorithmOptions,e,t)]})})},n.prototype.exportJwk=function(e){return p(this,void 0,void 0,function(){return O(this,function(t){return[2,this.subtleCrypto.exportKey(e)]})})},n.prototype.importJwk=function(e,t,r){return p(this,void 0,void 0,function(){return O(this,function(o){return[2,this.subtleCrypto.importKey(e,this.keygenAlgorithmOptions,t,r)]})})},n.prototype.sign=function(e,t){return p(this,void 0,void 0,function(){return O(this,function(r){return[2,this.subtleCrypto.sign(this.keygenAlgorithmOptions,e,t)]})})},n}(),Kt=function(){function n(){this.dbName=Ft,this.version=1,this.tableName="msal.db.keys",this.dbOpen=!1}return n.prototype.open=function(){return p(this,void 0,void 0,function(){var e=this;return O(this,function(t){return[2,new Promise(function(r,o){var i=window.indexedDB.open(e.dbName,e.version);i.addEventListener("upgradeneeded",function(s){s.target.result.createObjectStore(e.tableName)}),i.addEventListener("success",function(s){e.db=s.target.result,e.dbOpen=!0,r()}),i.addEventListener("error",function(){return o(E.createDatabaseUnavailableError())})})]})})},n.prototype.closeConnection=function(){var e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)},n.prototype.validateDbIsOpen=function(){return p(this,void 0,void 0,function(){return O(this,function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,e.sent()];case 2:return[2]}})})},n.prototype.getItem=function(e){return p(this,void 0,void 0,function(){var t=this;return O(this,function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise(function(o,i){if(!t.db)return i(E.createDatabaseNotOpenError());var u=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);u.addEventListener("success",function(d){var g=d;t.closeConnection(),o(g.target.result)}),u.addEventListener("error",function(d){t.closeConnection(),i(d)})})]}})})},n.prototype.setItem=function(e,t){return p(this,void 0,void 0,function(){var r=this;return O(this,function(o){switch(o.label){case 0:return[4,this.validateDbIsOpen()];case 1:return o.sent(),[2,new Promise(function(i,s){if(!r.db)return s(E.createDatabaseNotOpenError());var d=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(t,e);d.addEventListener("success",function(){r.closeConnection(),i()}),d.addEventListener("error",function(g){r.closeConnection(),s(g)})})]}})})},n.prototype.removeItem=function(e){return p(this,void 0,void 0,function(){var t=this;return O(this,function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise(function(o,i){if(!t.db)return i(E.createDatabaseNotOpenError());var u=t.db.transaction([t.tableName],"readwrite").objectStore(t.tableName).delete(e);u.addEventListener("success",function(){t.closeConnection(),o()}),u.addEventListener("error",function(d){t.closeConnection(),i(d)})})]}})})},n.prototype.getKeys=function(){return p(this,void 0,void 0,function(){var e=this;return O(this,function(t){switch(t.label){case 0:return[4,this.validateDbIsOpen()];case 1:return t.sent(),[2,new Promise(function(r,o){if(!e.db)return o(E.createDatabaseNotOpenError());var c=e.db.transaction([e.tableName],"readonly").objectStore(e.tableName).getAllKeys();c.addEventListener("success",function(u){var d=u;e.closeConnection(),r(d.target.result)}),c.addEventListener("error",function(u){e.closeConnection(),o(u)})})]}})})},n.prototype.containsKey=function(e){return p(this,void 0,void 0,function(){var t=this;return O(this,function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise(function(o,i){if(!t.db)return i(E.createDatabaseNotOpenError());var u=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).count(e);u.addEventListener("success",function(d){var g=d;t.closeConnection(),o(1===g.target.result)}),u.addEventListener("error",function(d){t.closeConnection(),i(d)})})]}})})},n.prototype.deleteDatabase=function(){return p(this,void 0,void 0,function(){return O(this,function(e){return this.db&&this.dbOpen&&this.closeConnection(),[2,new Promise(function(t,r){var o=window.indexedDB.deleteDatabase(Ft);o.addEventListener("success",function(){return t(!0)}),o.addEventListener("blocked",function(){return t(!0)}),o.addEventListener("error",function(){return r(!1)})})]})})},n}(),Wt=function(){function n(){this.cache=new Map}return n.prototype.getItem=function(e){return this.cache.get(e)||null},n.prototype.setItem=function(e,t){this.cache.set(e,t)},n.prototype.removeItem=function(e){this.cache.delete(e)},n.prototype.getKeys=function(){var e=[];return this.cache.forEach(function(t,r){e.push(r)}),e},n.prototype.containsKey=function(e){return this.cache.has(e)},n.prototype.clear=function(){this.cache.clear()},n}(),Qt=function(){function n(e,t){this.inMemoryCache=new Wt,this.indexedDBCache=new Kt,this.logger=e,this.storeName=t}return n.prototype.handleDatabaseAccessError=function(e){if(!(e instanceof E&&e.errorCode===m_databaseUnavailable_code))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},n.prototype.getItem=function(e){return p(this,void 0,void 0,function(){var t,r;return O(this,function(o){switch(o.label){case 0:if(t=this.inMemoryCache.getItem(e))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(e)];case 2:return[2,o.sent()];case 3:return r=o.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}})})},n.prototype.setItem=function(e,t){return p(this,void 0,void 0,function(){var r;return O(this,function(o){switch(o.label){case 0:this.inMemoryCache.setItem(e,t),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(e,t)];case 2:return o.sent(),[3,4];case 3:return r=o.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2]}})})},n.prototype.removeItem=function(e){return p(this,void 0,void 0,function(){var t;return O(this,function(r){switch(r.label){case 0:this.inMemoryCache.removeItem(e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(e)];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2]}})})},n.prototype.getKeys=function(){return p(this,void 0,void 0,function(){var e,t;return O(this,function(r){switch(r.label){case 0:if(0!==(e=this.inMemoryCache.getKeys()).length)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,r.sent()];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2,e]}})})},n.prototype.containsKey=function(e){return p(this,void 0,void 0,function(){var t,r;return O(this,function(o){switch(o.label){case 0:if(t=this.inMemoryCache.containsKey(e))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(e)];case 2:return[2,o.sent()];case 3:return r=o.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}})})},n.prototype.clearInMemory=function(){this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted")},n.prototype.clearPersistent=function(){return p(this,void 0,void 0,function(){var e,t;return O(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.logger.verbose("Deleting persistent keystore"),[4,this.indexedDBCache.deleteDatabase()];case 1:return(e=r.sent())&&this.logger.verbose("Persistent keystore deleted"),[2,e];case 2:return t=r.sent(),this.handleDatabaseAccessError(t),[2,!1];case 3:return[2]}})})},n}(),Mt=(()=>{return(n=Mt||(Mt={})).asymmetricKeys="asymmetricKeys",n.symmetricKeys="symmetricKeys",Mt;var n})(),ir=function(){function n(e){this.logger=e,this.asymmetricKeys=new Qt(this.logger,Mt.asymmetricKeys),this.symmetricKeys=new Qt(this.logger,Mt.symmetricKeys)}return n.prototype.clear=function(){return p(this,void 0,void 0,function(){var e;return O(this,function(t){switch(t.label){case 0:this.asymmetricKeys.clearInMemory(),this.symmetricKeys.clearInMemory(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.asymmetricKeys.clearPersistent()];case 2:return t.sent(),[2,!0];case 3:return(e=t.sent())instanceof Error?this.logger.error("Clearing keystore failed with error: "+e.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}})})},n}(),Vr=function(){function n(e,t,r){this.logger=e,this.browserCrypto=new me(this.logger,r),this.b64Encode=new R,this.b64Decode=new w,this.guidGenerator=new Tr(this.browserCrypto),this.pkceGenerator=new x(this.browserCrypto),this.cache=new ir(this.logger),this.performanceClient=t}return n.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},n.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},n.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},n.prototype.generatePkceCodes=function(){return p(this,void 0,void 0,function(){return O(this,function(e){return[2,this.pkceGenerator.generateCodes()]})})},n.prototype.getPublicKeyThumbprint=function(e){var t;return p(this,void 0,void 0,function(){var r,o,i,c,u,d,g;return O(this,function(C){switch(C.label){case 0:return r=null===(t=this.performanceClient)||void 0===t?void 0:t.startMeasurement(ue.CryptoOptsGetPublicKeyThumbprint,e.correlationId),[4,this.browserCrypto.generateKeyPair(n.EXTRACTABLE,n.POP_KEY_USAGES)];case 1:return o=C.sent(),[4,this.browserCrypto.exportJwk(o.publicKey)];case 2:return i=C.sent(),c=vt.getSortedObjectString({e:i.e,kty:i.kty,n:i.n}),[4,this.hashString(c)];case 3:return u=C.sent(),[4,this.browserCrypto.exportJwk(o.privateKey)];case 4:return d=C.sent(),[4,this.browserCrypto.importJwk(d,!1,["sign"])];case 5:return g=C.sent(),[4,this.cache.asymmetricKeys.setItem(u,{privateKey:g,publicKey:o.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri})];case 6:return C.sent(),r&&r.endMeasurement({success:!0}),[2,u]}})})},n.prototype.removeTokenBindingKey=function(e){return p(this,void 0,void 0,function(){return O(this,function(r){switch(r.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(e)];case 1:return r.sent(),[4,this.cache.asymmetricKeys.containsKey(e)];case 2:return[2,!r.sent()]}})})},n.prototype.clearKeystore=function(){return p(this,void 0,void 0,function(){return O(this,function(e){switch(e.label){case 0:return[4,this.cache.clear()];case 1:return[2,e.sent()]}})})},n.prototype.signJwt=function(e,t,r){var o;return p(this,void 0,void 0,function(){var i,s,c,u,d,g,C,_,N,F,q,de,te;return O(this,function(we){switch(we.label){case 0:return i=null===(o=this.performanceClient)||void 0===o?void 0:o.startMeasurement(ue.CryptoOptsSignJwt,r),[4,this.cache.asymmetricKeys.getItem(t)];case 1:if(!(s=we.sent()))throw E.createSigningKeyNotFoundInStorageError(t);return[4,this.browserCrypto.exportJwk(s.publicKey)];case 2:return c=we.sent(),u=vt.getSortedObjectString(c),d=this.b64Encode.urlEncode(JSON.stringify({kid:t})),g=Er.getShrHeaderString({kid:d,alg:c.alg}),C=this.b64Encode.urlEncode(g),e.cnf={jwk:JSON.parse(u)},_=this.b64Encode.urlEncode(JSON.stringify(e)),F=vt.stringToArrayBuffer(N=C+"."+_),[4,this.browserCrypto.sign(s.privateKey,F)];case 3:return q=we.sent(),de=this.b64Encode.urlEncodeArr(new Uint8Array(q)),te=N+"."+de,i&&i.endMeasurement({success:!0}),[2,te]}})})},n.prototype.hashString=function(e){return p(this,void 0,void 0,function(){var t,r;return O(this,function(o){switch(o.label){case 0:return[4,this.browserCrypto.sha256Digest(e)];case 1:return t=o.sent(),r=new Uint8Array(t),[2,this.b64Encode.urlEncodeArr(r)]}})})},n.POP_KEY_USAGES=["sign","verify"],n.EXTRACTABLE=!0,n}(),De=(()=>{return(n=De||(De={}))[n.Error=0]="Error",n[n.Warning=1]="Warning",n[n.Info=2]="Info",n[n.Verbose=3]="Verbose",n[n.Trace=4]="Trace",De;var n})(),Nr=function(){function n(e,t,r){this.level=De.Info,this.localCallback=e.loggerCallback||function(){},this.piiLoggingEnabled=e.piiLoggingEnabled||!1,this.level="number"==typeof e.logLevel?e.logLevel:De.Info,this.correlationId=e.correlationId||v.EMPTY_STRING,this.packageName=t||v.EMPTY_STRING,this.packageVersion=r||v.EMPTY_STRING}return n.prototype.clone=function(e,t,r){return new n({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)},n.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var o,r=(new Date).toUTCString();o=y.isEmpty(t.correlationId)?y.isEmpty(this.correlationId)?"["+r+"]":"["+r+"] : ["+this.correlationId+"]":"["+r+"] : ["+t.correlationId+"]",this.executeCallback(t.logLevel,o+" : "+this.packageName+"@"+this.packageVersion+" : "+De[t.logLevel]+" - "+e,t.containsPii||!1)}},n.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},n.prototype.error=function(e,t){this.logMessage(e,{logLevel:De.Error,containsPii:!1,correlationId:t||v.EMPTY_STRING})},n.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:De.Error,containsPii:!0,correlationId:t||v.EMPTY_STRING})},n.prototype.warning=function(e,t){this.logMessage(e,{logLevel:De.Warning,containsPii:!1,correlationId:t||v.EMPTY_STRING})},n.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:De.Warning,containsPii:!0,correlationId:t||v.EMPTY_STRING})},n.prototype.info=function(e,t){this.logMessage(e,{logLevel:De.Info,containsPii:!1,correlationId:t||v.EMPTY_STRING})},n.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:De.Info,containsPii:!0,correlationId:t||v.EMPTY_STRING})},n.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:De.Verbose,containsPii:!1,correlationId:t||v.EMPTY_STRING})},n.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:De.Verbose,containsPii:!0,correlationId:t||v.EMPTY_STRING})},n.prototype.trace=function(e,t){this.logMessage(e,{logLevel:De.Trace,containsPii:!1,correlationId:t||v.EMPTY_STRING})},n.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:De.Trace,containsPii:!0,correlationId:t||v.EMPTY_STRING})},n.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},n}(),Or=function(){function n(e,t,r,o,i,s){this.authority=t,this.libraryName=o,this.libraryVersion=i,this.applicationTelemetry=s,this.clientId=e,this.logger=r,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.staticFieldsByCorrelationId=new Map,this.measurementsById=new Map}return n.prototype.startMeasurement=function(e,t){var o,i,r=this,s=t||this.generateId();t||this.logger.info("PerformanceClient: No correlation id provided for "+e+", generating",s),this.logger.trace("PerformanceClient: Performance measurement started for "+e,s);var c=this.startPerformanceMeasuremeant(e,s);c.startMeasurement();var u={eventId:this.generateId(),status:qe.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:s};this.cacheEventByCorrelationId(u);var d={appName:null===(o=this.applicationTelemetry)||void 0===o?void 0:o.appName,appVersion:null===(i=this.applicationTelemetry)||void 0===i?void 0:i.appVersion};return this.addStaticFields(d,s),this.cacheMeasurement(u,c),{endMeasurement:function(g){var C=r.endMeasurement(j(j({},u),g));return C&&r.cacheEventByCorrelationId(C),C},flushMeasurement:function(){return r.flushMeasurements(u.name,u.correlationId)},discardMeasurement:function(){return r.discardMeasurements(u.correlationId)},addStaticFields:function(g){return r.addStaticFields(g,u.correlationId)},measurement:c,event:u}},n.prototype.endMeasurement=function(e){var t=this.measurementsById.get(e.eventId);if(t){this.measurementsById.delete(e.eventId),t.endMeasurement();var r=t.flushMeasurement();if(null!==r)return this.logger.trace("PerformanceClient: Performance measurement ended for "+e.name+": "+r+" ms",e.correlationId),j(j({durationMs:Math.round(r)},e),{status:qe.Completed});this.logger.trace("PerformanceClient: Performance measurement not taken",e.correlationId)}else this.logger.trace("PerformanceClient: Measurement not found for "+e.eventId,e.correlationId);return null},n.prototype.addStaticFields=function(e,t){var r=this.staticFieldsByCorrelationId.get(t);r?(this.logger.trace("PerformanceClient: Updating static fields"),this.staticFieldsByCorrelationId.set(t,j(j({},r),e))):(this.logger.trace("PerformanceClient: Adding static fields"),this.staticFieldsByCorrelationId.set(t,e))},n.prototype.cacheEventByCorrelationId=function(e){var t=this.eventsByCorrelationId.get(e.correlationId);t?(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" added/updated",e.correlationId),t.set(e.eventId,e)):(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" started",e.correlationId),this.eventsByCorrelationId.set(e.correlationId,(new Map).set(e.eventId,e)))},n.prototype.cacheMeasurement=function(e,t){this.measurementsById.set(e.eventId,t)},n.prototype.flushMeasurements=function(e,t){var r=this;this.logger.trace("PerformanceClient: Performance measurements flushed for "+e,t);var o=this.eventsByCorrelationId.get(t);if(o){this.discardMeasurements(t);var i=[];o.forEach(function(_){if(_.name!==e&&_.status!==qe.Completed){r.logger.trace("PerformanceClient: Incomplete submeasurement "+_.name+" found for "+e,t);var N=r.endMeasurement(_);N&&i.push(N)}i.push(_)});var s=i.sort(function(_,N){return _.startTimeMs-N.startTimeMs}),c=s.filter(function(_){return _.name===e&&_.status===qe.Completed});if(c.length>0){c.length>1&&this.logger.verbose("PerformanceClient: Multiple distinct top-level performance events found, using the first",t);var u=c[0];this.logger.verbose("PerformanceClient: Measurement found for "+e,t);var d=s.reduce(function(_,N){if(N.name!==e){r.logger.trace("PerformanceClient: Complete submeasurement found for "+N.name,t);var F=N.name+"DurationMs";_[F]?r.logger.verbose("PerformanceClient: Submeasurement for "+e+" already exists for "+N.name+", ignoring",t):_[F]=N.durationMs}return _},u),g=this.staticFieldsByCorrelationId.get(t),C=j(j({},d),g);this.emitEvents([C],d.correlationId)}else this.logger.verbose("PerformanceClient: No completed top-level measurements found for "+e,t)}else this.logger.verbose("PerformanceClient: No measurements found",t)},n.prototype.discardMeasurements=function(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e)},n.prototype.addPerformanceCallback=function(e){var t=this.generateId();return this.callbacks.set(t,e),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+t),t},n.prototype.removePerformanceCallback=function(e){var t=this.callbacks.delete(e);return this.logger.verbose(t?"PerformanceClient: Performance callback "+e+" removed.":"PerformanceClient: Performance callback "+e+" not removed."),t},n.prototype.emitEvents=function(e,t){var r=this;this.logger.verbose("PerformanceClient: Emitting performance events",t),this.callbacks.forEach(function(o,i){r.logger.trace("PerformanceClient: Emitting event to callback "+i,t),o.apply(null,[e])})},n}(),Yr=function(){function n(){}return n.prototype.startMeasurement=function(){},n.prototype.endMeasurement=function(){},n.prototype.flushMeasurement=function(){return null},n}(),Wr=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return se(e,n),e.prototype.generateId=function(){return"callback-id"},e.prototype.startPerformanceMeasuremeant=function(){return new Yr},e}(Or),sr={createNewGuid:function(){throw S.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw S.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw S.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return z(this,void 0,void 0,function(){return W(this,function(e){throw S.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")})})},getPublicKeyThumbprint:function(){return z(this,void 0,void 0,function(){return W(this,function(e){throw S.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")})})},removeTokenBindingKey:function(){return z(this,void 0,void 0,function(){return W(this,function(e){throw S.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")})})},clearKeystore:function(){return z(this,void 0,void 0,function(){return W(this,function(e){throw S.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")})})},signJwt:function(){return z(this,void 0,void 0,function(){return W(this,function(e){throw S.createUnexpectedError("Crypto interface - signJwt() has not been implemented")})})},hashString:function(){return z(this,void 0,void 0,function(){return W(this,function(e){throw S.createUnexpectedError("Crypto interface - hashString() has not been implemented")})})}};function ar(n,e){if(y.isEmpty(n))throw f.createClientInfoEmptyError();try{var t=e.base64Decode(n);return JSON.parse(t)}catch(r){throw f.createClientInfoDecodingError(r.message)}}function Gt(n){if(y.isEmpty(n))throw f.createClientInfoDecodingError("Home account ID was empty.");var e=n.split(Ue.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?v.EMPTY_STRING:e[1]}}var ot=(()=>{return(n=ot||(ot={}))[n.Default=0]="Default",n[n.Adfs=1]="Adfs",n[n.Dsts=2]="Dsts",ot;var n})(),Ge=function(){function n(){}return n.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(Ue.CACHE_KEY_SEPARATOR).toLowerCase()},n.prototype.generateAccountKey=function(){return n.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},n.prototype.generateType=function(){switch(this.authorityType){case Qe.ADFS_ACCOUNT_TYPE:return Ve.ADFS;case Qe.MSAV1_ACCOUNT_TYPE:return Ve.MSA;case Qe.MSSTS_ACCOUNT_TYPE:return Ve.MSSTS;case Qe.GENERIC_ACCOUNT_TYPE:return Ve.GENERIC;default:throw f.createUnexpectedAccountTypeError()}},n.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},n.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||v.EMPTY_STRING,e.tenantId||v.EMPTY_STRING].join(Ue.CACHE_KEY_SEPARATOR).toLowerCase()},n.createAccount=function(e,t,r,o,i,s,c,u){var d,g,C,_,N,F,q=new n;q.authorityType=Qe.MSSTS_ACCOUNT_TYPE,q.clientInfo=e,q.homeAccountId=t,q.nativeAccountId=u;var de=c||o&&o.getPreferredCache();if(!de)throw f.createInvalidCacheEnvironmentError();if(q.environment=de,q.realm=(null===(d=r?.claims)||void 0===d?void 0:d.tid)||v.EMPTY_STRING,r){q.idTokenClaims=r.claims,q.localAccountId=(null===(g=r?.claims)||void 0===g?void 0:g.oid)||(null===(C=r?.claims)||void 0===C?void 0:C.sub)||v.EMPTY_STRING;var te=null===(_=r?.claims)||void 0===_?void 0:_.preferred_username,we=null!==(N=r?.claims)&&void 0!==N&&N.emails?r.claims.emails[0]:null;q.username=te||we||v.EMPTY_STRING,q.name=null===(F=r?.claims)||void 0===F?void 0:F.name}return q.cloudGraphHostName=i,q.msGraphHost=s,q},n.createGenericAccount=function(e,t,r,o,i,s){var c,u,d,g,C=new n;C.authorityType=r&&r.authorityType===ot.Adfs?Qe.ADFS_ACCOUNT_TYPE:Qe.GENERIC_ACCOUNT_TYPE,C.homeAccountId=e,C.realm=v.EMPTY_STRING;var _=s||r&&r.getPreferredCache();if(!_)throw f.createInvalidCacheEnvironmentError();return t&&(C.localAccountId=(null===(c=t?.claims)||void 0===c?void 0:c.oid)||(null===(u=t?.claims)||void 0===u?void 0:u.sub)||v.EMPTY_STRING,C.username=(null===(d=t?.claims)||void 0===d?void 0:d.upn)||v.EMPTY_STRING,C.name=(null===(g=t?.claims)||void 0===g?void 0:g.name)||v.EMPTY_STRING,C.idTokenClaims=t?.claims),C.environment=_,C.cloudGraphHostName=o,C.msGraphHost=i,C},n.generateHomeAccountId=function(e,t,r,o,i){var s,c=null!==(s=i?.claims)&&void 0!==s&&s.sub?i.claims.sub:v.EMPTY_STRING;if(t===ot.Adfs||t===ot.Dsts)return c;if(e)try{var u=ar(e,o);if(!y.isEmpty(u.uid)&&!y.isEmpty(u.utid))return""+u.uid+Ue.CLIENT_INFO_SEPARATOR+u.utid}catch{}return r.verbose("No client info in response"),c},n.isAccountEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")},n.accountInfoIsEqual=function(e,t,r){if(!e||!t)return!1;var o=!0;if(r){var i=e.idTokenClaims||{},s=t.idTokenClaims||{};o=i.iat===s.iat&&i.nonce===s.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&o},n}(),Jt=function(){function n(){}return n.prototype.generateAccountId=function(){return n.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},n.prototype.generateCredentialId=function(){return n.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},n.prototype.generateTarget=function(){return n.generateTargetForCacheKey(this.target)},n.prototype.generateCredentialKey=function(){return n.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},n.prototype.generateType=function(){switch(this.credentialType){case oe.ID_TOKEN:return Ve.ID_TOKEN;case oe.ACCESS_TOKEN:case oe.ACCESS_TOKEN_WITH_AUTH_SCHEME:return Ve.ACCESS_TOKEN;case oe.REFRESH_TOKEN:return Ve.REFRESH_TOKEN;default:throw f.createUnexpectedCredentialTypeError()}},n.getCredentialType=function(e){return-1!==e.indexOf(oe.ACCESS_TOKEN.toLowerCase())?-1!==e.indexOf(oe.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())?oe.ACCESS_TOKEN_WITH_AUTH_SCHEME:oe.ACCESS_TOKEN:-1!==e.indexOf(oe.ID_TOKEN.toLowerCase())?oe.ID_TOKEN:-1!==e.indexOf(oe.REFRESH_TOKEN.toLowerCase())?oe.REFRESH_TOKEN:v.NOT_DEFINED},n.generateCredentialCacheKey=function(e,t,r,o,i,s,c,u,d){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,o,i,c),this.generateTargetForCacheKey(s),this.generateClaimsHashForCacheKey(d),this.generateSchemeForCacheKey(u)].join(Ue.CACHE_KEY_SEPARATOR).toLowerCase()},n.generateAccountIdForCacheKey=function(e,t){return[e,t].join(Ue.CACHE_KEY_SEPARATOR).toLowerCase()},n.generateCredentialIdForCacheKey=function(e,t,r,o){return[e,e===oe.REFRESH_TOKEN&&o||t,r||v.EMPTY_STRING].join(Ue.CACHE_KEY_SEPARATOR).toLowerCase()},n.generateTargetForCacheKey=function(e){return(e||v.EMPTY_STRING).toLowerCase()},n.generateClaimsHashForCacheKey=function(e){return(e||v.EMPTY_STRING).toLowerCase()},n.generateSchemeForCacheKey=function(e){return e&&e.toLowerCase()!==ge.BEARER.toLowerCase()?e.toLowerCase():v.EMPTY_STRING},n}(),ie_redirectUriNotSet_code="redirect_uri_empty",ie_redirectUriNotSet_desc="A redirect URI is required for all calls, and none has been set.",ie_postLogoutUriNotSet_code="post_logout_uri_empty",ie_postLogoutUriNotSet_desc="A post logout redirect has not been set.",ie_claimsRequestParsingError_code="claims_request_parsing_error",ie_claimsRequestParsingError_desc="Could not parse the given claims request object.",ie_authorityUriInsecure_code="authority_uri_insecure",ie_authorityUriInsecure_desc="Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",ie_urlParseError_code="url_parse_error",ie_urlParseError_desc="URL could not be parsed into appropriate segments.",ie_urlEmptyError_code="empty_url_error",ie_urlEmptyError_desc="URL was empty or null.",ie_emptyScopesError_code="empty_input_scopes_error",ie_emptyScopesError_desc="Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",ie_clientIdSingleScopeError_code="clientid_input_scopes_error",ie_clientIdSingleScopeError_desc="Client ID can only be provided as a single scope.",ie_invalidPrompt_code="invalid_prompt_value",ie_invalidPrompt_desc="Supported prompt values are 'login', 'select_account', 'consent', 'create', 'none' and 'no_session'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",ie_invalidClaimsRequest_code="invalid_claims",ie_invalidClaimsRequest_desc="Given claims parameter must be a stringified JSON object.",ie_tokenRequestEmptyError_code="token_request_empty",ie_tokenRequestEmptyError_desc="Token request was empty and not found in cache.",ie_logoutRequestEmptyError_code="logout_request_empty",ie_logoutRequestEmptyError_desc="The logout request was null or undefined.",ie_invalidCodeChallengeMethod_code="invalid_code_challenge_method",ie_invalidCodeChallengeMethod_desc='code_challenge_method passed is invalid. Valid values are "plain" and "S256".',ie_invalidCodeChallengeParams_code="pkce_params_missing",ie_invalidCodeChallengeParams_desc="Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",ie_invalidCloudDiscoveryMetadata_code="invalid_cloud_discovery_metadata",ie_invalidCloudDiscoveryMetadata_desc="Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",ie_invalidAuthorityMetadata_code="invalid_authority_metadata",ie_invalidAuthorityMetadata_desc="Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",ie_untrustedAuthority_code="untrusted_authority",ie_untrustedAuthority_desc="The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",ie_invalidAzureCloudInstance_code="invalid_azure_cloud_instance",ie_invalidAzureCloudInstance_desc="Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values",ie_missingSshJwk_code="missing_ssh_jwk",ie_missingSshJwk_desc="Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",ie_missingSshKid_code="missing_ssh_kid",ie_missingSshKid_desc="Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",ie_missingNonceAuthenticationHeader_code="missing_nonce_authentication_header",ie_missingNonceAuthenticationHeader_desc="Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",ie_invalidAuthenticationHeader_code="invalid_authentication_header",ie_invalidAuthenticationHeader_desc="Invalid authentication header provided",Ie=function(n){function e(t,r){var o=n.call(this,t,r)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,e.prototype),o}return se(e,n),e.createRedirectUriEmptyError=function(){return new e(ie_redirectUriNotSet_code,ie_redirectUriNotSet_desc)},e.createPostLogoutRedirectUriEmptyError=function(){return new e(ie_postLogoutUriNotSet_code,ie_postLogoutUriNotSet_desc)},e.createClaimsRequestParsingError=function(t){return new e(ie_claimsRequestParsingError_code,ie_claimsRequestParsingError_desc+" Given value: "+t)},e.createInsecureAuthorityUriError=function(t){return new e(ie_authorityUriInsecure_code,ie_authorityUriInsecure_desc+" Given URI: "+t)},e.createUrlParseError=function(t){return new e(ie_urlParseError_code,ie_urlParseError_desc+" Given Error: "+t)},e.createUrlEmptyError=function(){return new e(ie_urlEmptyError_code,ie_urlEmptyError_desc)},e.createEmptyScopesArrayError=function(){return new e(ie_emptyScopesError_code,""+ie_emptyScopesError_desc)},e.createClientIdSingleScopeError=function(t){return new e(ie_clientIdSingleScopeError_code,ie_clientIdSingleScopeError_desc+" Given Scopes: "+t)},e.createInvalidPromptError=function(t){return new e(ie_invalidPrompt_code,ie_invalidPrompt_desc+" Given value: "+t)},e.createInvalidClaimsRequestError=function(){return new e(ie_invalidClaimsRequest_code,ie_invalidClaimsRequest_desc)},e.createEmptyLogoutRequestError=function(){return new e(ie_logoutRequestEmptyError_code,ie_logoutRequestEmptyError_desc)},e.createEmptyTokenRequestError=function(){return new e(ie_tokenRequestEmptyError_code,ie_tokenRequestEmptyError_desc)},e.createInvalidCodeChallengeMethodError=function(){return new e(ie_invalidCodeChallengeMethod_code,ie_invalidCodeChallengeMethod_desc)},e.createInvalidCodeChallengeParamsError=function(){return new e(ie_invalidCodeChallengeParams_code,ie_invalidCodeChallengeParams_desc)},e.createInvalidCloudDiscoveryMetadataError=function(){return new e(ie_invalidCloudDiscoveryMetadata_code,ie_invalidCloudDiscoveryMetadata_desc)},e.createInvalidAuthorityMetadataError=function(){return new e(ie_invalidAuthorityMetadata_code,ie_invalidAuthorityMetadata_desc)},e.createUntrustedAuthorityError=function(){return new e(ie_untrustedAuthority_code,ie_untrustedAuthority_desc)},e.createInvalidAzureCloudInstanceError=function(){return new e(ie_invalidAzureCloudInstance_code,ie_invalidAzureCloudInstance_desc)},e.createMissingSshJwkError=function(){return new e(ie_missingSshJwk_code,ie_missingSshJwk_desc)},e.createMissingSshKidError=function(){return new e(ie_missingSshKid_code,ie_missingSshKid_desc)},e.createMissingNonceAuthenticationHeadersError=function(){return new e(ie_missingNonceAuthenticationHeader_code,ie_missingNonceAuthenticationHeader_desc)},e.createInvalidAuthenticationHeaderError=function(t,r){return new e(ie_invalidAuthenticationHeader_code,ie_invalidAuthenticationHeader_desc+". Invalid header: "+t+". Details: "+r)},e}(f),Ye=function(){function n(e){var t=this,r=e?y.trimArrayEntries(Ce(e)):[],o=r?y.removeEmptyStringsFromArray(r):[];this.validateInputScopes(o),this.scopes=new Set,o.forEach(function(i){return t.scopes.add(i)})}return n.fromString=function(e){return new n((e||v.EMPTY_STRING).split(" "))},n.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw Ie.createEmptyScopesArrayError()},n.prototype.containsScope=function(e){var r=new n(this.printScopesLowerCase().split(" "));return!y.isEmpty(e)&&r.scopes.has(e.toLowerCase())},n.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every(function(r){return t.containsScope(r)})},n.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return b.forEach(function(r){e.containsScope(r)&&(t+=1)}),this.scopes.size===t},n.prototype.appendScope=function(e){y.isEmpty(e)||this.scopes.add(e.trim())},n.prototype.appendScopes=function(e){var t=this;try{e.forEach(function(r){return t.appendScope(r)})}catch(r){throw f.createAppendScopeSetError(r)}},n.prototype.removeScope=function(e){if(y.isEmpty(e))throw f.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},n.prototype.removeOIDCScopes=function(){var e=this;b.forEach(function(t){e.scopes.delete(t)})},n.prototype.unionScopeSets=function(e){if(!e)throw f.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach(function(r){return t.add(r.toLowerCase())}),this.scopes.forEach(function(r){return t.add(r.toLowerCase())}),t},n.prototype.intersectingScopeSets=function(e){if(!e)throw f.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),r=e.getScopeCount(),o=this.getScopeCount();return t.size<o+r},n.prototype.getScopeCount=function(){return this.scopes.size},n.prototype.asArray=function(){var e=[];return this.scopes.forEach(function(t){return e.push(t)}),e},n.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):v.EMPTY_STRING},n.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},n}(),Et=function(){function n(e,t){if(y.isEmpty(e))throw f.createTokenNullOrEmptyError(e);this.rawToken=e,this.claims=n.extractTokenClaims(e,t)}return n.extractTokenClaims=function(e,t){var r=y.decodeAuthToken(e);try{var i=t.base64Decode(r.JWSPayload);return JSON.parse(i)}catch(s){throw f.createTokenParsingError(s)}},n.checkMaxAge=function(e,t){if(0===t||Date.now()-3e5>e+t)throw f.createMaxAgeTranspiredError()},n}(),ft=function(){function n(e,t){this.clientId=e,this.cryptoImpl=t}return n.prototype.getAllAccounts=function(){var e=this,t=this.getAccountsFilteredBy(),r=Object.keys(t).map(function(s){return t[s]});return r.length<1?[]:r.map(function(s){var u=n.toObject(new Ge,s).getAccountInfo(),d=e.readIdTokenFromCache(e.clientId,u);return d&&!u.idTokenClaims&&(u.idToken=d.secret,u.idTokenClaims=new Et(d.secret,e.cryptoImpl).claims),u})},n.prototype.saveCacheRecord=function(e){return z(this,void 0,void 0,function(){return W(this,function(t){switch(t.label){case 0:if(!e)throw f.createNullOrUndefinedCacheRecord();return e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken?[4,this.saveAccessToken(e.accessToken)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata),[2]}})})},n.prototype.saveAccessToken=function(e){return z(this,void 0,void 0,function(){var t,r,o,i,s=this;return W(this,function(c){switch(c.label){case 0:return t=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash}),r=Ye.fromString(e.target),(o=Object.keys(t.accessTokens).map(function(u){return t.accessTokens[u]}))?(i=[],o.forEach(function(u){Ye.fromString(u.target).intersectingScopeSets(r)&&i.push(s.removeCredential(u))}),[4,Promise.all(i)]):[3,2];case 1:c.sent(),c.label=2;case 2:return this.setAccessTokenCredential(e),[2]}})})},n.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:v.EMPTY_STRING,e?e.environment:v.EMPTY_STRING,e?e.realm:v.EMPTY_STRING,e?e.nativeAccountId:v.EMPTY_STRING)},n.prototype.getAccountsFilteredByInternal=function(e,t,r,o){var i=this,s=this.getKeys(),c={};return s.forEach(function(u){var d=i.getAccount(u);!d||e&&!i.matchHomeAccountId(d,e)||t&&!i.matchEnvironment(d,t)||r&&!i.matchRealm(d,r)||o&&!i.matchNativeAccountId(d,o)||(c[u]=d)}),c},n.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.familyId,e.realm,e.target,e.userAssertionHash,e.tokenType,e.keyId,e.requestedClaimsHash)},n.prototype.getCredentialsFilteredByInternal=function(e,t,r,o,i,s,c,u,d,g,C){var _=this,N=this.getKeys(),F={idTokens:{},accessTokens:{},refreshTokens:{}};return N.forEach(function(q){var de=Jt.getCredentialType(q);if(de!==v.NOT_DEFINED){var te=_.getSpecificCredential(q,de);if(te&&(!u||_.matchUserAssertionHash(te,u))&&("string"!=typeof e||_.matchHomeAccountId(te,e))&&(!t||_.matchEnvironment(te,t))&&(!s||_.matchRealm(te,s))&&(!r||_.matchCredentialType(te,r))&&(!o||_.matchClientId(te,o))&&(!i||_.matchFamilyId(te,i))&&(!c||_.matchTarget(te,c))&&(!C&&!te.requestedClaimsHash||te.requestedClaimsHash===C)&&(r!==oe.ACCESS_TOKEN_WITH_AUTH_SCHEME||!(d&&!_.matchTokenType(te,d)||d===ge.SSH&&g&&!_.matchKeyId(te,g)))){var we=_.updateCredentialCacheKey(q,te);switch(de){case oe.ID_TOKEN:F.idTokens[we]=te;break;case oe.ACCESS_TOKEN:case oe.ACCESS_TOKEN_WITH_AUTH_SCHEME:F.accessTokens[we]=te;break;case oe.REFRESH_TOKEN:F.refreshTokens[we]=te}}}}),F},n.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},n.prototype.getAppMetadataFilteredByInternal=function(e,t){var r=this,o=this.getKeys(),i={};return o.forEach(function(s){if(r.isAppMetadata(s)){var c=r.getAppMetadata(s);!c||e&&!r.matchEnvironment(c,e)||t&&!r.matchClientId(c,t)||(i[s]=c)}}),i},n.prototype.getAuthorityMetadataByAlias=function(e){var t=this,r=this.getAuthorityMetadataKeys(),o=null;return r.forEach(function(i){if(t.isAuthorityMetadata(i)&&-1!==i.indexOf(t.clientId)){var s=t.getAuthorityMetadata(i);!s||-1!==s.aliases.indexOf(e)&&(o=s)}}),o},n.prototype.removeAllAccounts=function(){return z(this,void 0,void 0,function(){var e,t,r=this;return W(this,function(o){switch(o.label){case 0:return e=this.getKeys(),t=[],e.forEach(function(i){!r.getAccount(i)||t.push(r.removeAccount(i))}),[4,Promise.all(t)];case 1:return o.sent(),[2,!0]}})})},n.prototype.removeAccount=function(e){return z(this,void 0,void 0,function(){var t;return W(this,function(r){switch(r.label){case 0:if(!(t=this.getAccount(e)))throw f.createNoAccountFoundError();return[4,this.removeAccountContext(t)];case 1:return[2,r.sent()&&this.removeItem(e,et.ACCOUNT)]}})})},n.prototype.removeAccountContext=function(e){return z(this,void 0,void 0,function(){var t,r,o,i=this;return W(this,function(s){switch(s.label){case 0:return t=this.getKeys(),r=e.generateAccountId(),o=[],t.forEach(function(c){var u=Jt.getCredentialType(c);if(u!==v.NOT_DEFINED){var d=i.getSpecificCredential(c,u);d&&r===d.generateAccountId()&&o.push(i.removeCredential(d))}}),[4,Promise.all(o)];case 1:return s.sent(),[2,!0]}})})},n.prototype.removeCredential=function(e){return z(this,void 0,void 0,function(){var t,o;return W(this,function(i){switch(i.label){case 0:if(t=e.generateCredentialKey(),e.credentialType.toLowerCase()!==oe.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(e.tokenType!==ge.POP)return[3,4];if(!(o=e.keyId))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(o)];case 2:return i.sent(),[3,4];case 3:throw i.sent(),f.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(t,et.CREDENTIAL)]}})})},n.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach(function(r){e.isAppMetadata(r)&&e.removeItem(r,et.APP_METADATA)}),!0},n.prototype.readCacheRecord=function(e,t,r,o){var i=this.readAccountFromCache(e),s=this.readIdTokenFromCache(t,e),c=this.readAccessTokenFromCache(t,e,r),u=this.readRefreshTokenFromCache(t,e,!1),d=this.readAppMetadataFromCache(o,t);return i&&s&&(i.idTokenClaims=new Et(s.secret,this.cryptoImpl).claims),{account:i,idToken:s,accessToken:c,refreshToken:u,appMetadata:d}},n.prototype.readAccountFromCache=function(e){var t=Ge.generateAccountCacheKey(e);return this.getAccount(t)},n.prototype.readAccountFromCacheWithNativeAccountId=function(e){var r=this.getAccountsFilteredBy({nativeAccountId:e}),o=Object.keys(r).map(function(i){return r[i]});if(o.length<1)return null;if(o.length>1)throw f.createMultipleMatchingAccountsInCacheError();return r[0]},n.prototype.readIdTokenFromCache=function(e,t){var o=this.getCredentialsFilteredBy({homeAccountId:t.homeAccountId,environment:t.environment,credentialType:oe.ID_TOKEN,clientId:e,realm:t.tenantId}),i=Object.keys(o.idTokens).map(function(c){return o.idTokens[c]}),s=i.length;if(s<1)return null;if(s>1)throw f.createMultipleMatchingTokensInCacheError();return i[0]},n.prototype.readAccessTokenFromCache=function(e,t,r){var o=new Ye(r.scopes||[]),i=r.authenticationScheme||ge.BEARER,s=i&&i.toLowerCase()!==ge.BEARER.toLowerCase()?oe.ACCESS_TOKEN_WITH_AUTH_SCHEME:oe.ACCESS_TOKEN,c={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:s,clientId:e,realm:t.tenantId,target:o.printScopesLowerCase(),tokenType:i,keyId:r.sshKid,requestedClaimsHash:r.requestedClaimsHash},u=this.getCredentialsFilteredBy(c),d=Object.keys(u.accessTokens).map(function(C){return u.accessTokens[C]}),g=d.length;if(g<1)return null;if(g>1)throw f.createMultipleMatchingTokensInCacheError();return d[0]},n.prototype.readRefreshTokenFromCache=function(e,t,r){var s=this.getCredentialsFilteredBy({homeAccountId:t.homeAccountId,environment:t.environment,credentialType:oe.REFRESH_TOKEN,clientId:e,familyId:r?"1":void 0}),c=Object.keys(s.refreshTokens).map(function(d){return s.refreshTokens[d]});return c.length<1?null:c[0]},n.prototype.readAppMetadataFromCache=function(e,t){var o=this.getAppMetadataFilteredBy({environment:e,clientId:t}),i=Object.keys(o).map(function(c){return o[c]}),s=i.length;if(s<1)return null;if(s>1)throw f.createMultipleMatchingAppMetadataInCacheError();return i[0]},n.prototype.isAppMetadataFOCI=function(e,t){var r=this.readAppMetadataFromCache(e,t);return!(!r||"1"!==r.familyId)},n.prototype.matchHomeAccountId=function(e,t){return"string"==typeof e.homeAccountId&&t===e.homeAccountId},n.prototype.matchUserAssertionHash=function(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)},n.prototype.matchEnvironment=function(e,t){var r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)},n.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},n.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},n.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},n.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},n.prototype.matchNativeAccountId=function(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)},n.prototype.matchTarget=function(e,t){if(e.credentialType!==oe.ACCESS_TOKEN&&e.credentialType!==oe.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;var o=Ye.fromString(e.target),i=Ye.fromString(t);return i.containsOnlyOIDCScopes()?i.removeScope(v.OFFLINE_ACCESS_SCOPE):i.removeOIDCScopes(),o.containsScopeSet(i)},n.prototype.matchTokenType=function(e,t){return!(!e.tokenType||e.tokenType!==t)},n.prototype.matchKeyId=function(e,t){return!(!e.keyId||e.keyId!==t)},n.prototype.isAppMetadata=function(e){return-1!==e.indexOf(Dt)},n.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf("authority-metadata")},n.prototype.generateAuthorityMetadataCacheKey=function(e){return"authority-metadata-"+this.clientId+"-"+e},n.prototype.getSpecificCredential=function(e,t){switch(t){case oe.ID_TOKEN:return this.getIdTokenCredential(e);case oe.ACCESS_TOKEN:case oe.ACCESS_TOKEN_WITH_AUTH_SCHEME:return this.getAccessTokenCredential(e);case oe.REFRESH_TOKEN:return this.getRefreshTokenCredential(e);default:return null}},n.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},n}(),Qr=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return se(e,n),e.prototype.setAccount=function(){throw S.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},e.prototype.getAccount=function(){throw S.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},e.prototype.setIdTokenCredential=function(){throw S.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},e.prototype.getIdTokenCredential=function(){throw S.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},e.prototype.setAccessTokenCredential=function(){throw S.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},e.prototype.getAccessTokenCredential=function(){throw S.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},e.prototype.setRefreshTokenCredential=function(){throw S.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},e.prototype.getRefreshTokenCredential=function(){throw S.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},e.prototype.setAppMetadata=function(){throw S.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},e.prototype.getAppMetadata=function(){throw S.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},e.prototype.setServerTelemetry=function(){throw S.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},e.prototype.getServerTelemetry=function(){throw S.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},e.prototype.setAuthorityMetadata=function(){throw S.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},e.prototype.getAuthorityMetadata=function(){throw S.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},e.prototype.getAuthorityMetadataKeys=function(){throw S.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},e.prototype.setThrottlingCache=function(){throw S.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},e.prototype.getThrottlingCache=function(){throw S.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},e.prototype.removeItem=function(){throw S.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},e.prototype.containsKey=function(){throw S.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},e.prototype.getKeys=function(){throw S.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},e.prototype.clear=function(){return z(this,void 0,void 0,function(){return W(this,function(r){throw S.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")})})},e.prototype.updateCredentialCacheKey=function(){throw S.createUnexpectedError("Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.")},e}(ft),Xt=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return se(e,n),e.createIdTokenEntity=function(t,r,o,i,s){var c=new e;return c.credentialType=oe.ID_TOKEN,c.homeAccountId=t,c.environment=r,c.clientId=i,c.secret=o,c.realm=s,c},e.isIdTokenEntity=function(t){return!!t&&t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===oe.ID_TOKEN},e}(Jt),lt=function(){function n(){}return n.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},n.isTokenExpired=function(e,t){var r=Number(e)||0;return n.nowSeconds()+t>r},n.wasClockTurnedBack=function(e){return Number(e)>n.nowSeconds()},n.delay=function(e,t){return new Promise(function(r){return setTimeout(function(){return r(t)},e)})},n}(),$t=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return se(e,n),e.createAccessTokenEntity=function(t,r,o,i,s,c,u,d,g,C,_,N,F,q,de){var te,we,ve=new e;ve.homeAccountId=t,ve.credentialType=oe.ACCESS_TOKEN,ve.secret=o;var it=lt.nowSeconds();if(ve.cachedAt=it.toString(),ve.expiresOn=u.toString(),ve.extendedExpiresOn=d.toString(),C&&(ve.refreshOn=C.toString()),ve.environment=r,ve.clientId=i,ve.realm=s,ve.target=c,ve.userAssertionHash=N,ve.tokenType=y.isEmpty(_)?ge.BEARER:_,q&&(ve.requestedClaims=q,ve.requestedClaimsHash=de),(null===(te=ve.tokenType)||void 0===te?void 0:te.toLowerCase())!==ge.BEARER.toLowerCase())switch(ve.credentialType=oe.ACCESS_TOKEN_WITH_AUTH_SCHEME,ve.tokenType){case ge.POP:var $e=Et.extractTokenClaims(o,g);if(null===(we=$e?.cnf)||void 0===we||!we.kid)throw f.createTokenClaimsRequiredError();ve.keyId=$e.cnf.kid;break;case ge.SSH:ve.keyId=F}return ve},e.isAccessTokenEntity=function(t){return!!t&&t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.hasOwnProperty("target")&&(t.credentialType===oe.ACCESS_TOKEN||t.credentialType===oe.ACCESS_TOKEN_WITH_AUTH_SCHEME)},e}(Jt),cr=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return se(e,n),e.createRefreshTokenEntity=function(t,r,o,i,s,c){var u=new e;return u.clientId=i,u.credentialType=oe.REFRESH_TOKEN,u.environment=r,u.homeAccountId=t,u.secret=o,u.userAssertionHash=c,s&&(u.familyId=s),u},e.isRefreshTokenEntity=function(t){return!!t&&t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===oe.REFRESH_TOKEN},e}(Jt),Cr=function(){function n(){}return n.prototype.generateAppMetadataKey=function(){return n.generateAppMetadataCacheKey(this.environment,this.clientId)},n.generateAppMetadataCacheKey=function(e,t){return[Dt,e,t].join(Ue.CACHE_KEY_SEPARATOR).toLowerCase()},n.createAppMetadataEntity=function(e,t,r){var o=new n;return o.clientId=e,o.environment=t,r&&(o.familyId=r),o},n.isAppMetadataEntity=function(e,t){return!!t&&0===e.indexOf(Dt)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment")},n}(),lr=function(){function n(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return n.isServerTelemetryEntity=function(e,t){var r=0===e.indexOf(ke.CACHE_KEY),o=!0;return t&&(o=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&o},n}(),_r=function(){function n(){this.expiresAt=lt.nowSeconds()+86400}return n.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},n.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t,this.jwks_uri=e.jwks_uri},n.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},n.prototype.resetExpiresAt=function(){this.expiresAt=lt.nowSeconds()+86400},n.prototype.isExpired=function(){return this.expiresAt<=lt.nowSeconds()},n.isAuthorityMetadataEntity=function(e,t){return!!t&&0===e.indexOf("authority-metadata")&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")},n}(),Pr=function(){function n(){}return n.isThrottlingEntity=function(e,t){var r=!1;e&&(r=0===e.indexOf("throttling"));var o=!0;return t&&(o=t.hasOwnProperty("throttleTime")),r&&o},n}(),It=function(){function n(){}return n.setRequestState=function(e,t,r){var o=n.generateLibraryState(e,r);return y.isEmpty(t)?o:""+o+v.RESOURCE_DELIM+t},n.generateLibraryState=function(e,t){if(!e)throw f.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid()};t&&(r.meta=t);var o=JSON.stringify(r);return e.base64Encode(o)},n.parseRequestState=function(e,t){if(!e)throw f.createNoCryptoObjectError("parseRequestState");if(y.isEmpty(t))throw f.createInvalidStateError(t,"Null, undefined or empty state");try{var r=t.split(v.RESOURCE_DELIM),o=r[0],i=r.length>1?r.slice(1).join(v.RESOURCE_DELIM):v.EMPTY_STRING,s=e.base64Decode(o),c=JSON.parse(s);return{userRequestState:y.isEmpty(i)?v.EMPTY_STRING:i,libraryState:c}}catch(u){throw f.createInvalidStateError(t,u)}},n}(),Xe=(()=>{return(n=Xe||(Xe={})).HOME_ACCOUNT_ID="home_account_id",n.UPN="UPN",Xe;var n})(),Mr=function(){function n(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return n.prototype.validateWindowStorage=function(e){if(e!==Me.LocalStorage&&e!==Me.SessionStorage)throw $.createStorageNotSupportedError(e);if(!window[e])throw $.createStorageNotSupportedError(e)},n.prototype.getItem=function(e){return this.windowStorage.getItem(e)},n.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},n.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},n.prototype.getKeys=function(){return Object.keys(this.windowStorage)},n.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},n}(),Ee=function(){function n(e){if(this._urlString=e,y.isEmpty(this._urlString))throw Ie.createUrlEmptyError();y.isEmpty(this.getHash())&&(this._urlString=n.canonicalizeUri(e))}return Object.defineProperty(n.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),n.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return y.endsWith(t,"?")?t=t.slice(0,-1):y.endsWith(t,"?/")&&(t=t.slice(0,-2)),y.endsWith(t,"/")||(t+="/"),t}return e},n.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(t){throw Ie.createUrlParseError(t)}if(!e.HostNameAndPort||!e.PathSegments)throw Ie.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Ie.createInsecureAuthorityUriError(this.urlString)},n.appendQueryString=function(e,t){return y.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},n.removeHashFromUrl=function(e){return n.canonicalizeUri(e.split("#")[0])},n.prototype.replaceTenantPath=function(e){var t=this.getUrlComponents(),r=t.PathSegments;return e&&0!==r.length&&(r[0]===ae.COMMON||r[0]===ae.ORGANIZATIONS)&&(r[0]=e),n.constructAuthorityUriFromObject(t)},n.prototype.getHash=function(){return n.parseHash(this.urlString)},n.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Ie.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},o=r.AbsolutePath.split("/");return o=o.filter(function(i){return i&&i.length>0}),r.PathSegments=o,!y.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r},n.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw Ie.createUrlParseError("Given url string: "+e);return r[2]},n.getAbsoluteUrl=function(e,t){if(e[0]===v.FORWARD_SLASH){var o=new n(t).getUrlComponents();return o.Protocol+"//"+o.HostNameAndPort+e}return e},n.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):v.EMPTY_STRING},n.parseQueryString=function(e){var t=e.indexOf("?"),r=e.indexOf("/?");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):v.EMPTY_STRING},n.constructAuthorityUriFromObject=function(e){return new n(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))},n.getDeserializedHash=function(e){if(y.isEmpty(e))return{};var t=n.parseHash(e),r=y.queryStringToObject(y.isEmpty(t)?e:t);if(!r)throw f.createHashNotDeserializedError(JSON.stringify(r));return r},n.getDeserializedQueryString=function(e){if(y.isEmpty(e))return{};var t=n.parseQueryString(e),r=y.queryStringToObject(y.isEmpty(t)?e:t);if(!r)throw f.createHashNotDeserializedError(JSON.stringify(r));return r},n.hashContainsKnownProperties=function(e){if(y.isEmpty(e)||e.indexOf("=")<0)return!1;var t=n.getDeserializedHash(e);return!!(t.code||t.error_description||t.error||t.state)},n}(),Ur=function(){function n(){}return n.extractBrowserRequestState=function(e,t){if(y.isEmpty(t))return null;try{return It.parseRequestState(e,t).libraryState.meta}catch(o){throw f.createInvalidStateError(t,o)}},n.parseServerResponseFromHash=function(e){if(!e)return{};var t=new Ee(e);return Ee.getDeserializedHash(t.getHash())},n}(),Sr=function(n){function e(t,r,o,i){var s=n.call(this,t,o)||this;return s.COOKIE_LIFE_MULTIPLIER=864e5,s.cacheConfig=r,s.logger=i,s.internalStorage=new Wt,s.browserStorage=s.setupBrowserStorage(s.cacheConfig.cacheLocation),s.temporaryCacheStorage=s.setupTemporaryCacheStorage(s.cacheConfig.cacheLocation),s.migrateCacheEntries(),s}return he(e,n),e.prototype.setupBrowserStorage=function(t){switch(t){case Me.LocalStorage:case Me.SessionStorage:try{return new Mr(t)}catch(r){this.logger.verbose(r);break}}return this.cacheConfig.cacheLocation=Me.MemoryStorage,new Wt},e.prototype.setupTemporaryCacheStorage=function(t){switch(t){case Me.LocalStorage:case Me.SessionStorage:try{return new Mr(Me.SessionStorage)}catch(r){return this.logger.verbose(r),this.internalStorage}default:return this.internalStorage}},e.prototype.migrateCacheEntries=function(){var t=this,o=v.CACHE_PREFIX+"."+G.CLIENT_INFO,i=v.CACHE_PREFIX+"."+G.ERROR,s=v.CACHE_PREFIX+"."+G.ERROR_DESC,C=[this.browserStorage.getItem(v.CACHE_PREFIX+"."+G.ID_TOKEN),this.browserStorage.getItem(o),this.browserStorage.getItem(i),this.browserStorage.getItem(s)];[G.ID_TOKEN,G.CLIENT_INFO,G.ERROR,G.ERROR_DESC].forEach(function(N,F){return t.migrateCacheEntry(N,C[F])})},e.prototype.migrateCacheEntry=function(t,r){r&&this.setTemporaryCache(t,r,!0)},e.prototype.validateAndParseJson=function(t){try{var r=JSON.parse(t);return r&&"object"==typeof r?r:null}catch{return null}},e.prototype.getItem=function(t){return this.browserStorage.getItem(t)},e.prototype.setItem=function(t,r){this.browserStorage.setItem(t,r)},e.prototype.getAccount=function(t){var r=this.getItem(t);if(!r)return null;var o=this.validateAndParseJson(r);return o&&Ge.isAccountEntity(o)?ft.toObject(new Ge,o):null},e.prototype.setAccount=function(t){this.logger.trace("BrowserCacheManager.setAccount called");var r=t.generateAccountKey();this.setItem(r,JSON.stringify(t))},e.prototype.getIdTokenCredential=function(t){var r=this.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null;var o=this.validateAndParseJson(r);return o&&Xt.isIdTokenEntity(o)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),ft.toObject(new Xt,o)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null)},e.prototype.setIdTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var r=t.generateCredentialKey();this.setItem(r,JSON.stringify(t))},e.prototype.getAccessTokenCredential=function(t){var r=this.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null;var o=this.validateAndParseJson(r);return o&&$t.isAccessTokenEntity(o)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),ft.toObject(new $t,o)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)},e.prototype.setAccessTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var r=t.generateCredentialKey();this.setItem(r,JSON.stringify(t))},e.prototype.getRefreshTokenCredential=function(t){var r=this.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null;var o=this.validateAndParseJson(r);return o&&cr.isRefreshTokenEntity(o)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),ft.toObject(new cr,o)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)},e.prototype.setRefreshTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var r=t.generateCredentialKey();this.setItem(r,JSON.stringify(t))},e.prototype.getAppMetadata=function(t){var r=this.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var o=this.validateAndParseJson(r);return o&&Cr.isAppMetadataEntity(t,o)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),ft.toObject(new Cr,o)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},e.prototype.setAppMetadata=function(t){this.logger.trace("BrowserCacheManager.setAppMetadata called");var r=t.generateAppMetadataKey();this.setItem(r,JSON.stringify(t))},e.prototype.getServerTelemetry=function(t){var r=this.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var o=this.validateAndParseJson(r);return o&&lr.isServerTelemetryEntity(t,o)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),ft.toObject(new lr,o)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},e.prototype.setServerTelemetry=function(t,r){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(t,JSON.stringify(r))},e.prototype.getAuthorityMetadata=function(t){var r=this.internalStorage.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var o=this.validateAndParseJson(r);return o&&_r.isAuthorityMetadataEntity(t,o)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),ft.toObject(new _r,o)):null},e.prototype.getAuthorityMetadataKeys=function(){var t=this;return this.internalStorage.getKeys().filter(function(o){return t.isAuthorityMetadata(o)})},e.prototype.setWrapperMetadata=function(t,r){this.internalStorage.setItem(Nt.WRAPPER_SKU,t),this.internalStorage.setItem(Nt.WRAPPER_VER,r)},e.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(Nt.WRAPPER_SKU)||v.EMPTY_STRING,this.internalStorage.getItem(Nt.WRAPPER_VER)||v.EMPTY_STRING]},e.prototype.setAuthorityMetadata=function(t,r){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(t,JSON.stringify(r))},e.prototype.getActiveAccount=function(){var t=this.generateCacheKey(G.ACTIVE_ACCOUNT_FILTERS),r=this.getItem(t);if(!r){this.logger.trace("No active account filters cache schema found, looking for legacy schema");var o=this.generateCacheKey(G.ACTIVE_ACCOUNT),i=this.getItem(o);if(!i)return this.logger.trace("No active account found"),null;var s=this.getAccountInfoByFilter({localAccountId:i})[0]||null;return s?(this.logger.trace("Legacy active account cache schema found"),this.logger.trace("Adding active account filters cache schema"),this.setActiveAccount(s),s):null}var c=this.validateAndParseJson(r);return c?(this.logger.trace("Active account filters schema found"),this.getAccountInfoByFilter({homeAccountId:c.homeAccountId,localAccountId:c.localAccountId})[0]||null):(this.logger.trace("No active account found"),null)},e.prototype.setActiveAccount=function(t){var r=this.generateCacheKey(G.ACTIVE_ACCOUNT_FILTERS),o=this.generateCacheKey(G.ACTIVE_ACCOUNT);t?(this.logger.verbose("setActiveAccount: Active account set"),this.browserStorage.setItem(r,JSON.stringify({homeAccountId:t.homeAccountId,localAccountId:t.localAccountId})),this.browserStorage.setItem(o,t.localAccountId)):(this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(r),this.browserStorage.removeItem(o))},e.prototype.getAccountInfoByFilter=function(t){return this.getAllAccounts().filter(function(o){return!(t.username&&t.username.toLowerCase()!==o.username.toLowerCase()||t.homeAccountId&&t.homeAccountId!==o.homeAccountId||t.localAccountId&&t.localAccountId!==o.localAccountId||t.tenantId&&t.tenantId!==o.tenantId||t.environment&&t.environment!==o.environment)})},e.prototype.getAccountInfoByHints=function(t,r){var o=this.getAllAccounts().filter(function(i){return r?r===(i.idTokenClaims&&i.idTokenClaims.sid):!!t&&t===i.username});if(1===o.length)return o[0];if(o.length>1)throw f.createMultipleMatchingAccountsInCacheError();return null},e.prototype.getThrottlingCache=function(t){var r=this.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var o=this.validateAndParseJson(r);return o&&Pr.isThrottlingEntity(t,o)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),ft.toObject(new Pr,o)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},e.prototype.setThrottlingCache=function(t,r){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(t,JSON.stringify(r))},e.prototype.getTemporaryCache=function(t,r){var o=r?this.generateCacheKey(t):t;if(this.cacheConfig.storeAuthStateInCookie){var i=this.getItemCookie(o);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),i}var s=this.temporaryCacheStorage.getItem(o);if(!s){if(this.cacheConfig.cacheLocation===Me.LocalStorage){var c=this.browserStorage.getItem(o);if(c)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),c}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),s},e.prototype.setTemporaryCache=function(t,r,o){var i=o?this.generateCacheKey(t):t;this.temporaryCacheStorage.setItem(i,r),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(i,r))},e.prototype.removeItem=function(t){return this.browserStorage.removeItem(t),this.temporaryCacheStorage.removeItem(t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(t)),!0},e.prototype.containsKey=function(t){return this.browserStorage.containsKey(t)||this.temporaryCacheStorage.containsKey(t)},e.prototype.getKeys=function(){return dt(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},e.prototype.clear=function(){return p(this,void 0,void 0,function(){var t=this;return O(this,function(r){switch(r.label){case 0:return[4,this.removeAllAccounts()];case 1:return r.sent(),this.removeAppMetadata(),this.getKeys().forEach(function(o){(t.browserStorage.containsKey(o)||t.temporaryCacheStorage.containsKey(o))&&(-1!==o.indexOf(v.CACHE_PREFIX)||-1!==o.indexOf(t.clientId))&&t.removeItem(o)}),this.internalStorage.clear(),[2]}})})},e.prototype.setItemCookie=function(t,r,o){var i=encodeURIComponent(t)+"="+encodeURIComponent(r)+";path=/;SameSite=Lax;";o&&(i+="expires="+this.getCookieExpirationTime(o)+";"),this.cacheConfig.secureCookies&&(i+="Secure;"),document.cookie=i},e.prototype.getItemCookie=function(t){for(var r=encodeURIComponent(t)+"=",o=document.cookie.split(";"),i=0;i<o.length;i++){for(var s=o[i];" "===s.charAt(0);)s=s.substring(1);if(0===s.indexOf(r))return decodeURIComponent(s.substring(r.length,s.length))}return v.EMPTY_STRING},e.prototype.clearMsalCookies=function(){var t=this,r=v.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach(function(i){for(;" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(r)){var s=i.split("=")[0];t.clearItemCookie(s)}})},e.prototype.clearItemCookie=function(t){this.setItemCookie(t,v.EMPTY_STRING,-1)},e.prototype.getCookieExpirationTime=function(t){var r=new Date;return new Date(r.getTime()+t*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},e.prototype.getCache=function(){return this.browserStorage},e.prototype.setCache=function(){},e.prototype.generateCacheKey=function(t){return this.validateAndParseJson(t)?JSON.stringify(t):y.startsWith(t,v.CACHE_PREFIX)||y.startsWith(t,G.ADAL_ID_TOKEN)?t:v.CACHE_PREFIX+"."+this.clientId+"."+t},e.prototype.generateAuthorityKey=function(t){var r=It.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(pe.AUTHORITY+"."+r)},e.prototype.generateNonceKey=function(t){var r=It.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(pe.NONCE_IDTOKEN+"."+r)},e.prototype.generateStateKey=function(t){var r=It.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(pe.REQUEST_STATE+"."+r)},e.prototype.getCachedAuthority=function(t){var r=this.generateStateKey(t),o=this.getTemporaryCache(r);if(!o)return null;var i=this.generateAuthorityKey(o);return this.getTemporaryCache(i)},e.prototype.updateCacheEntries=function(t,r,o,i,s){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var c=this.generateStateKey(t);this.setTemporaryCache(c,t,!1);var u=this.generateNonceKey(t);this.setTemporaryCache(u,r,!1);var d=this.generateAuthorityKey(t);if(this.setTemporaryCache(d,o,!1),s){var g={credential:s.homeAccountId,type:Xe.HOME_ACCOUNT_ID};this.setTemporaryCache(pe.CCS_CREDENTIAL,JSON.stringify(g),!0)}else y.isEmpty(i)||(g={credential:i,type:Xe.UPN},this.setTemporaryCache(pe.CCS_CREDENTIAL,JSON.stringify(g),!0))},e.prototype.resetRequestCache=function(t){var r=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),y.isEmpty(t)||this.getKeys().forEach(function(o){-1!==o.indexOf(t)&&r.removeItem(o)}),t&&(this.removeItem(this.generateStateKey(t)),this.removeItem(this.generateNonceKey(t)),this.removeItem(this.generateAuthorityKey(t))),this.removeItem(this.generateCacheKey(pe.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(pe.ORIGIN_URI)),this.removeItem(this.generateCacheKey(pe.URL_HASH)),this.removeItem(this.generateCacheKey(pe.CORRELATION_ID)),this.removeItem(this.generateCacheKey(pe.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(pe.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},e.prototype.cleanRequestByState=function(t){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),t){var r=this.generateStateKey(t),o=this.temporaryCacheStorage.getItem(r);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+o),this.resetRequestCache(o||v.EMPTY_STRING)}this.clearMsalCookies()},e.prototype.cleanRequestByInteractionType=function(t){var r=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach(function(o){if(-1!==o.indexOf(pe.REQUEST_STATE)){var i=r.temporaryCacheStorage.getItem(o);if(i){var s=Ur.extractBrowserRequestState(r.cryptoImpl,i);s&&s.interactionType===t&&(r.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+i),r.resetRequestCache(i))}}}),this.clearMsalCookies(),this.setInteractionInProgress(!1)},e.prototype.cacheCodeRequest=function(t,r){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var o=r.base64Encode(JSON.stringify(t));this.setTemporaryCache(pe.REQUEST_PARAMS,o,!0)},e.prototype.getCachedRequest=function(t,r){this.logger.trace("BrowserCacheManager.getCachedRequest called");var o=this.getTemporaryCache(pe.REQUEST_PARAMS,!0);if(!o)throw E.createNoTokenRequestCacheError();var i=this.validateAndParseJson(r.base64Decode(o));if(!i)throw E.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(pe.REQUEST_PARAMS)),y.isEmpty(i.authority)){var s=this.generateAuthorityKey(t),c=this.getTemporaryCache(s);if(!c)throw E.createNoCachedAuthorityError();i.authority=c}return i},e.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var t=this.getTemporaryCache(pe.NATIVE_REQUEST,!0);return t?this.validateAndParseJson(t)||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null):(this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null)},e.prototype.isInteractionInProgress=function(t){var r=this.getInteractionInProgress();return t?r===this.clientId:!!r},e.prototype.getInteractionInProgress=function(){return this.getTemporaryCache(v.CACHE_PREFIX+"."+pe.INTERACTION_STATUS_KEY,!1)},e.prototype.setInteractionInProgress=function(t){var r=v.CACHE_PREFIX+"."+pe.INTERACTION_STATUS_KEY;if(t){if(this.getInteractionInProgress())throw E.createInteractionInProgressError();this.setTemporaryCache(r,this.clientId,!1)}else!t&&this.getInteractionInProgress()===this.clientId&&this.removeItem(r)},e.prototype.getLegacyLoginHint=function(){var t=this.getTemporaryCache(G.ADAL_ID_TOKEN);t&&(this.browserStorage.removeItem(G.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var r=this.getTemporaryCache(G.ID_TOKEN,!0);r&&(this.removeItem(this.generateCacheKey(G.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var o=r||t;if(o){var i=new Et(o,this.cryptoImpl);if(i.claims&&i.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),i.claims.preferred_username;if(i.claims&&i.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),i.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},e.prototype.updateCredentialCacheKey=function(t,r){var o=r.generateCredentialKey();if(t!==o){var i=this.getItem(t);if(i)return this.removeItem(t),this.setItem(o,i),this.logger.verbose("Updated an outdated "+r.credentialType+" cache key"),o;this.logger.error("Attempted to update an outdated "+r.credentialType+" cache key but no item matching the outdated key was found in storage")}return t},e.prototype.getRedirectRequestContext=function(){return this.getTemporaryCache(pe.REDIRECT_CONTEXT,!0)},e.prototype.setRedirectRequestContext=function(t){this.setTemporaryCache(pe.REDIRECT_CONTEXT,t,!0)},e}(ft),Zt=(()=>{return(n=Zt||(Zt={})).AAD="AAD",n.OIDC="OIDC",Zt;var n})(),zt=(()=>{return(n=zt||(zt={}))[n.None=0]="None",n.AzurePublic="https://login.microsoftonline.com",n.AzurePpe="https://login.windows-ppe.net",n.AzureChina="https://login.chinacloudapi.cn",n.AzureGermany="https://login.microsoftonline.de",n.AzureUsGovernment="https://login.microsoftonline.us",zt;var n})(),Lr={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1,proxyUrl:v.EMPTY_STRING},Zr={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:De.Info,correlationId:v.EMPTY_STRING},en={sendGetRequestAsync:function(){return z(this,void 0,void 0,function(){return W(this,function(e){throw S.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")})})},sendPostRequestAsync:function(){return z(this,void 0,void 0,function(){return W(this,function(e){throw S.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")})})}},tn={sku:v.SKU,version:"9.0.1",cpu:v.EMPTY_STRING,os:v.EMPTY_STRING},rn={clientSecret:v.EMPTY_STRING,clientAssertion:void 0},nn={azureCloudInstance:zt.None,tenant:""+v.DEFAULT_COMMON_TENANT},on={application:{appName:"",appVersion:""}};function an(n){return j({clientCapabilities:[],azureCloudOptions:nn,skipAuthorityMetadataCache:!1},n)}var cn={sendGetRequestAsync:function(){return Promise.reject(S.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(S.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},ln=function(){function n(){}return n.prototype.sendGetRequestAsync=function(e,t){return p(this,void 0,void 0,function(){var r,o,i;return O(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,fetch(e,{method:nt.GET,headers:this.getFetchHeaders(t)})];case 1:return r=s.sent(),[3,3];case 2:throw o=s.sent(),window.navigator.onLine?E.createGetRequestFailedError(o,e):E.createNoNetworkConnectivityError();case 3:return s.trys.push([3,5,,6]),i={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 4:return[2,(i.body=s.sent(),i.status=r.status,i)];case 5:throw s.sent(),E.createFailedToParseNetworkResponseError(e);case 6:return[2]}})})},n.prototype.sendPostRequestAsync=function(e,t){return p(this,void 0,void 0,function(){var r,o,i,s;return O(this,function(c){switch(c.label){case 0:r=t&&t.body||v.EMPTY_STRING,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,fetch(e,{method:nt.POST,headers:this.getFetchHeaders(t),body:r})];case 2:return o=c.sent(),[3,4];case 3:throw i=c.sent(),window.navigator.onLine?E.createPostRequestFailedError(i,e):E.createNoNetworkConnectivityError();case 4:return c.trys.push([4,6,,7]),s={headers:this.getHeaderDict(o.headers)},[4,o.json()];case 5:return[2,(s.body=c.sent(),s.status=o.status,s)];case 6:throw c.sent(),E.createFailedToParseNetworkResponseError(e);case 7:return[2]}})})},n.prototype.getFetchHeaders=function(e){var t=new Headers;if(!e||!e.headers)return t;var r=e.headers;return Object.keys(r).forEach(function(o){t.append(o,r[o])}),t},n.prototype.getHeaderDict=function(e){var t={};return e.forEach(function(r,o){t[o]=r}),t},n}(),un=function(){function n(){}return n.prototype.sendGetRequestAsync=function(e,t){return p(this,void 0,void 0,function(){return O(this,function(r){return[2,this.sendRequestAsync(e,nt.GET,t)]})})},n.prototype.sendPostRequestAsync=function(e,t){return p(this,void 0,void 0,function(){return O(this,function(r){return[2,this.sendRequestAsync(e,nt.POST,t)]})})},n.prototype.sendRequestAsync=function(e,t,r){var o=this;return new Promise(function(i,s){var c=new XMLHttpRequest;if(c.open(t,e,!0),o.setXhrHeaders(c,r),c.onload=function(){(c.status<200||c.status>=300)&&s(t===nt.POST?E.createPostRequestFailedError("Failed with status "+c.status,e):E.createGetRequestFailedError("Failed with status "+c.status,e));try{var u=JSON.parse(c.responseText),d={headers:o.getHeaderDict(c),body:u,status:c.status};i(d)}catch{s(E.createFailedToParseNetworkResponseError(e))}},c.onerror=function(){window.navigator.onLine?s(t===nt.POST?E.createPostRequestFailedError("Failed with status "+c.status,e):E.createGetRequestFailedError("Failed with status "+c.status,e)):s(E.createNoNetworkConnectivityError())},t===nt.POST&&r&&r.body)c.send(r.body);else{if(t!==nt.GET)throw E.createHttpMethodNotImplementedError(t);c.send()}})},n.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var r=t.headers;Object.keys(r).forEach(function(o){e.setRequestHeader(o,r[o])})}},n.prototype.getHeaderDict=function(e){var r=e.getAllResponseHeaders().trim().split(/[\r\n]+/),o={};return r.forEach(function(i){var s=i.split(": "),c=s.shift(),u=s.join(": ");c&&u&&(o[c]=u)}),o},n}(),Ne=function(){function n(){}return n.clearHash=function(e){e.location.hash=v.EMPTY_STRING,"function"==typeof e.history.replaceState&&e.history.replaceState(null,v.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},n.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):v.EMPTY_STRING},n.isInIframe=function(){return window.parent!==window},n.isInPopup=function(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf("msal.")},n.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},n.getHomepage=function(){var t=new Ee(window.location.href).getUrlComponents();return t.Protocol+"//"+t.HostNameAndPort+"/"},n.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new ln:new un},n.blockReloadInHiddenIframes=function(){if(Ee.hashContainsKnownProperties(window.location.hash)&&n.isInIframe())throw E.createBlockReloadInHiddenIframeError()},n.blockRedirectInIframe=function(e,t){var r=n.isInIframe();if(e===V.Redirect&&r&&!t)throw E.createRedirectInIframeError(r)},n.blockAcquireTokenInPopups=function(){if(n.isInPopup())throw E.createBlockAcquireTokenInPopupsError()},n.blockNonBrowserEnvironment=function(e){if(!e)throw E.createNonBrowserEnvironmentError()},n.blockNativeBrokerCalledBeforeInitialized=function(e,t){if(e&&!t)throw E.createNativeBrokerCalledBeforeInitialize()},n.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),o=e.indexOf("Edge/");return t>0||r>0||o>0},n}(),dn=function(){function n(){}return n.prototype.navigateInternal=function(e,t){return n.defaultNavigateWindow(e,t)},n.prototype.navigateExternal=function(e,t){return n.defaultNavigateWindow(e,t)},n.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(function(r){setTimeout(function(){r(!0)},t.timeout)})},n}(),Ir="@azure/msal-browser",er="2.32.1",re=(()=>{return(n=re||(re={})).INITIALIZE_START="msal:initializeStart",n.INITIALIZE_END="msal:initializeEnd",n.ACCOUNT_ADDED="msal:accountAdded",n.ACCOUNT_REMOVED="msal:accountRemoved",n.LOGIN_START="msal:loginStart",n.LOGIN_SUCCESS="msal:loginSuccess",n.LOGIN_FAILURE="msal:loginFailure",n.ACQUIRE_TOKEN_START="msal:acquireTokenStart",n.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",n.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",n.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",n.SSO_SILENT_START="msal:ssoSilentStart",n.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",n.SSO_SILENT_FAILURE="msal:ssoSilentFailure",n.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",n.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",n.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",n.HANDLE_REDIRECT_START="msal:handleRedirectStart",n.HANDLE_REDIRECT_END="msal:handleRedirectEnd",n.POPUP_OPENED="msal:popupOpened",n.LOGOUT_START="msal:logoutStart",n.LOGOUT_SUCCESS="msal:logoutSuccess",n.LOGOUT_FAILURE="msal:logoutFailure",n.LOGOUT_END="msal:logoutEnd",re;var n})(),mn=function(){function n(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return n.prototype.addEventCallback=function(e){if(typeof window<"u"){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},n.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},n.prototype.enableAccountStorageEvents=function(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},n.prototype.disableAccountStorageEvents=function(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},n.prototype.emitEvent=function(e,t,r,o){var i=this;if(typeof window<"u"){var s={eventType:e,interactionType:t||null,payload:r||null,error:o||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach(function(c,u){i.logger.verbose("Emitting event to callback "+u+": "+e),c.apply(null,[s])})}},n.prototype.handleAccountCacheChange=function(e){try{var t=e.newValue||e.oldValue;if(!t)return;var r=JSON.parse(t);if("object"!=typeof r||!Ge.isAccountEntity(r))return;var i=ft.toObject(new Ge,r).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(re.ACCOUNT_ADDED,void 0,i)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(re.ACCOUNT_REMOVED,void 0,i))}catch{return}},n}(),ur=function(){function n(){}return n.generateThrottlingStorageKey=function(e){return"throttling."+JSON.stringify(e)},n.preProcess=function(e,t){var r,o=n.generateThrottlingStorageKey(t),i=e.getThrottlingCache(o);if(i){if(i.throttleTime<Date.now())return void e.removeItem(o,et.THROTTLING);throw new Q((null===(r=i.errorCodes)||void 0===r?void 0:r.join(" "))||v.EMPTY_STRING,i.errorMessage,i.subError)}},n.postProcess=function(e,t,r){if(n.checkResponseStatus(r)||n.checkResponseForRetryAfter(r)){var o={throttleTime:n.calculateThrottleTime(parseInt(r.headers[M.RETRY_AFTER])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(n.generateThrottlingStorageKey(t),o)}},n.checkResponseStatus=function(e){return 429===e.status||e.status>=500&&e.status<600},n.checkResponseForRetryAfter=function(e){return!!e.headers&&e.headers.hasOwnProperty(M.RETRY_AFTER)&&(e.status<200||e.status>=300)},n.calculateThrottleTime=function(e){var t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||60),r+3600))},n.removeThrottle=function(e,t,r,o){var s=this.generateThrottlingStorageKey({clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:o,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid});return e.removeItem(s,et.THROTTLING)},n}(),vn=function(){function n(e,t){this.networkClient=e,this.cacheManager=t}return n.prototype.sendPostRequest=function(e,t,r){return z(this,void 0,void 0,function(){var o,i;return W(this,function(s){switch(s.label){case 0:ur.preProcess(this.cacheManager,e),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,r)];case 2:return o=s.sent(),[3,4];case 3:throw(i=s.sent())instanceof S?i:f.createNetworkError(t,i);case 4:return ur.postProcess(this.cacheManager,e,o),[2,o]}})})},n}(),Ar=function(){function n(e,t){this.config=function sn(n){var e=n.authOptions,t=n.systemOptions,r=n.loggerOptions,o=n.storageInterface,i=n.networkInterface,s=n.cryptoInterface,c=n.clientCredentials,u=n.libraryInfo,d=n.telemetry,g=n.serverTelemetryManager,C=n.persistencePlugin,_=n.serializableCache,N=j(j({},Zr),r);return{authOptions:an(e),systemOptions:j(j({},Lr),t),loggerOptions:N,storageInterface:o||new Qr(e.clientId,sr),networkInterface:i||en,cryptoInterface:s||sr,clientCredentials:c||rn,libraryInfo:j(j({},tn),u),telemetry:j(j({},on),d),serverTelemetryManager:g||null,persistencePlugin:C||null,serializableCache:_||null}}(e),this.logger=new Nr(this.config.loggerOptions,"@azure/msal-common","9.0.1"),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new vn(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}return n.prototype.createTokenRequestHeaders=function(e){var t={};if(t[M.CONTENT_TYPE]=v.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Xe.HOME_ACCOUNT_ID:try{var r=Gt(e.credential);t[M.CCS_HEADER]="Oid:"+r.uid+"@"+r.utid}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case Xe.UPN:t[M.CCS_HEADER]="UPN: "+e.credential}return t},n.prototype.executePostToTokenEndpoint=function(e,t,r,o){return z(this,void 0,void 0,function(){var i;return W(this,function(s){switch(s.label){case 0:return[4,this.networkManager.sendPostRequest(o,e,{body:t,headers:r,proxyUrl:this.config.systemOptions.proxyUrl})];case 1:return i=s.sent(),this.config.serverTelemetryManager&&i.status<500&&429!==i.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,i]}})})},n.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw f.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},n}(),Ut=function(){function n(){}return n.validateRedirectUri=function(e){if(y.isEmpty(e))throw Ie.createRedirectUriEmptyError()},n.validatePrompt=function(e){var t=[];for(var r in be)t.push(be[r]);if(t.indexOf(e)<0)throw Ie.createInvalidPromptError(e)},n.validateClaims=function(e){try{JSON.parse(e)}catch{throw Ie.createInvalidClaimsRequestError()}},n.validateCodeChallengeParams=function(e,t){if(y.isEmpty(e)||y.isEmpty(t))throw Ie.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},n.validateCodeChallengeMethod=function(e){if([Ht.PLAIN,Ht.S256].indexOf(e)<0)throw Ie.createInvalidCodeChallengeMethodError()},n.sanitizeEQParams=function(e,t){return e?(t.forEach(function(r,o){e[o]&&delete e[o]}),e):{}},n}(),jt=function(){function n(){this.parameters=new Map}return n.prototype.addResponseTypeCode=function(){this.parameters.set(Z.RESPONSE_TYPE,encodeURIComponent(v.CODE_RESPONSE_TYPE))},n.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(Z.RESPONSE_TYPE,encodeURIComponent(v.TOKEN_RESPONSE_TYPE+" "+v.ID_TOKEN_RESPONSE_TYPE))},n.prototype.addResponseMode=function(e){this.parameters.set(Z.RESPONSE_MODE,encodeURIComponent(e||_t.QUERY))},n.prototype.addNativeBroker=function(){this.parameters.set(Z.NATIVE_BROKER,encodeURIComponent("1"))},n.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?Ce(e||[],fe):e||[],o=new Ye(r);this.parameters.set(Z.SCOPE,encodeURIComponent(o.printScopes()))},n.prototype.addClientId=function(e){this.parameters.set(Z.CLIENT_ID,encodeURIComponent(e))},n.prototype.addRedirectUri=function(e){Ut.validateRedirectUri(e),this.parameters.set(Z.REDIRECT_URI,encodeURIComponent(e))},n.prototype.addPostLogoutRedirectUri=function(e){Ut.validateRedirectUri(e),this.parameters.set(Z.POST_LOGOUT_URI,encodeURIComponent(e))},n.prototype.addIdTokenHint=function(e){this.parameters.set(Z.ID_TOKEN_HINT,encodeURIComponent(e))},n.prototype.addDomainHint=function(e){this.parameters.set(We.DOMAIN_HINT,encodeURIComponent(e))},n.prototype.addLoginHint=function(e){this.parameters.set(We.LOGIN_HINT,encodeURIComponent(e))},n.prototype.addCcsUpn=function(e){this.parameters.set(M.CCS_HEADER,encodeURIComponent("UPN:"+e))},n.prototype.addCcsOid=function(e){this.parameters.set(M.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},n.prototype.addSid=function(e){this.parameters.set(We.SID,encodeURIComponent(e))},n.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);Ut.validateClaims(r),this.parameters.set(Z.CLAIMS,encodeURIComponent(r))},n.prototype.addCorrelationId=function(e){this.parameters.set(Z.CLIENT_REQUEST_ID,encodeURIComponent(e))},n.prototype.addLibraryInfo=function(e){this.parameters.set(Z.X_CLIENT_SKU,e.sku),this.parameters.set(Z.X_CLIENT_VER,e.version),e.os&&this.parameters.set(Z.X_CLIENT_OS,e.os),e.cpu&&this.parameters.set(Z.X_CLIENT_CPU,e.cpu)},n.prototype.addApplicationTelemetry=function(e){e?.appName&&this.parameters.set(Z.X_APP_NAME,e.appName),e?.appVersion&&this.parameters.set(Z.X_APP_VER,e.appVersion)},n.prototype.addPrompt=function(e){Ut.validatePrompt(e),this.parameters.set(""+Z.PROMPT,encodeURIComponent(e))},n.prototype.addState=function(e){y.isEmpty(e)||this.parameters.set(Z.STATE,encodeURIComponent(e))},n.prototype.addNonce=function(e){this.parameters.set(Z.NONCE,encodeURIComponent(e))},n.prototype.addCodeChallengeParams=function(e,t){if(Ut.validateCodeChallengeParams(e,t),!e||!t)throw Ie.createInvalidCodeChallengeParamsError();this.parameters.set(Z.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(Z.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},n.prototype.addAuthorizationCode=function(e){this.parameters.set(Z.CODE,encodeURIComponent(e))},n.prototype.addDeviceCode=function(e){this.parameters.set(Z.DEVICE_CODE,encodeURIComponent(e))},n.prototype.addRefreshToken=function(e){this.parameters.set(Z.REFRESH_TOKEN,encodeURIComponent(e))},n.prototype.addCodeVerifier=function(e){this.parameters.set(Z.CODE_VERIFIER,encodeURIComponent(e))},n.prototype.addClientSecret=function(e){this.parameters.set(Z.CLIENT_SECRET,encodeURIComponent(e))},n.prototype.addClientAssertion=function(e){y.isEmpty(e)||this.parameters.set(Z.CLIENT_ASSERTION,encodeURIComponent(e))},n.prototype.addClientAssertionType=function(e){y.isEmpty(e)||this.parameters.set(Z.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},n.prototype.addOboAssertion=function(e){this.parameters.set(Z.OBO_ASSERTION,encodeURIComponent(e))},n.prototype.addRequestTokenUse=function(e){this.parameters.set(Z.REQUESTED_TOKEN_USE,encodeURIComponent(e))},n.prototype.addGrantType=function(e){this.parameters.set(Z.GRANT_TYPE,encodeURIComponent(e))},n.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},n.prototype.addExtraQueryParameters=function(e){var t=this;Ut.sanitizeEQParams(e,this.parameters),Object.keys(e).forEach(function(r){t.parameters.set(r,e[r])})},n.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch{throw Ie.createInvalidClaimsRequestError()}else r={};return t&&t.length>0&&(r.hasOwnProperty(Ze.ACCESS_TOKEN)||(r[Ze.ACCESS_TOKEN]={}),r[Ze.ACCESS_TOKEN][Ze.XMS_CC]={values:t}),JSON.stringify(r)},n.prototype.addUsername=function(e){this.parameters.set(Oe.username,encodeURIComponent(e))},n.prototype.addPassword=function(e){this.parameters.set(Oe.password,encodeURIComponent(e))},n.prototype.addPopToken=function(e){y.isEmpty(e)||(this.parameters.set(Z.TOKEN_TYPE,ge.POP),this.parameters.set(Z.REQ_CNF,encodeURIComponent(e)))},n.prototype.addSshJwk=function(e){y.isEmpty(e)||(this.parameters.set(Z.TOKEN_TYPE,ge.SSH),this.parameters.set(Z.REQ_CNF,encodeURIComponent(e)))},n.prototype.addServerTelemetry=function(e){this.parameters.set(Z.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(Z.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},n.prototype.addThrottling=function(){this.parameters.set(Z.X_MS_LIB_CAPABILITY,"retry-after, h429")},n.prototype.addLogoutHint=function(e){this.parameters.set(Z.LOGOUT_HINT,encodeURIComponent(e))},n.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach(function(t,r){e.push(r+"="+t)}),e.join("&")},n}(),dr=function n(e,t,r,o,i){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=o||null,this.appMetadata=i||null},hr=(()=>{return(n=hr||(hr={})).SW="sw",n.UHW="uhw",hr;var n})(),qt=function(){function n(e){this.cryptoUtils=e}return n.prototype.generateCnf=function(e){return z(this,void 0,void 0,function(){var t,r,o;return W(this,function(i){switch(i.label){case 0:return[4,this.generateKid(e)];case 1:return t=i.sent(),r=this.cryptoUtils.base64Encode(JSON.stringify(t)),o={kid:t.kid,reqCnfString:r},[4,this.cryptoUtils.hashString(r)];case 2:return[2,(o.reqCnfHash=i.sent(),o)]}})})},n.prototype.generateKid=function(e){return z(this,void 0,void 0,function(){return W(this,function(r){switch(r.label){case 0:return[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return[2,{kid:r.sent(),xms_ksl:hr.SW}]}})})},n.prototype.signPopToken=function(e,t,r){return z(this,void 0,void 0,function(){return W(this,function(o){return[2,this.signPayload(e,t,r)]})})},n.prototype.signPayload=function(e,t,r,o){return z(this,void 0,void 0,function(){var i,s,c,u,d,g;return W(this,function(C){switch(C.label){case 0:return i=r.resourceRequestMethod,c=r.shrClaims,u=r.shrNonce,d=(s=r.resourceRequestUri)?new Ee(s):void 0,g=d?.getUrlComponents(),[4,this.cryptoUtils.signJwt(j({at:e,ts:lt.nowSeconds(),m:i?.toUpperCase(),u:g?.HostNameAndPort,nonce:u||this.cryptoUtils.createNewGuid(),p:g?.AbsolutePath,q:g?.QueryString?[[],g.QueryString]:void 0,client_claims:c||void 0},o),t,r.correlationId)];case 1:return[2,C.sent()]}})})},n}(),yn=function(){function n(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(n.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),n}(),pr=function(){function n(e,t,r,o,i,s){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=o,this.serializableCache=i,this.persistencePlugin=s}return n.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw f.createStateNotFoundError(e.state?"Cached State":"Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw f.createStateMismatchError();if(e.error||e.error_description||e.suberror)throw Be.isInteractionRequiredError(e.error,e.error_description,e.suberror)?new Be(e.error||v.EMPTY_STRING,e.error_description,e.suberror):new Q(e.error||v.EMPTY_STRING,e.error_description,e.suberror);e.client_info&&ar(e.client_info,r)},n.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(Be.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Be(e.error,e.error_description,e.suberror);throw new Q(e.error,e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id,e.suberror)}},n.prototype.handleServerTokenResponse=function(e,t,r,o,i,s,c,u,d){return z(this,void 0,void 0,function(){var g,C,_,N,F,q;return W(this,function(te){switch(te.label){case 0:if(e.id_token){if(g=new Et(e.id_token||v.EMPTY_STRING,this.cryptoObj),i&&!y.isEmpty(i.nonce)&&g.claims.nonce!==i.nonce)throw f.createNonceMismatchError();if(o.maxAge||0===o.maxAge){if(!(C=g.claims.auth_time))throw f.createAuthTimeNotFoundError();Et.checkMaxAge(C,o.maxAge)}}this.homeAccountIdentifier=Ge.generateHomeAccountId(e.client_info||v.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,g),!!i&&!!i.state&&(_=It.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||o.sshKid||void 0,N=this.generateCacheRecord(e,t,r,o,g,s,i),te.label=1;case 1:return te.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),F=new yn(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(F)]):[3,3];case 2:te.sent(),te.label=3;case 3:return c&&!u&&N.account&&(q=N.account.generateAccountKey(),!this.cacheStorage.getAccount(q))?(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,n.generateAuthenticationResult(this.cryptoObj,t,N,!1,o,g,_,void 0,d)]):[4,this.cacheStorage.saveCacheRecord(N)];case 4:return te.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&F?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(F)]):[3,7];case 6:te.sent(),te.label=7;case 7:return[7];case 8:return[2,n.generateAuthenticationResult(this.cryptoObj,t,N,!1,o,g,_,e.spa_code,d)]}})})},n.prototype.generateCacheRecord=function(e,t,r,o,i,s,c){var d,g,u=t.getPreferredCache();if(y.isEmpty(u))throw f.createInvalidCacheEnvironmentError();!y.isEmpty(e.id_token)&&i&&(d=Xt.createIdTokenEntity(this.homeAccountIdentifier,u,e.id_token||v.EMPTY_STRING,this.clientId,i.claims.tid||v.EMPTY_STRING),g=this.generateAccountEntity(e,i,t,c));var C=null;if(!y.isEmpty(e.access_token)){var _=e.scope?Ye.fromString(e.scope):new Ye(o.scopes||[]),N=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,F=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,q=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,de=r+N,te=de+F,we=q&&q>0?r+q:void 0;C=$t.createAccessTokenEntity(this.homeAccountIdentifier,u,e.access_token||v.EMPTY_STRING,this.clientId,i?i.claims.tid||v.EMPTY_STRING:t.tenant,_.printScopes(),de,te,this.cryptoObj,we,e.token_type,s,e.key_id,o.claims,o.requestedClaimsHash)}var ve=null;y.isEmpty(e.refresh_token)||(ve=cr.createRefreshTokenEntity(this.homeAccountIdentifier,u,e.refresh_token||v.EMPTY_STRING,this.clientId,e.foci,s));var it=null;return y.isEmpty(e.foci)||(it=Cr.createAppMetadataEntity(this.clientId,u,e.foci)),new dr(g,d,C,ve,it)},n.prototype.generateAccountEntity=function(e,t,r,o){var s=o?o.cloud_graph_host_name:v.EMPTY_STRING,c=o?o.msgraph_host:v.EMPTY_STRING;if(r.authorityType===ot.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),Ge.createGenericAccount(this.homeAccountIdentifier,t,r,s,c);if(y.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw f.createClientInfoEmptyError();return e.client_info?Ge.createAccount(e.client_info,this.homeAccountIdentifier,t,r,s,c):Ge.createGenericAccount(this.homeAccountIdentifier,t,r,s,c)},n.generateAuthenticationResult=function(e,t,r,o,i,s,c,u,d){var g,C,_;return z(this,void 0,void 0,function(){var N,F,q,de,te,we,ve,it,$e;return W(this,function(Fe){switch(Fe.label){case 0:if(N=v.EMPTY_STRING,F=[],q=null,te=v.EMPTY_STRING,!r.accessToken)return[3,4];if(r.accessToken.tokenType!==ge.POP)return[3,2];if(we=new qt(e),it=(ve=r.accessToken).secret,!($e=ve.keyId))throw f.createKeyIdMissingError();return[4,we.signPopToken(it,$e,i)];case 1:return N=Fe.sent(),[3,3];case 2:N=r.accessToken.secret,Fe.label=3;case 3:F=Ye.fromString(r.accessToken.target).asArray(),q=new Date(1e3*Number(r.accessToken.expiresOn)),de=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),Fe.label=4;case 4:return r.appMetadata&&(te="1"===r.appMetadata.familyId?"1":v.EMPTY_STRING),[2,{authority:t.canonicalAuthority,uniqueId:s?.claims.oid||s?.claims.sub||v.EMPTY_STRING,tenantId:s?.claims.tid||v.EMPTY_STRING,scopes:F,account:r.account?r.account.getAccountInfo():null,idToken:s?s.rawToken:v.EMPTY_STRING,idTokenClaims:s?s.claims:{},accessToken:N,fromCache:o,expiresOn:q,correlationId:i.correlationId,requestId:d||v.EMPTY_STRING,extExpiresOn:de,familyId:te,tokenType:(null===(g=r.accessToken)||void 0===g?void 0:g.tokenType)||v.EMPTY_STRING,state:c?c.userRequestState:v.EMPTY_STRING,cloudGraphHostName:(null===(C=r.account)||void 0===C?void 0:C.cloudGraphHostName)||v.EMPTY_STRING,msGraphHost:(null===(_=r.account)||void 0===_?void 0:_.msGraphHost)||v.EMPTY_STRING,code:u,fromNativeBroker:!1}]}})})},n}(),Hr=function(n){function e(t){var r=n.call(this,t)||this;return r.includeRedirectUri=!0,r}return se(e,n),e.prototype.getAuthCodeUrl=function(t){return z(this,void 0,void 0,function(){var r;return W(this,function(o){switch(o.label){case 0:return[4,this.createAuthCodeUrlQueryString(t)];case 1:return r=o.sent(),[2,Ee.appendQueryString(this.authority.authorizationEndpoint,r)]}})})},e.prototype.acquireToken=function(t,r){var o;return z(this,void 0,void 0,function(){var i,s,c,u;return W(this,function(d){switch(d.label){case 0:if(this.logger.info("in acquireToken call"),!t||y.isEmpty(t.code))throw f.createTokenRequestCannotBeMadeError();return i=lt.nowSeconds(),[4,this.executeTokenRequest(this.authority,t)];case 1:return s=d.sent(),c=null===(o=s.headers)||void 0===o?void 0:o[M.X_MS_REQUEST_ID],(u=new pr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(s.body),[4,u.handleServerTokenResponse(s.body,this.authority,i,t,r,void 0,void 0,void 0,c)];case 2:return[2,d.sent()]}})})},e.prototype.handleFragmentResponse=function(t,r){var o=new pr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),i=new Ee(t),s=Ee.getDeserializedHash(i.getHash());if(o.validateServerAuthorizationCodeResponse(s,r,this.cryptoUtils),!s.code)throw f.createNoAuthCodeInServerResponseError();return j(j({},s),{code:s.code})},e.prototype.getLogoutUri=function(t){if(!t)throw Ie.createEmptyLogoutRequestError();var r=this.createLogoutUrlQueryString(t);return Ee.appendQueryString(this.authority.endSessionEndpoint,r)},e.prototype.executeTokenRequest=function(t,r){return z(this,void 0,void 0,function(){var o,i,s,c,u,d,g;return W(this,function(C){switch(C.label){case 0:return o={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:r.scopes,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},[4,this.createTokenRequestBody(r)];case 1:if(i=C.sent(),s=this.createTokenQueryParameters(r),c=void 0,r.clientInfo)try{u=ar(r.clientInfo,this.cryptoUtils),c={credential:""+u.uid+Ue.CLIENT_INFO_SEPARATOR+u.utid,type:Xe.HOME_ACCOUNT_ID}}catch(_){this.logger.verbose("Could not parse client info for CCS Header: "+_)}return d=this.createTokenRequestHeaders(c||r.ccsCredential),g=y.isEmpty(s)?t.tokenEndpoint:t.tokenEndpoint+"?"+s,[2,this.executePostToTokenEndpoint(g,i,d,o)]}})})},e.prototype.createTokenQueryParameters=function(t){var r=new jt;return t.tokenQueryParameters&&r.addExtraQueryParameters(t.tokenQueryParameters),r.createQueryString()},e.prototype.createTokenRequestBody=function(t){return z(this,void 0,void 0,function(){var r,o,s,c,u,d,g;return W(this,function(C){switch(C.label){case 0:return(r=new jt).addClientId(this.config.authOptions.clientId),this.includeRedirectUri?r.addRedirectUri(t.redirectUri):Ut.validateRedirectUri(t.redirectUri),r.addScopes(t.scopes),r.addAuthorizationCode(t.code),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&r.addServerTelemetry(this.serverTelemetryManager),t.codeVerifier&&r.addCodeVerifier(t.codeVerifier),this.config.clientCredentials.clientSecret&&r.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(r.addClientAssertion((o=this.config.clientCredentials.clientAssertion).assertion),r.addClientAssertionType(o.assertionType)),r.addGrantType(St.AUTHORIZATION_CODE_GRANT),r.addClientInfo(),t.authenticationScheme!==ge.POP?[3,2]:[4,new qt(this.cryptoUtils).generateCnf(t)];case 1:return s=C.sent(),r.addPopToken(s.reqCnfString),[3,3];case 2:if(t.authenticationScheme===ge.SSH){if(!t.sshJwk)throw Ie.createMissingSshJwkError();r.addSshJwk(t.sshJwk)}C.label=3;case 3:if(c=t.correlationId||this.config.cryptoInterface.createNewGuid(),r.addCorrelationId(c),(!y.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(t.claims,this.config.authOptions.clientCapabilities),u=void 0,t.clientInfo)try{d=ar(t.clientInfo,this.cryptoUtils),u={credential:""+d.uid+Ue.CLIENT_INFO_SEPARATOR+d.utid,type:Xe.HOME_ACCOUNT_ID}}catch(_){this.logger.verbose("Could not parse client info for CCS Header: "+_)}else u=t.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&u)switch(u.type){case Xe.HOME_ACCOUNT_ID:try{d=Gt(u.credential),r.addCcsOid(d)}catch(_){this.logger.verbose("Could not parse home account ID for CCS Header: "+_)}break;case Xe.UPN:r.addCcsUpn(u.credential)}return t.tokenBodyParameters&&r.addExtraQueryParameters(t.tokenBodyParameters),t.enableSpaAuthorizationCode&&(!t.tokenBodyParameters||!t.tokenBodyParameters[Z.RETURN_SPA_CODE])&&r.addExtraQueryParameters(((g={})[Z.RETURN_SPA_CODE]="1",g)),[2,r.createQueryString()]}})})},e.prototype.createAuthCodeUrlQueryString=function(t){return z(this,void 0,void 0,function(){var r,o,i,s,c,u,g;return W(this,function(C){switch(C.label){case 0:if((r=new jt).addClientId(this.config.authOptions.clientId),o=Ce(t.scopes||[],t.extraScopesToConsent||[]),r.addScopes(o),r.addRedirectUri(t.redirectUri),i=t.correlationId||this.config.cryptoInterface.createNewGuid(),r.addCorrelationId(i),r.addResponseMode(t.responseMode),r.addResponseTypeCode(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addClientInfo(),t.codeChallenge&&t.codeChallengeMethod&&r.addCodeChallengeParams(t.codeChallenge,t.codeChallengeMethod),t.prompt&&r.addPrompt(t.prompt),t.domainHint&&r.addDomainHint(t.domainHint),t.prompt!==be.SELECT_ACCOUNT)if(t.sid&&t.prompt===be.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),r.addSid(t.sid);else if(t.account){if(s=this.extractAccountSid(t.account),c=this.extractLoginHint(t.account)){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),r.addLoginHint(c);try{u=Gt(t.account.homeAccountId),r.addCcsOid(u)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(s&&t.prompt===be.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),r.addSid(s);try{u=Gt(t.account.homeAccountId),r.addCcsOid(u)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),r.addLoginHint(t.loginHint),r.addCcsUpn(t.loginHint);else if(t.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),r.addLoginHint(t.account.username);try{u=Gt(t.account.homeAccountId),r.addCcsOid(u)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),r.addLoginHint(t.loginHint),r.addCcsUpn(t.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return t.nonce&&r.addNonce(t.nonce),t.state&&r.addState(t.state),(!y.isEmpty(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(t.claims,this.config.authOptions.clientCapabilities),t.extraQueryParameters&&r.addExtraQueryParameters(t.extraQueryParameters),t.nativeBroker?(r.addNativeBroker(),t.authenticationScheme!==ge.POP?[3,2]:[4,new qt(this.cryptoUtils).generateCnf(t)]):[3,2];case 1:g=C.sent(),r.addPopToken(g.reqCnfHash),C.label=2;case 2:return[2,r.createQueryString()]}})})},e.prototype.createLogoutUrlQueryString=function(t){var r=new jt;return t.postLogoutRedirectUri&&r.addPostLogoutRedirectUri(t.postLogoutRedirectUri),t.correlationId&&r.addCorrelationId(t.correlationId),t.idTokenHint&&r.addIdTokenHint(t.idTokenHint),t.state&&r.addState(t.state),t.logoutHint&&r.addLogoutHint(t.logoutHint),t.extraQueryParameters&&r.addExtraQueryParameters(t.extraQueryParameters),r.createQueryString()},e.prototype.extractAccountSid=function(t){var r;return(null===(r=t.idTokenClaims)||void 0===r?void 0:r.sid)||null},e.prototype.extractLoginHint=function(t){var r;return(null===(r=t.idTokenClaims)||void 0===r?void 0:r.login_hint)||null},e}(Ar);function En(n){return n.hasOwnProperty("authorization_endpoint")&&n.hasOwnProperty("token_endpoint")&&n.hasOwnProperty("issuer")&&n.hasOwnProperty("jwks_uri")}var Fr={"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},Br={"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},_n=function(){function n(e){this.networkInterface=e}return n.prototype.detectRegion=function(e,t,r){return z(this,void 0,void 0,function(){var o,i,s,c,u;return W(this,function(d){switch(d.label){case 0:if(o=e)return[3,8];i=n.IMDS_OPTIONS,r&&(i.proxyUrl=r),d.label=1;case 1:return d.trys.push([1,6,,7]),[4,this.getRegionFromIMDS(v.IMDS_VERSION,i)];case 2:return(s=d.sent()).status===Pe.httpSuccess&&(o=s.body,t.region_source=ye.IMDS),s.status!==Pe.httpBadRequest?[3,5]:[4,this.getCurrentVersion(i)];case 3:return(c=d.sent())?[4,this.getRegionFromIMDS(c,i)]:(t.region_source=ye.FAILED_AUTO_DETECTION,[2,null]);case 4:(u=d.sent()).status===Pe.httpSuccess&&(o=u.body,t.region_source=ye.IMDS),d.label=5;case 5:return[3,7];case 6:return d.sent(),t.region_source=ye.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:t.region_source=ye.ENVIRONMENT_VARIABLE,d.label=9;case 9:return o||(t.region_source=ye.FAILED_AUTO_DETECTION),[2,o||null]}})})},n.prototype.getRegionFromIMDS=function(e,t){return z(this,void 0,void 0,function(){return W(this,function(r){return[2,this.networkInterface.sendGetRequestAsync(v.IMDS_ENDPOINT+"?api-version="+e+"&format=text",t,v.IMDS_TIMEOUT)]})})},n.prototype.getCurrentVersion=function(e){return z(this,void 0,void 0,function(){var t;return W(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(v.IMDS_ENDPOINT+"?format=json",e)];case 1:return(t=r.sent()).status===Pe.httpBadRequest&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?[2,t.body["newest-versions"][0]]:[2,null];case 2:return r.sent(),[2,null];case 3:return[2]}})})},n.IMDS_OPTIONS={headers:{Metadata:"true"}},n}(),fr=function(){function n(e,t,r,o,i,s){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=o,this.regionDiscovery=new _n(t),this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.proxyUrl=s||v.EMPTY_STRING,this.logger=i}return Object.defineProperty(n.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;if(e.length)switch(e[0].toLowerCase()){case v.ADFS:return ot.Adfs;case v.DSTS:return ot.Dsts}return ot.Default},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new Ee(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(e)}throw f.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(e)}throw f.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(e)}throw f.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw f.createLogoutNotSupportedError();var e=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(e)}throw f.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.issuer);return this.replaceTenant(e)}throw f.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"jwksUri",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.jwks_uri);return this.replaceTenant(e)}throw f.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),n.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},n.prototype.replacePath=function(e){var t=e,o=new Ee(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach(function(s,c){var u=o[c];s!==u&&(t=t.replace("/"+u+"/","/"+s+"/"))}),t},Object.defineProperty(n.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===ot.Adfs||this.authorityType===ot.Dsts||this.protocolMode===Zt.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),n.prototype.discoveryComplete=function(){return!!this.metadata},n.prototype.resolveEndpointsAsync=function(){return z(this,void 0,void 0,function(){var e,t,r,o;return W(this,function(i){switch(i.label){case 0:return(e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(e=new _r).updateCanonicalAuthority(this.canonicalAuthority),[4,this.updateCloudDiscoveryMetadata(e)];case 1:return t=i.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network),[4,this.updateEndpointMetadata(e)];case 2:return r=i.sent(),t!==Le.CACHE&&r!==Le.CACHE&&(e.resetExpiresAt(),e.updateCanonicalAuthority(this.canonicalAuthority)),o=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache),this.cacheManager.setAuthorityMetadata(o,e),this.metadata=e,[2]}})})},n.prototype.updateEndpointMetadata=function(e){var t,r;return z(this,void 0,void 0,function(){var o,i;return W(this,function(s){switch(s.label){case 0:return(o=this.getEndpointMetadataFromConfig())?(e.updateEndpointMetadata(o,!1),[2,Le.CONFIG]):this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!e.isExpired()?[2,Le.CACHE]:(i=this.getEndpointMetadataFromHardcodedValues(),[4,this.getEndpointMetadataFromNetwork()]);case 1:return(o=s.sent())?null!==(t=this.authorityOptions.azureRegionConfiguration)&&void 0!==t&&t.azureRegion?[4,this.updateMetadataWithRegionalInformation(o)]:[3,3]:[3,4];case 2:o=s.sent(),s.label=3;case 3:return e.updateEndpointMetadata(o,!0),[2,Le.NETWORK];case 4:return i&&!this.authorityOptions.skipAuthorityMetadataCache?null!==(r=this.authorityOptions.azureRegionConfiguration)&&void 0!==r&&r.azureRegion?[4,this.updateMetadataWithRegionalInformation(i)]:[3,6]:[3,7];case 5:i=s.sent(),s.label=6;case 6:return e.updateEndpointMetadata(i,!1),[2,Le.HARDCODED_VALUES];case 7:throw f.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}})})},n.prototype.isAuthoritySameType=function(e){return new Ee(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},n.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw Ie.createInvalidAuthorityMetadataError()}return null},n.prototype.getEndpointMetadataFromNetwork=function(){return z(this,void 0,void 0,function(){var e,t;return W(this,function(r){switch(r.label){case 0:e={},this.proxyUrl&&(e.proxyUrl=this.proxyUrl),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,e)];case 2:return[2,En((t=r.sent()).body)?t.body:null];case 3:return r.sent(),[2,null];case 4:return[2]}})})},n.prototype.getEndpointMetadataFromHardcodedValues=function(){return this.canonicalAuthority in Fr?Fr[this.canonicalAuthority]:null},n.prototype.updateMetadataWithRegionalInformation=function(e){var t,r,o,i,s;return z(this,void 0,void 0,function(){var c,u;return W(this,function(d){switch(d.label){case 0:return[4,this.regionDiscovery.detectRegion(null===(t=this.authorityOptions.azureRegionConfiguration)||void 0===t?void 0:t.environmentRegion,this.regionDiscoveryMetadata,this.proxyUrl)];case 1:return c=d.sent(),u=(null===(r=this.authorityOptions.azureRegionConfiguration)||void 0===r?void 0:r.azureRegion)===v.AZURE_REGION_AUTO_DISCOVER_FLAG?c:null===(o=this.authorityOptions.azureRegionConfiguration)||void 0===o?void 0:o.azureRegion,this.regionDiscoveryMetadata.region_outcome=(null===(i=this.authorityOptions.azureRegionConfiguration)||void 0===i?void 0:i.azureRegion)===v.AZURE_REGION_AUTO_DISCOVER_FLAG?c?tt.AUTO_DETECTION_REQUESTED_SUCCESSFUL:tt.AUTO_DETECTION_REQUESTED_FAILED:c?(null===(s=this.authorityOptions.azureRegionConfiguration)||void 0===s?void 0:s.azureRegion)===c?tt.CONFIGURED_MATCHES_DETECTED:tt.CONFIGURED_NOT_DETECTED:tt.CONFIGURED_NO_AUTO_DETECTION,u?(this.regionDiscoveryMetadata.region_used=u,[2,n.replaceWithRegionalInformation(e,u)]):[2,e]}})})},n.prototype.updateCloudDiscoveryMetadata=function(e){return z(this,void 0,void 0,function(){var t,r,o;return W(this,function(i){switch(i.label){case 0:return this.logger.verbose("Attempting to get cloud discovery metadata in the config"),this.logger.verbosePii("Known Authorities: "+(this.authorityOptions.knownAuthorities||v.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: "+(this.authorityOptions.authorityMetadata||v.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: "+(e.canonical_authority||v.NOT_APPLICABLE)),(t=this.getCloudDiscoveryMetadataFromConfig())?(this.logger.verbose("Found cloud discovery metadata in the config."),e.updateCloudDiscoveryMetadata(t,!1),[2,Le.CONFIG]):(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the cache."),r=e.isExpired(),this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!r?(this.logger.verbose("Found metadata in the cache."),[2,Le.CACHE]):(r&&this.logger.verbose("The metadata entity is expired."),this.logger.verbose("Did not find cloud discovery metadata in the cache... Attempting to get cloud discovery metadata from the network."),[4,this.getCloudDiscoveryMetadataFromNetwork()]));case 1:if(t=i.sent())return this.logger.verbose("cloud discovery metadata was successfully returned from getCloudDiscoveryMetadataFromNetwork()"),e.updateCloudDiscoveryMetadata(t,!0),[2,Le.NETWORK];if(this.logger.verbose("Did not find cloud discovery metadata from the network... Attempting to get cloud discovery metadata from hardcoded values."),(o=this.getCloudDiscoveryMetadataFromHarcodedValues())&&!this.options.skipAuthorityMetadataCache)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),e.updateCloudDiscoveryMetadata(o,!1),[2,Le.HARDCODED_VALUES];throw this.logger.error("Did not find cloud discovery metadata from hardcoded values... Metadata could not be obtained from config, cache, network or hardcoded values. Throwing Untrusted Authority Error."),Ie.createUntrustedAuthorityError()}})})},n.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");var e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=n.getCloudDiscoveryMetadataFromNetworkResponse(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Ie.createInvalidCloudDiscoveryMetadataError()}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),n.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null},n.prototype.getCloudDiscoveryMetadataFromNetwork=function(){return z(this,void 0,void 0,function(){var e,t,r,o,i,s,c,u;return W(this,function(d){switch(d.label){case 0:e=""+v.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",t={},this.proxyUrl&&(t.proxyUrl=this.proxyUrl),r=null,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(e,t)];case 2:if(o=d.sent(),i=void 0,s=void 0,function Tn(n){return n.hasOwnProperty("tenant_discovery_endpoint")&&n.hasOwnProperty("metadata")}(o.body))s=(i=o.body).metadata,this.logger.verbosePii("tenant_discovery_endpoint is: "+i.tenant_discovery_endpoint);else{if(!function Cn(n){return n.hasOwnProperty("error")&&n.hasOwnProperty("error_description")}(o.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),[2,null];if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: "+o.status),(i=o.body).error===v.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),[2,null];this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is "+i.error),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is "+i.error_description),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),s=[]}return this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=n.getCloudDiscoveryMetadataFromNetworkResponse(s,this.hostnameAndPort),[3,4];case 3:return(c=d.sent())instanceof S?this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: "+c.errorCode+"\nError Description: "+c.errorMessage):this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: "+(u=c).name+"\nError Description: "+u.message),[2,null];case 4:return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=n.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,r]}})})},n.prototype.getCloudDiscoveryMetadataFromHarcodedValues=function(){return this.canonicalAuthority in Br?Br[this.canonicalAuthority]:null},n.prototype.isInKnownAuthorities=function(){var e=this;return this.authorityOptions.knownAuthorities.filter(function(r){return Ee.getDomainFromUrl(r).toLowerCase()===e.hostnameAndPort}).length>0},n.generateAuthority=function(e,t){var r;return t&&t.azureCloudInstance!==zt.None&&(r=t.azureCloudInstance+"/"+(t.tenant?t.tenant:v.DEFAULT_COMMON_TENANT)+"/"),r||e},n.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},n.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var r=0;r<e.length;r++){var o=e[r];if(o.aliases.indexOf(t)>-1)return o}return null},n.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw f.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},n.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},n.isPublicCloudAuthority=function(e){return v.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},n.buildRegionalAuthorityString=function(e,t,r){var o=new Ee(e);o.validateAsUri();var i=o.getUrlComponents(),s=t+"."+i.HostNameAndPort;this.isPublicCloudAuthority(i.HostNameAndPort)&&(s=t+"."+v.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var c=Ee.constructAuthorityUriFromObject(j(j({},o.getUrlComponents()),{HostNameAndPort:s})).urlString;return r?c+"?"+r:c},n.replaceWithRegionalInformation=function(e,t){return e.authorization_endpoint=n.buildRegionalAuthorityString(e.authorization_endpoint,t),e.token_endpoint=n.buildRegionalAuthorityString(e.token_endpoint,t,v.REGIONAL_AUTH_NON_MSI_QUERY_STRING),e.end_session_endpoint&&(e.end_session_endpoint=n.buildRegionalAuthorityString(e.end_session_endpoint,t)),e},n}(),gr=function(){function n(){}return n.createDiscoveredInstance=function(e,t,r,o,i,s){return z(this,void 0,void 0,function(){var c,u;return W(this,function(d){switch(d.label){case 0:c=n.createInstance(e,t,r,o,i,s),d.label=1;case 1:return d.trys.push([1,3,,4]),[4,c.resolveEndpointsAsync()];case 2:return d.sent(),[2,c];case 3:throw u=d.sent(),f.createEndpointDiscoveryIncompleteError(u);case 4:return[2]}})})},n.createInstance=function(e,t,r,o,i,s){if(y.isEmpty(e))throw Ie.createUrlEmptyError();return new fr(e,t,r,o,i,s)},n}(),Sn=function(){function n(e,t){this.cacheOutcome=Je.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||v.EMPTY_STRING,this.wrapperVer=e.wrapperVer||v.EMPTY_STRING,this.telemetryCacheKey=ke.CACHE_KEY+Ue.CACHE_KEY_SEPARATOR+e.clientId}return n.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+ke.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join(ke.VALUE_SEPARATOR),o=[e,this.getRegionDiscoveryFields()].join(ke.VALUE_SEPARATOR);return[ke.SCHEMA_VERSION,o,t].join(ke.CATEGORY_SEPARATOR)},n.prototype.generateLastRequestHeaderValue=function(){var e=this.getLastRequests(),t=n.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(ke.VALUE_SEPARATOR),o=e.errors.slice(0,t).join(ke.VALUE_SEPARATOR),i=e.errors.length,c=[i,t<i?ke.OVERFLOW_TRUE:ke.OVERFLOW_FALSE].join(ke.VALUE_SEPARATOR);return[ke.SCHEMA_VERSION,e.cacheHits,r,o,c].join(ke.CATEGORY_SEPARATOR)},n.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=ke.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),y.isEmpty(e.subError)?y.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(ke.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},n.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},n.prototype.getLastRequests=function(){var e=new lr;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},n.prototype.clearTelemetryCache=function(){var e=this.getLastRequests(),t=n.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var o=new lr;o.failedRequests=e.failedRequests.slice(2*t),o.errors=e.errors.slice(t),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o)}},n.maxErrorsToSend=function(e){var t,r=0,o=0,i=e.errors.length;for(t=0;t<i;t++){var c=e.failedRequests[2*t+1]||v.EMPTY_STRING,u=e.errors[t]||v.EMPTY_STRING;if(!((o+=(e.failedRequests[2*t]||v.EMPTY_STRING).toString().length+c.toString().length+u.length+3)<ke.MAX_LAST_HEADER_BYTES))break;r+=1}return r},n.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||v.EMPTY_STRING),e.push(this.regionSource||v.EMPTY_STRING),e.push(this.regionOutcome||v.EMPTY_STRING),e.join(",")},n.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},n.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},n}(),Kr=function(){function n(e,t,r,o,i,s,c,u,d){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=i,this.navigationClient=s,this.nativeMessageHandler=u,this.correlationId=d||this.browserCrypto.createNewGuid(),this.logger=o.clone("msal.js.browser",er,this.correlationId),this.performanceClient=c}return n.prototype.clearCacheOnLogout=function(e){return p(this,void 0,void 0,function(){return O(this,function(t){switch(t.label){case 0:if(!e)return[3,5];Ge.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(Ge.generateAccountCacheKey(e))];case 2:return t.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return t.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return t.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return t.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return t.sent(),[3,9];case 8:return t.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}})})},n.prototype.initializeBaseRequest=function(e){return p(this,void 0,void 0,function(){var t,r,o,i;return O(this,function(s){switch(s.label){case 0:if(this.logger.verbose("Initializing BaseAuthRequest"),t=e.authority||this.config.auth.authority,r=dt(e&&e.scopes||[]),(o=D(D({},e),{correlationId:this.correlationId,authority:t,scopes:r})).authenticationScheme){if(o.authenticationScheme===ge.SSH){if(!e.sshJwk)throw Ie.createMissingSshJwkError();if(!e.sshKid)throw Ie.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+o.authenticationScheme+'" as configured in Auth request')}else o.authenticationScheme=ge.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return e.claims&&!y.isEmpty(e.claims)?(i=o,[4,this.browserCrypto.hashString(e.claims)]):[3,2];case 1:i.requestedClaimsHash=s.sent(),s.label=2;case 2:return[2,o]}})})},n.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||Ne.getCurrentUri();return Ee.getAbsoluteUrl(t,Ne.getCurrentUri())},n.prototype.initializeServerTelemetryManager=function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Sn(r,this.browserStorage)},n.prototype.getDiscoveredAuthority=function(e){return p(this,void 0,void 0,function(){var t;return O(this,function(r){switch(r.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority"),[4,gr.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t,this.logger)]):[3,2];case 1:case 3:return[2,r.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,gr.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t,this.logger)]}})})},n}(),Vt=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return he(e,n),e.prototype.initializeAuthorizationCodeRequest=function(t){return p(this,void 0,void 0,function(){var r,o;return O(this,function(i){switch(i.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called",t.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return r=i.sent(),o=D(D({},t),{redirectUri:t.redirectUri,code:v.EMPTY_STRING,codeVerifier:r.verifier}),t.codeChallenge=r.challenge,t.codeChallengeMethod=v.S256_CODE_CHALLENGE_METHOD,[2,o]}})})},e.prototype.initializeLogoutRequest=function(t){this.logger.verbose("initializeLogoutRequest called",t?.correlationId);var r=D({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},t);if(t)if(t.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(t.account){var o=this.getLogoutHintFromIdTokenClaims(t.account);o&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),r.logoutHint=o)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return t&&null===t.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",r.correlationId):t&&t.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",r.correlationId),r.postLogoutRedirectUri=Ee.getAbsoluteUrl(t.postLogoutRedirectUri,Ne.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",r.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",r.correlationId),r.postLogoutRedirectUri=Ee.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Ne.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",r.correlationId),r.postLogoutRedirectUri=Ee.getAbsoluteUrl(Ne.getCurrentUri(),Ne.getCurrentUri())),r},e.prototype.getLogoutHintFromIdTokenClaims=function(t){var r=t.idTokenClaims;if(r){if(r.login_hint)return r.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},e.prototype.createAuthCodeClient=function(t,r,o){return p(this,void 0,void 0,function(){var i;return O(this,function(s){switch(s.label){case 0:return[4,this.getClientConfiguration(t,r,o)];case 1:return i=s.sent(),[2,new Hr(i)]}})})},e.prototype.getClientConfiguration=function(t,r,o){return p(this,void 0,void 0,function(){var i;return O(this,function(s){switch(s.label){case 0:return this.logger.verbose("getClientConfiguration called",this.correlationId),[4,this.getDiscoveredAuthority(r,o)];case 1:return i=s.sent(),[2,{authOptions:{clientId:this.config.auth.clientId,authority:i,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,logLevel:this.config.system.loggerOptions.logLevel,correlationId:this.correlationId},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:"msal.js.browser",version:er,cpu:v.EMPTY_STRING,os:v.EMPTY_STRING},telemetry:this.config.telemetry}]}})})},e.prototype.validateAndExtractStateFromHash=function(t,r,o){if(this.logger.verbose("validateAndExtractStateFromHash called",o),!t.state)throw E.createHashDoesNotContainStateError();var i=Ur.extractBrowserRequestState(this.browserCrypto,t.state);if(!i)throw E.createUnableToParseStateError();if(i.interactionType!==r)throw E.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",o),t.state},e.prototype.getDiscoveredAuthority=function(t,r){return p(this,void 0,void 0,function(){var o,i,c;return O(this,function(u){switch(u.label){case 0:return this.logger.verbose("getDiscoveredAuthority called",this.correlationId),o=this.performanceClient.startMeasurement(ue.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},c=fr.generateAuthority(t||this.config.auth.authority,r||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),[4,gr.createDiscoveredInstance(c,this.config.system.networkClient,this.browserStorage,i,this.logger).then(function(d){return o.endMeasurement({success:!0}),d}).catch(function(d){throw o.endMeasurement({errorCode:d.errorCode,subErrorCode:d.subError,success:!1}),d})];case 1:return[2,u.sent()]}})})},e.prototype.initializeAuthorizationRequest=function(t,r){return p(this,void 0,void 0,function(){var o,s,c,u,d,g;return O(this,function(C){switch(C.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),o=this.getRedirectUri(t.redirectUri),s=It.setRequestState(this.browserCrypto,t&&t.state||v.EMPTY_STRING,{interactionType:r}),u=[{}],[4,this.initializeBaseRequest(t)];case 1:return c=D.apply(void 0,[D.apply(void 0,u.concat([C.sent()])),{redirectUri:o,state:s,nonce:t.nonce||this.browserCrypto.createNewGuid(),responseMode:_t.FRAGMENT}]),(d=t.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+d.homeAccountId,this.correlationId),c.account=d),y.isEmpty(c.loginHint)&&!d&&(g=this.browserStorage.getLegacyLoginHint())&&(c.loginHint=g),[2,c]}})})},e}(Kr),At=(()=>{return(n=At||(At={})).USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",n.USER_CANCEL="USER_CANCEL",n.NO_NETWORK="NO_NETWORK",n.TRANSIENT_ERROR="TRANSIENT_ERROR",n.PERSISTENT_ERROR="PERSISTENT_ERROR",n.DISABLED="DISABLED",n.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE",At;var n})(),tr_extensionError_code="ContentError",tr_userSwitch_code="user_switch",tr_userSwitch_desc="User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again.",tr_tokensNotFoundInCache_code="tokens_not_found_in_internal_memory_cache",tr_tokensNotFoundInCache_desc="Tokens not cached in MSAL JS internal memory, please make the WAM request",Tt=function(n){function e(t,r,o){var i=n.call(this,t,r)||this;return Object.setPrototypeOf(i,e.prototype),i.name="NativeAuthError",i.ext=o,i}return he(e,n),e.prototype.isFatal=function(){return!(!this.ext||!this.ext.status||this.ext.status!==At.PERSISTENT_ERROR&&this.ext.status!==At.DISABLED)||this.errorCode===tr_extensionError_code},e.createError=function(t,r,o){if(o&&o.status)switch(o.status){case At.ACCOUNT_UNAVAILABLE:return Be.createNativeAccountUnavailableError();case At.USER_INTERACTION_REQUIRED:return new Be(t,r);case At.USER_CANCEL:return E.createUserCancelledError();case At.NO_NETWORK:return E.createNoNetworkConnectivityError()}return new e(t,r,o)},e.createUserSwitchError=function(){return new e(tr_userSwitch_code,tr_userSwitch_desc)},e.createTokensNotFoundInCacheError=function(){return new e(tr_tokensNotFoundInCache_code,tr_tokensNotFoundInCache_desc)},e}(S),Gr=function(n){function e(t,r){return n.call(this,t,r)||this}return se(e,n),e.prototype.acquireToken=function(t){var r,o,i;return z(this,void 0,void 0,function(){var s,c,u,d,g,C=this;return W(this,function(_){switch(_.label){case 0:return s=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(ue.RefreshTokenClientAcquireToken,t.correlationId),this.logger.verbose("RefreshTokenClientAcquireToken called",t.correlationId),c=lt.nowSeconds(),[4,this.executeTokenRequest(t,this.authority)];case 1:return u=_.sent(),s?.addStaticFields({refreshTokenSize:(null===(o=u.body.refresh_token)||void 0===o?void 0:o.length)||0}),d=null===(i=u.headers)||void 0===i?void 0:i[M.X_MS_REQUEST_ID],(g=new pr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(u.body),[2,g.handleServerTokenResponse(u.body,this.authority,c,t,void 0,void 0,!0,t.forceCache,d).then(function(N){return s?.endMeasurement({success:!0}),N}).catch(function(N){throw C.logger.verbose("Error in fetching refresh token",t.correlationId),s?.endMeasurement({errorCode:N.errorCode,subErrorCode:N.subError,success:!1}),N})]}})})},e.prototype.acquireTokenByRefreshToken=function(t){return z(this,void 0,void 0,function(){var i;return W(this,function(s){if(!t)throw Ie.createEmptyTokenRequestError();if(!t.account)throw f.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(t.account.environment,this.config.authOptions.clientId))try{return[2,this.acquireTokenWithCachedRefreshToken(t,!0)]}catch(c){if(i=c instanceof Q&&"invalid_grant"===c.errorCode&&"client_mismatch"===c.subError,c instanceof Be&&c.errorCode===ht_noTokensFoundError_code||i)return[2,this.acquireTokenWithCachedRefreshToken(t,!1)];throw c}return[2,this.acquireTokenWithCachedRefreshToken(t,!1)]})})},e.prototype.acquireTokenWithCachedRefreshToken=function(t,r){var o;return z(this,void 0,void 0,function(){var i,s,c;return W(this,function(u){if(i=null===(o=this.performanceClient)||void 0===o?void 0:o.startMeasurement(ue.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),this.logger.verbose("RefreshTokenClientAcquireTokenWithCachedRefreshToken called",t.correlationId),!(s=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,t.account,r)))throw i?.discardMeasurement(),Be.createNoTokensFoundError();return i?.endMeasurement({success:!0}),c=j(j({},t),{refreshToken:s.secret,authenticationScheme:t.authenticationScheme||ge.BEARER,ccsCredential:{credential:t.account.homeAccountId,type:Xe.HOME_ACCOUNT_ID}}),[2,this.acquireToken(c)]})})},e.prototype.executeTokenRequest=function(t,r){var o;return z(this,void 0,void 0,function(){var i,s,c,u,d,g;return W(this,function(C){switch(C.label){case 0:return i=null===(o=this.performanceClient)||void 0===o?void 0:o.startMeasurement(ue.RefreshTokenClientExecuteTokenRequest,t.correlationId),[4,this.createTokenRequestBody(t)];case 1:return s=C.sent(),c=this.createTokenQueryParameters(t),u=this.createTokenRequestHeaders(t.ccsCredential),d={clientId:this.config.authOptions.clientId,authority:r.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},g=Ee.appendQueryString(r.tokenEndpoint,c),[2,this.executePostToTokenEndpoint(g,s,u,d).then(function(_){return i?.endMeasurement({success:!0}),_}).catch(function(_){throw i?.endMeasurement({success:!1}),_})]}})})},e.prototype.createTokenQueryParameters=function(t){var r=new jt;return t.tokenQueryParameters&&r.addExtraQueryParameters(t.tokenQueryParameters),r.createQueryString()},e.prototype.createTokenRequestBody=function(t){var r;return z(this,void 0,void 0,function(){var o,i,s,c,d,g;return W(this,function(C){switch(C.label){case 0:return o=t.correlationId,i=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(ue.BaseClientCreateTokenRequestHeaders,o),(s=new jt).addClientId(this.config.authOptions.clientId),s.addScopes(t.scopes),s.addGrantType(St.REFRESH_TOKEN_GRANT),s.addClientInfo(),s.addLibraryInfo(this.config.libraryInfo),s.addApplicationTelemetry(this.config.telemetry.application),s.addThrottling(),this.serverTelemetryManager&&s.addServerTelemetry(this.serverTelemetryManager),s.addCorrelationId(o),s.addRefreshToken(t.refreshToken),this.config.clientCredentials.clientSecret&&s.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(s.addClientAssertion((c=this.config.clientCredentials.clientAssertion).assertion),s.addClientAssertionType(c.assertionType)),t.authenticationScheme!==ge.POP?[3,2]:[4,new qt(this.cryptoUtils).generateCnf(t)];case 1:return d=C.sent(),s.addPopToken(d.reqCnfString),[3,3];case 2:if(t.authenticationScheme===ge.SSH){if(!t.sshJwk)throw i?.endMeasurement({success:!1}),Ie.createMissingSshJwkError();s.addSshJwk(t.sshJwk)}C.label=3;case 3:if((!y.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&s.addClaims(t.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&t.ccsCredential)switch(t.ccsCredential.type){case Xe.HOME_ACCOUNT_ID:try{g=Gt(t.ccsCredential.credential),s.addCcsOid(g)}catch(_){this.logger.verbose("Could not parse home account ID for CCS Header: "+_)}break;case Xe.UPN:s.addCcsUpn(t.ccsCredential.credential)}return i?.endMeasurement({success:!0}),[2,s.createQueryString()]}})})},e}(Ar),wn=function(n){function e(t,r){return n.call(this,t,r)||this}return se(e,n),e.prototype.acquireToken=function(t){return z(this,void 0,void 0,function(){var r;return W(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.acquireCachedToken(t)];case 1:return[2,i.sent()];case 2:if((r=i.sent())instanceof f&&r.errorCode===a_tokenRefreshRequired_code)return[2,new Gr(this.config,this.performanceClient).acquireTokenByRefreshToken(t)];throw r;case 3:return[2]}})})},e.prototype.acquireCachedToken=function(t){var r,o,i,s;return z(this,void 0,void 0,function(){var c,u;return W(this,function(d){switch(d.label){case 0:if(!t)throw Ie.createEmptyTokenRequestError();if(t.forceRefresh)throw null===(r=this.serverTelemetryManager)||void 0===r||r.setCacheOutcome(Je.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),f.createRefreshRequiredError();if(!t.account)throw f.createNoAccountInSilentRequestError();if(c=t.authority||this.authority.getPreferredCache(),!(u=this.cacheManager.readCacheRecord(t.account,this.config.authOptions.clientId,t,c)).accessToken)throw null===(o=this.serverTelemetryManager)||void 0===o||o.setCacheOutcome(Je.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),f.createRefreshRequiredError();if(lt.wasClockTurnedBack(u.accessToken.cachedAt)||lt.isTokenExpired(u.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null===(i=this.serverTelemetryManager)||void 0===i||i.setCacheOutcome(Je.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),f.createRefreshRequiredError();if(u.accessToken.refreshOn&&lt.isTokenExpired(u.accessToken.refreshOn,0))throw null===(s=this.serverTelemetryManager)||void 0===s||s.setCacheOutcome(Je.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),f.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(u,t)];case 1:return[2,d.sent()]}})})},e.prototype.generateResultFromCacheRecord=function(t,r){return z(this,void 0,void 0,function(){var o,i;return W(this,function(s){switch(s.label){case 0:if(t.idToken&&(o=new Et(t.idToken.secret,this.config.cryptoInterface)),r.maxAge||0===r.maxAge){if(i=o?.claims.auth_time,!i)throw f.createAuthTimeNotFoundError();Et.checkMaxAge(i,r.maxAge)}return[4,pr.generateAuthenticationResult(this.cryptoUtils,this.authority,t,!0,r,o)];case 1:return[2,s.sent()]}})})},e}(Ar),zr=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return he(e,n),e.prototype.acquireToken=function(t){return p(this,void 0,void 0,function(){var r,o,i,s,c;return O(this,function(u){switch(u.label){case 0:return r=this.performanceClient.startMeasurement(ue.SilentCacheClientAcquireToken,t.correlationId),o=this.initializeServerTelemetryManager(Se.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(o,t.authority,t.azureCloudOptions)];case 1:i=u.sent(),this.logger.verbose("Silent auth client created"),u.label=2;case 2:return u.trys.push([2,4,,5]),[4,i.acquireCachedToken(t)];case 3:return s=u.sent(),r.endMeasurement({success:!0,fromCache:!0}),[2,s];case 4:throw(c=u.sent())instanceof E&&c.errorCode===m_signingKeyNotFoundInStorage_code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),r.endMeasurement({errorCode:c instanceof S&&c.errorCode||void 0,subErrorCode:c instanceof S&&c.subError||void 0,success:!1}),c;case 5:return[2]}})})},e.prototype.logout=function(){return Promise.reject(E.createSilentLogoutUnsupportedError())},e.prototype.createSilentFlowClient=function(t,r,o){return p(this,void 0,void 0,function(){var i;return O(this,function(s){switch(s.label){case 0:return[4,this.getClientConfiguration(t,r,o)];case 1:return i=s.sent(),[2,new wn(i,this.performanceClient)]}})})},e.prototype.initializeSilentRequest=function(t,r){return p(this,void 0,void 0,function(){var o;return O(this,function(i){switch(i.label){case 0:return o=[D({},t)],[4,this.initializeBaseRequest(t)];case 1:return[2,D.apply(void 0,[D.apply(void 0,o.concat([i.sent()])),{account:r,forceRefresh:t.forceRefresh||!1}])]}})})},e}(Vt),Yt=function(n){function e(t,r,o,i,s,c,u,d,g,C,_,N){var F=n.call(this,t,r,o,i,s,c,d,g,N)||this;return F.apiId=u,F.accountId=C,F.nativeMessageHandler=g,F.nativeStorageManager=_,F.silentCacheClient=new zr(t,F.nativeStorageManager,o,i,s,c,d,g,N),F}return he(e,n),e.prototype.acquireToken=function(t){return p(this,void 0,void 0,function(){var r,o,i,s,u,d;return O(this,function(g){switch(g.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),r=this.performanceClient.startMeasurement(ue.NativeInteractionClientAcquireToken,t.correlationId),o=lt.nowSeconds(),[4,this.initializeNativeRequest(t)];case 1:i=g.sent(),g.label=2;case 2:return g.trys.push([2,4,,5]),[4,this.acquireTokensFromCache(this.accountId,i)];case 3:return s=g.sent(),r.endMeasurement({success:!0,isNativeBroker:!1,fromCache:!0}),[2,s];case 4:return g.sent(),this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call"),[3,5];case 5:return[4,this.nativeMessageHandler.sendMessage({method:ct.GetToken,request:i})];case 6:return u=g.sent(),d=this.validateNativeResponse(u),[2,this.handleNativeResponse(d,i,o).then(function(C){return r.endMeasurement({success:!0,isNativeBroker:!0,requestId:C.requestId}),C}).catch(function(C){throw r.endMeasurement({success:!1,errorCode:C.errorCode,subErrorCode:C.subError,isNativeBroker:!0}),C})]}})})},e.prototype.createSilentCacheRequest=function(t,r){return{authority:t.authority,correlationId:this.correlationId,scopes:Ye.fromString(t.scope).asArray(),account:r,forceRefresh:!1}},e.prototype.acquireTokensFromCache=function(t,r){return p(this,void 0,void 0,function(){var o,i,s;return O(this,function(d){switch(d.label){case 0:if(!(o=this.browserStorage.readAccountFromCacheWithNativeAccountId(t)))throw f.createNoAccountFoundError();i=o.getAccountInfo(),d.label=1;case 1:return d.trys.push([1,3,,4]),s=this.createSilentCacheRequest(r,i),[4,this.silentCacheClient.acquireToken(s)];case 2:return[2,d.sent()];case 3:throw d.sent();case 4:return[2]}})})},e.prototype.acquireTokenRedirect=function(t){return p(this,void 0,void 0,function(){var r,o,i,s,c,u;return O(this,function(d){switch(d.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(t)];case 1:r=d.sent(),o={method:ct.GetToken,request:r},d.label=2;case 2:return d.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(o)];case 3:return i=d.sent(),this.validateNativeResponse(i),[3,5];case 4:if((s=d.sent())instanceof Tt&&s.isFatal())throw s;return[3,5];case 5:return this.browserStorage.setTemporaryCache(pe.NATIVE_REQUEST,JSON.stringify(r),!0),c={apiId:Se.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},u=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(t.redirectUri),[4,this.navigationClient.navigateExternal(u,c)];case 6:return d.sent(),[2]}})})},e.prototype.handleRedirectPromise=function(){return p(this,void 0,void 0,function(){var t,r,o,i,s,c,u,d;return O(this,function(g){switch(g.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(t=this.browserStorage.getCachedNativeRequest()))return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];r=t.prompt,o=mt(t,["prompt"]),r&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(pe.NATIVE_REQUEST)),i={method:ct.GetToken,request:o},s=lt.nowSeconds(),g.label=1;case 1:return g.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(i)];case 2:return c=g.sent(),this.validateNativeResponse(c),u=this.handleNativeResponse(c,o,s),this.browserStorage.setInteractionInProgress(!1),[2,u];case 3:throw d=g.sent(),this.browserStorage.setInteractionInProgress(!1),d;case 4:return[2]}})})},e.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},e.prototype.handleNativeResponse=function(t,r,o){return p(this,void 0,void 0,function(){var i,s,c,u,d,g,C,_,N,F,q,de,we,ve,it,$e,gt,Lt,Fe,Bn=this;return O(this,function(mr){switch(mr.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),i=this.getMATSFromResponse(t),this.performanceClient.addStaticFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:i?i.broker_version:void 0,matsAccountJoinOnStart:i?i.account_join_on_start:void 0,matsAccountJoinOnEnd:i?i.account_join_on_end:void 0,matsDeviceJoin:i?i.device_join:void 0,matsPromptBehavior:i?i.prompt_behavior:void 0,matsApiErrorCode:i?i.api_error_code:void 0,matsUiVisible:i?i.ui_visible:void 0,matsSilentCode:i?i.silent_code:void 0,matsSilentBiSubCode:i?i.silent_bi_sub_code:void 0,matsSilentMessage:i?i.silent_message:void 0,matsSilentStatus:i?i.silent_status:void 0,matsHttpStatus:i?i.http_status:void 0,matsHttpEventCount:i?i.http_event_count:void 0},this.correlationId),t.account.id!==r.accountId)throw Tt.createUserSwitchError();return s=new Et(t.id_token||v.EMPTY_STRING,this.browserCrypto),[4,this.getDiscoveredAuthority(r.authority)];case 1:return c=mr.sent(),u=c.getPreferredCache(),d=Ge.generateHomeAccountId(t.client_info||v.EMPTY_STRING,ot.Default,this.logger,this.browserCrypto,s),g=Ge.createAccount(t.client_info,d,s,void 0,void 0,void 0,u,t.account.id),this.browserStorage.setAccount(g),C=Ye.fromString(t.scope?t.scope:r.scope),N=(_=t.account.properties||{}).UID||s.claims.oid||s.claims.sub||v.EMPTY_STRING,F=_.TenantId||s.claims.tid||v.EMPTY_STRING,de=ge.BEARER,r.tokenType===ge.POP?[3,2]:[3,4];case 2:if(de=ge.POP,t.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),q=t.shr,[3,5];if(we=new qt(this.browserCrypto),ve={resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,shrNonce:r.shrNonce},!r.keyId)throw f.createKeyIdMissingError();return[4,we.signPopToken(t.access_token,r.keyId,ve)];case 3:return q=mr.sent(),[3,5];case 4:q=t.access_token,mr.label=5;case 5:return it={authority:c.canonicalAuthority,uniqueId:N,tenantId:F,scopes:C.asArray(),account:g.getAccountInfo(),idToken:t.id_token,idTokenClaims:s.claims,accessToken:q,fromCache:!!i&&this.isResponseFromCache(i),expiresOn:new Date(1e3*Number(o+t.expires_in)),tokenType:de,correlationId:this.correlationId,state:t.state,fromNativeBroker:!0},$e=Xt.createIdTokenEntity(d,r.authority,t.id_token||v.EMPTY_STRING,r.clientId,s.claims.tid||v.EMPTY_STRING),this.nativeStorageManager.setIdTokenCredential($e),gt=de===ge.POP?v.SHR_NONCE_VALIDITY:("string"==typeof t.expires_in?parseInt(t.expires_in,10):t.expires_in)||0,Lt=o+gt,Fe=$t.createAccessTokenEntity(d,r.authority,q,r.clientId,F,C.printScopes(),Lt,0,this.browserCrypto),this.nativeStorageManager.setAccessTokenCredential(Fe),this.browserStorage.removeAccountContext(g).catch(function(Kn){Bn.logger.error("Error occurred while removing account context from browser storage. "+Kn)}),[2,it]}})})},e.prototype.validateNativeResponse=function(t){if(t.hasOwnProperty("access_token")&&t.hasOwnProperty("id_token")&&t.hasOwnProperty("client_info")&&t.hasOwnProperty("account")&&t.hasOwnProperty("scope")&&t.hasOwnProperty("expires_in"))return t;throw Tt.createUnexpectedError("Response missing expected properties.")},e.prototype.getMATSFromResponse=function(t){if(t.properties.MATS)try{return JSON.parse(t.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null},e.prototype.isResponseFromCache=function(t){return typeof t.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!t.is_cached},e.prototype.initializeNativeRequest=function(t){return p(this,void 0,void 0,function(){var o,i,s,c,u,d,g,_,N=this;return O(this,function(F){switch(F.label){case 0:return this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),(o=new Ee(t.authority||this.config.auth.authority)).validateAsUri(),i=t.scopes,s=mt(t,["scopes"]),(c=new Ye(i||[])).appendScopes(fe),u=function(){switch(N.apiId){case Se.ssoSilent:case Se.acquireTokenSilent_silentFlow:return N.logger.trace("initializeNativeRequest: silent request sets prompt to none"),be.NONE}if(t.prompt)switch(t.prompt){case be.NONE:case be.CONSENT:case be.LOGIN:return N.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),t.prompt;default:throw N.logger.trace("initializeNativeRequest: prompt = "+t.prompt+" is not compatible with native flow"),E.createNativePromptParameterNotSupportedError()}else N.logger.trace("initializeNativeRequest: prompt was not provided")},d=D(D({},s),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:o.urlString,scope:c.printScopes(),redirectUri:this.getRedirectUri(t.redirectUri),prompt:u(),correlationId:this.correlationId,tokenType:t.authenticationScheme,windowTitleSubstring:document.title,extraParameters:D(D(D({},t.extraQueryParameters),t.tokenQueryParameters),{telemetry:"MATS"}),extendedExpiryToken:!1}),t.authenticationScheme!==ge.POP?[3,2]:(g={resourceRequestUri:t.resourceRequestUri,resourceRequestMethod:t.resourceRequestMethod,shrClaims:t.shrClaims,shrNonce:t.shrNonce},[4,new qt(this.browserCrypto).generateCnf(g)]);case 1:_=F.sent(),d.reqCnf=_.reqCnfHash,d.keyId=_.kid,F.label=2;case 2:return[2,d]}})})},e}(Kr),xt=function(){function n(e,t,r){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=r,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this)}return n.prototype.sendMessage=function(e){return p(this,void 0,void 0,function(){var t,r=this;return O(this,function(o){return this.logger.trace("NativeMessageHandler - sendMessage called."),t={channel:wt_CHANNEL_ID,extensionId:this.extensionId,responseId:this.responseId++,body:e},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(t)),this.messageChannel.port1.postMessage(t),[2,new Promise(function(i,s){r.resolvers.set(t.responseId,{resolve:i,reject:s})})]})})},n.createProvider=function(e,t){return p(this,void 0,void 0,function(){var r,o;return O(this,function(i){switch(i.label){case 0:e.trace("NativeMessageHandler - createProvider called."),i.label=1;case 1:return i.trys.push([1,3,,5]),[4,(r=new n(e,t,"ppnbnpeolgkicgegkbkbjmhlideopiji")).sendHandshakeRequest()];case 2:return i.sent(),[2,r];case 3:return i.sent(),[4,(o=new n(e,t)).sendHandshakeRequest()];case 4:return i.sent(),[2,o];case 5:return[2]}})})},n.prototype.sendHandshakeRequest=function(){return p(this,void 0,void 0,function(){var e,t=this;return O(this,function(r){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),e={channel:wt_CHANNEL_ID,extensionId:this.extensionId,responseId:this.responseId++,body:{method:ct.HandshakeRequest}},this.messageChannel.port1.onmessage=function(o){t.onChannelMessage(o)},window.postMessage(e,window.origin,[this.messageChannel.port2]),[2,new Promise(function(o,i){t.handshakeResolvers.set(e.responseId,{resolve:o,reject:i}),t.timeoutId=window.setTimeout(function(){window.removeEventListener("message",t.windowListener,!1),t.messageChannel.port1.close(),t.messageChannel.port2.close(),i(E.createNativeHandshakeTimeoutError()),t.handshakeResolvers.delete(e.responseId)},t.handshakeTimeoutMs)})]})})},n.prototype.onWindowMessage=function(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source===window){var t=e.data;if(t.channel&&t.channel===wt_CHANNEL_ID&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===ct.HandshakeRequest){this.logger.verbose(t.extensionId?"Extension with id: "+t.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1);var r=this.handshakeResolvers.get(t.responseId);r&&r.reject(E.createNativeExtensionNotInstalledError())}}},n.prototype.onChannelMessage=function(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var t=e.data,r=this.resolvers.get(t.responseId),o=this.handshakeResolvers.get(t.responseId);try{var i=t.body.method;if(i===ct.Response){if(!r)return;var s=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(s)),"Success"!==s.status)r.reject(Tt.createError(s.code,s.description,s.ext));else{if(!s.result)throw S.createUnexpectedError("Event does not contain result.");s.result.code&&s.result.description?r.reject(Tt.createError(s.result.code,s.result.description,s.result.ext)):r.resolve(s.result)}this.resolvers.delete(t.responseId)}else if(i===ct.HandshakeResponse){if(!o)return;clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),o.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(c){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+c.toString()),this.logger.errorPii("Unable to parse "+e),r?r.reject(c):o&&o.reject(c)}},n.prototype.getExtensionId=function(){return this.extensionId},n.prototype.getExtensionVersion=function(){return this.extensionVersion},n.isNativeAvailable=function(e,t,r,o){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!r)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(o)switch(o){case ge.BEARER:case ge.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},n}(),Rr=function(){function n(e,t,r,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=o}return n.prototype.handleCodeResponseFromHash=function(e,t,r,o){return p(this,void 0,void 0,function(){var i,s,c;return O(this,function(u){if(this.logger.verbose("InteractionHandler.handleCodeResponse called"),y.isEmpty(e))throw E.createEmptyHashError(e);if(i=this.browserStorage.generateStateKey(t),!(s=this.browserStorage.getTemporaryCache(i)))throw f.createStateNotFoundError("Cached State");try{c=this.authModule.handleFragmentResponse(e,s)}catch(d){throw d instanceof Q&&d.subError===m_userCancelledError_code?E.createUserCancelledError():d}return[2,this.handleCodeResponseFromServer(c,t,r,o)]})})},n.prototype.handleCodeResponseFromServer=function(e,t,r,o,i){return void 0===i&&(i=!0),p(this,void 0,void 0,function(){var s,c,u,d,g,C;return O(this,function(_){switch(_.label){case 0:if(this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),s=this.browserStorage.generateStateKey(t),!(c=this.browserStorage.getTemporaryCache(s)))throw f.createStateNotFoundError("Cached State");return u=this.browserStorage.generateNonceKey(c),d=this.browserStorage.getTemporaryCache(u),this.authCodeRequest.code=e.code,e.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(e.cloud_instance_host_name,r,o)]:[3,2];case 1:_.sent(),_.label=2;case 2:return i&&(e.nonce=d||void 0),e.state=c,e.client_info?this.authCodeRequest.clientInfo=e.client_info:(g=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=g),[4,this.authModule.acquireToken(this.authCodeRequest,e)];case 3:return C=_.sent(),this.browserStorage.cleanRequestByState(t),[2,C]}})})},n.prototype.updateTokenEndpointAuthority=function(e,t,r){return p(this,void 0,void 0,function(){var i;return O(this,function(s){switch(s.label){case 0:return[4,gr.createDiscoveredInstance("https://"+e+"/"+t.tenant+"/",r,this.browserStorage,t.options,this.logger)];case 1:return i=s.sent(),this.authModule.updateAuthority(i),[2]}})})},n.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(pe.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},n}(),In=function(n){function e(t,r,o,i,s,c,u,d,g,C){var _=n.call(this,t,r,o,i,s,c,u,g,C)||this;return _.unloadWindow=_.unloadWindow.bind(_),_.nativeStorage=d,_}return he(e,n),e.prototype.acquireToken=function(t){try{var r=this.generatePopupName(t.scopes||fe,t.authority||this.config.auth.authority),o=t.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(t,r,o);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var i=this.openSizedPopup("about:blank",r,o);return this.acquireTokenPopupAsync(t,r,o,i)}catch(s){return Promise.reject(s)}},e.prototype.logout=function(t){try{this.logger.verbose("logoutPopup called");var r=this.initializeLogoutRequest(t),o=this.generateLogoutPopupName(r),i=t&&t.authority,s=t&&t.mainWindowRedirectUri,c=t?.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(r,o,c,i,void 0,s);this.logger.verbose("asyncPopup set to false, opening popup");var u=this.openSizedPopup("about:blank",o,c);return this.logoutPopupAsync(r,o,c,i,u,s)}catch(d){return Promise.reject(d)}},e.prototype.acquireTokenPopupAsync=function(t,r,o,i){return p(this,void 0,void 0,function(){var s,c,u,d,g,C,_,N,q,de,te,we,ve,it,gt,Lt=this;return O(this,function(Fe){switch(Fe.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),s=this.initializeServerTelemetryManager(Se.acquireTokenPopup),[4,this.initializeAuthorizationRequest(t,V.Popup)];case 1:c=Fe.sent(),this.browserStorage.updateCacheEntries(c.state,c.nonce,c.authority,c.loginHint||v.EMPTY_STRING,c.account||null),Fe.label=2;case 2:return Fe.trys.push([2,8,,9]),[4,this.initializeAuthorizationCodeRequest(c)];case 3:return u=Fe.sent(),[4,this.createAuthCodeClient(s,c.authority,c.azureCloudOptions)];case 4:return d=Fe.sent(),this.logger.verbose("Auth code client created"),g=xt.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme),C=void 0,g&&(C=this.performanceClient.startMeasurement(ue.FetchAccountIdWithNativeBroker,t.correlationId)),[4,d.getAuthCodeUrl(D(D({},c),{nativeBroker:g}))];case 5:return _=Fe.sent(),N=new Rr(d,this.browserStorage,u,this.logger),q=this.initiateAuthRequest(_,{popup:i,popupName:r,popupWindowAttributes:o}),this.eventHandler.emitEvent(re.POPUP_OPENED,V.Popup,{popupWindow:q},null),[4,this.monitorPopupForHash(q)];case 6:if(de=Fe.sent(),te=Ee.getDeserializedHash(de),we=this.validateAndExtractStateFromHash(te,V.Popup,c.correlationId),ur.removeThrottle(this.browserStorage,this.config.auth.clientId,u),te.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),C&&C.endMeasurement({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw E.createNativeConnectionNotEstablishedError();return ve=new Yt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Se.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,te.accountId,this.nativeStorage,c.correlationId),it=It.parseRequestState(this.browserCrypto,we).userRequestState,[2,ve.acquireToken(D(D({},c),{state:it,prompt:void 0})).finally(function(){Lt.browserStorage.cleanRequestByState(we)})]}return[4,N.handleCodeResponseFromHash(de,we,d.authority,this.networkClient)];case 7:return[2,Fe.sent()];case 8:throw gt=Fe.sent(),i&&i.close(),gt instanceof S&&gt.setCorrelationId(this.correlationId),s.cacheFailedRequest(gt),this.browserStorage.cleanRequestByState(c.state),gt;case 9:return[2]}})})},e.prototype.logoutPopupAsync=function(t,r,o,i,s,c){return p(this,void 0,void 0,function(){var u,d,g,C,_,N,F;return O(this,function(q){switch(q.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(re.LOGOUT_START,V.Popup,t),u=this.initializeServerTelemetryManager(Se.logoutPopup),q.label=1;case 1:return q.trys.push([1,5,,6]),[4,this.clearCacheOnLogout(t.account)];case 2:return q.sent(),[4,this.createAuthCodeClient(u,i)];case 3:return d=q.sent(),this.logger.verbose("Auth code client created"),g=d.getLogoutUri(t),this.eventHandler.emitEvent(re.LOGOUT_SUCCESS,V.Popup,t),C=this.openPopup(g,{popupName:r,popupWindowAttributes:o,popup:s}),this.eventHandler.emitEvent(re.POPUP_OPENED,V.Popup,{popupWindow:C},null),[4,this.waitForLogoutPopup(C)];case 4:return q.sent(),c?(_={apiId:Se.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},N=Ee.getAbsoluteUrl(c,Ne.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+N),this.navigationClient.navigateInternal(N,_)):this.logger.verbose("No main window navigation requested"),[3,6];case 5:throw F=q.sent(),s&&s.close(),F instanceof S&&F.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(re.LOGOUT_FAILURE,V.Popup,null,F),this.eventHandler.emitEvent(re.LOGOUT_END,V.Popup),u.cacheFailedRequest(F),F;case 6:return this.eventHandler.emitEvent(re.LOGOUT_END,V.Popup),[2]}})})},e.prototype.initiateAuthRequest=function(t,r){if(y.isEmpty(t))throw this.logger.error("Navigate url is empty"),E.createEmptyNavigationUriError();return this.logger.infoPii("Navigate to: "+t),this.openPopup(t,r)},e.prototype.monitorPopupForHash=function(t){var r=this;return new Promise(function(o,i){var s=r.config.system.windowHashTimeout/r.config.system.pollIntervalMilliseconds,c=0;r.logger.verbose("PopupHandler.monitorPopupForHash - polling started");var u=setInterval(function(){if(t.closed)return r.logger.error("PopupHandler.monitorPopupForHash - window closed"),r.cleanPopup(),clearInterval(u),void i(E.createUserCancelledError());var d=v.EMPTY_STRING,g=v.EMPTY_STRING;try{d=t.location.href,g=t.location.hash}catch{}y.isEmpty(d)||"about:blank"===d||(r.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),c++,g?(r.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(u),r.cleanPopup(t),Ee.hashContainsKnownProperties(g)?(r.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),o(g)):(r.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),r.logger.errorPii("PopupHandler.monitorPopupForHash - hash found: "+g),i(E.createHashDoesNotContainKnownPropertiesError()))):c>s&&(r.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(u),i(E.createMonitorPopupTimeoutError())))},r.config.system.pollIntervalMilliseconds)})},e.prototype.waitForLogoutPopup=function(t){var r=this;return new Promise(function(o){r.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");var i=setInterval(function(){t.closed&&(r.logger.error("PopupHandler.waitForLogoutPopup - window closed"),r.cleanPopup(),clearInterval(i),o());var s=v.EMPTY_STRING;try{s=t.location.href}catch{}y.isEmpty(s)||"about:blank"===s||(r.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(i),r.cleanPopup(t),o())},r.config.system.pollIntervalMilliseconds)})},e.prototype.openPopup=function(t,r){try{var o=void 0;if(r.popup?(o=r.popup,this.logger.verbosePii("Navigating popup window to: "+t),o.location.assign(t)):typeof r.popup>"u"&&(this.logger.verbosePii("Opening popup window to: "+t),o=this.openSizedPopup(t,r.popupName,r.popupWindowAttributes)),!o)throw E.createEmptyWindowCreatedError();return o.focus&&o.focus(),this.currentWindow=o,window.addEventListener("beforeunload",this.unloadWindow),o}catch(i){throw this.logger.error("error opening popup "+i.message),this.browserStorage.setInteractionInProgress(!1),E.createPopupWindowError(i.toString())}},e.prototype.openSizedPopup=function(t,r,o){var i,s,c,u,d=window.screenLeft?window.screenLeft:window.screenX,g=window.screenTop?window.screenTop:window.screenY,C=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,_=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,N=null===(i=o.popupSize)||void 0===i?void 0:i.width,F=null===(s=o.popupSize)||void 0===s?void 0:s.height,q=null===(c=o.popupPosition)||void 0===c?void 0:c.top,de=null===(u=o.popupPosition)||void 0===u?void 0:u.left;return(!N||N<0||N>C)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),N=483),(!F||F<0||F>_)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),F=600),(!q||q<0||q>_)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),q=Math.max(0,_/2-300+g)),(!de||de<0||de>C)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),de=Math.max(0,C/2-241.5+d)),window.open(t,r,"width="+N+", height="+F+", top="+q+", left="+de+", scrollbars=yes")},e.prototype.unloadWindow=function(t){this.browserStorage.cleanRequestByInteractionType(V.Popup),this.currentWindow&&this.currentWindow.close(),t.preventDefault()},e.prototype.cleanPopup=function(t){t&&t.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},e.prototype.generatePopupName=function(t,r){return"msal."+this.config.auth.clientId+"."+t.join("-")+"."+r+"."+this.correlationId},e.prototype.generateLogoutPopupName=function(t){return"msal."+this.config.auth.clientId+"."+(t.account&&t.account.homeAccountId)+"."+this.correlationId},e}(Vt),jr=function(n){function e(t,r,o,i,s){var c=n.call(this,t,r,o,i)||this;return c.browserCrypto=s,c}return he(e,n),e.prototype.initiateAuthRequest=function(t,r){return p(this,void 0,void 0,function(){var o;return O(this,function(s){switch(s.label){case 0:return this.logger.verbose("RedirectHandler.initiateAuthRequest called"),y.isEmpty(t)?[3,7]:(r.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(pe.ORIGIN_URI,r.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(pe.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+t),o={apiId:Se.acquireTokenRedirect,timeout:r.redirectTimeout,noHistory:!1},"function"!=typeof r.onRedirectNavigate?[3,4]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===r.onRedirectNavigate(t)?[3,2]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,r.navigationClient.navigateExternal(t,o)])));case 1:case 5:return s.sent(),[2];case 2:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,r.navigationClient.navigateExternal(t,o)];case 6:return[3,8];case 7:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),E.createEmptyNavigationUriError();case 8:return[2]}})})},e.prototype.handleCodeResponseFromHash=function(t,r,o,i){return p(this,void 0,void 0,function(){var s,c,u,d,g,C,_;return O(this,function(N){switch(N.label){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),y.isEmpty(t))throw E.createEmptyHashError(t);if(this.browserStorage.setInteractionInProgress(!1),s=this.browserStorage.generateStateKey(r),!(c=this.browserStorage.getTemporaryCache(s)))throw f.createStateNotFoundError("Cached State");try{u=this.authModule.handleFragmentResponse(t,c)}catch(F){throw F instanceof Q&&F.subError===m_userCancelledError_code?E.createUserCancelledError():F}return d=this.browserStorage.generateNonceKey(c),g=this.browserStorage.getTemporaryCache(d),this.authCodeRequest.code=u.code,u.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(u.cloud_instance_host_name,o,i)]:[3,2];case 1:N.sent(),N.label=2;case 2:return u.nonce=g||void 0,u.state=c,u.client_info?this.authCodeRequest.clientInfo=u.client_info:(C=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=C),[4,this.authModule.acquireToken(this.authCodeRequest,u)];case 3:return _=N.sent(),this.browserStorage.cleanRequestByState(r),[2,_]}})})},e}(Rr),An=function(n){function e(t,r,o,i,s,c,u,d,g,C){var _=n.call(this,t,r,o,i,s,c,u,g,C)||this;return _.nativeStorage=d,_}return he(e,n),e.prototype.acquireToken=function(t){return p(this,void 0,void 0,function(){var r,o,i,s,c,u,d,g,C,_=this;return O(this,function(N){switch(N.label){case 0:return[4,this.initializeAuthorizationRequest(t,V.Redirect)];case 1:r=N.sent(),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||v.EMPTY_STRING,r.account||null),o=this.initializeServerTelemetryManager(Se.acquireTokenRedirect),i=function(F){F.persisted&&(_.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),_.browserStorage.cleanRequestByState(r.state))},N.label=2;case 2:return N.trys.push([2,7,,8]),[4,this.initializeAuthorizationCodeRequest(r)];case 3:return s=N.sent(),[4,this.createAuthCodeClient(o,r.authority,r.azureCloudOptions)];case 4:return c=N.sent(),this.logger.verbose("Auth code client created"),u=new jr(c,this.browserStorage,s,this.logger,this.browserCrypto),[4,c.getAuthCodeUrl(D(D({},r),{nativeBroker:xt.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}))];case 5:return d=N.sent(),g=this.getRedirectStartPage(t.redirectStartPage),this.logger.verbosePii("Redirect start page: "+g),window.addEventListener("pageshow",i),[4,u.initiateAuthRequest(d,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:g,onRedirectNavigate:t.onRedirectNavigate})];case 6:return[2,N.sent()];case 7:throw(C=N.sent())instanceof S&&C.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",i),o.cacheFailedRequest(C),this.browserStorage.cleanRequestByState(r.state),C;case 8:return[2]}})})},e.prototype.handleRedirectPromise=function(t){return p(this,void 0,void 0,function(){var r,o,i,s,c,u,d,g,C,_,N,F;return O(this,function(q){switch(q.label){case 0:r=this.initializeServerTelemetryManager(Se.handleRedirectPromise),q.label=1;case 1:if(q.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(o=this.getRedirectResponseHash(t||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(V.Redirect),[2,null];i=void 0;try{s=Ee.getDeserializedHash(o),i=this.validateAndExtractStateFromHash(s,V.Redirect),this.logger.verbose("State extracted from hash")}catch(de){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+de),this.browserStorage.cleanRequestByInteractionType(V.Redirect),[2,null]}return c=this.browserStorage.getTemporaryCache(pe.ORIGIN_URI,!0)||v.EMPTY_STRING,u=Ee.removeHashFromUrl(c),d=Ee.removeHashFromUrl(window.location.href),u===d&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(o,i,r)]):[3,3];case 2:return g=q.sent(),c.indexOf("#")>-1&&Ne.replaceHash(c),[2,g];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(o,i,r)]);case 4:return!Ne.isInIframe()||this.config.system.allowRedirectInIframe?(this.browserStorage.setTemporaryCache(pe.URL_HASH,o,!0),C={apiId:Se.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},_=!0,c&&"null"!==c?[3,6]:(N=Ne.getHomepage(),this.browserStorage.setTemporaryCache(pe.ORIGIN_URI,N,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(N,C)])):[3,9];case 5:return _=q.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+c),[4,this.navigationClient.navigateInternal(c,C)];case 7:_=q.sent(),q.label=8;case 8:if(!_)return[2,this.handleHash(o,i,r)];q.label=9;case 9:return[2,null];case 10:throw(F=q.sent())instanceof S&&F.setCorrelationId(this.correlationId),r.cacheFailedRequest(F),this.browserStorage.cleanRequestByInteractionType(V.Redirect),F;case 11:return[2]}})})},e.prototype.getRedirectResponseHash=function(t){if(this.logger.verbose("getRedirectResponseHash called"),Ee.hashContainsKnownProperties(t))return Ne.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),t;var o=this.browserStorage.getTemporaryCache(pe.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(pe.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),o},e.prototype.handleHash=function(t,r,o){return p(this,void 0,void 0,function(){var i,s,c,u,d,g,_=this;return O(this,function(N){switch(N.label){case 0:if(i=this.browserStorage.getCachedRequest(r,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),(s=Ee.getDeserializedHash(t)).accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw E.createNativeConnectionNotEstablishedError();return c=new Yt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Se.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,s.accountId,this.browserStorage,i.correlationId),u=It.parseRequestState(this.browserCrypto,r).userRequestState,[2,c.acquireToken(D(D({},i),{state:u,prompt:void 0})).finally(function(){_.browserStorage.cleanRequestByState(r)})]}if(!(d=this.browserStorage.getCachedAuthority(r)))throw E.createNoCachedAuthorityError();return[4,this.createAuthCodeClient(o,d)];case 1:return g=N.sent(),this.logger.verbose("Auth code client created"),ur.removeThrottle(this.browserStorage,this.config.auth.clientId,i),[4,new jr(g,this.browserStorage,i,this.logger,this.browserCrypto).handleCodeResponseFromHash(t,r,g.authority,this.networkClient)];case 2:return[2,N.sent()]}})})},e.prototype.logout=function(t){return p(this,void 0,void 0,function(){var r,o,i,s,c,d;return O(this,function(g){switch(g.label){case 0:this.logger.verbose("logoutRedirect called"),r=this.initializeLogoutRequest(t),o=this.initializeServerTelemetryManager(Se.logout),g.label=1;case 1:return g.trys.push([1,10,,11]),this.eventHandler.emitEvent(re.LOGOUT_START,V.Redirect,t),[4,this.clearCacheOnLogout(r.account)];case 2:return g.sent(),i={apiId:Se.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},[4,this.createAuthCodeClient(o,t&&t.authority)];case 3:return s=g.sent(),this.logger.verbose("Auth code client created"),c=s.getLogoutUri(r),this.eventHandler.emitEvent(re.LOGOUT_SUCCESS,V.Redirect,r),t&&"function"==typeof t.onRedirectNavigate?!1===t.onRedirectNavigate(c)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(c,i)]):[3,7];case 4:return g.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),g.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(c,i)];case 8:return g.sent(),[2];case 9:return[3,11];case 10:throw(d=g.sent())instanceof S&&d.setCorrelationId(this.correlationId),o.cacheFailedRequest(d),this.eventHandler.emitEvent(re.LOGOUT_FAILURE,V.Redirect,null,d),this.eventHandler.emitEvent(re.LOGOUT_END,V.Redirect),d;case 11:return this.eventHandler.emitEvent(re.LOGOUT_END,V.Redirect),[2]}})})},e.prototype.getRedirectStartPage=function(t){var r=t||window.location.href;return Ee.getAbsoluteUrl(r,Ne.getCurrentUri())},e}(Vt),qr=function(n){function e(t,r,o,i,s){var c=n.call(this,t,r,o,i)||this;return c.navigateFrameWait=s.navigateFrameWait,c.pollIntervalMilliseconds=s.pollIntervalMilliseconds,c}return he(e,n),e.prototype.initiateAuthRequest=function(t){return p(this,void 0,void 0,function(){var r;return O(this,function(o){switch(o.label){case 0:if(y.isEmpty(t))throw this.logger.info("Navigate url is empty"),E.createEmptyNavigationUriError();return this.navigateFrameWait?[4,this.loadFrame(t)]:[3,2];case 1:return r=o.sent(),[3,3];case 2:r=this.loadFrameSync(t),o.label=3;case 3:return[2,r]}})})},e.prototype.monitorIframeForHash=function(t,r){var o=this;return new Promise(function(i,s){r<6e3&&o.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+r+"ms) than the default (6000ms). This may result in timeouts.");var u=window.performance.now()+r,d=setInterval(function(){if(window.performance.now()>u)return o.removeHiddenIframe(t),clearInterval(d),void s(E.createMonitorIframeTimeoutError());var g=v.EMPTY_STRING,C=t.contentWindow;try{g=C?C.location.href:v.EMPTY_STRING}catch{}if(!y.isEmpty(g)){var _=C?C.location.hash:v.EMPTY_STRING;if(Ee.hashContainsKnownProperties(_))return o.removeHiddenIframe(t),clearInterval(d),void i(_)}},o.pollIntervalMilliseconds)})},e.prototype.loadFrame=function(t){var r=this;return new Promise(function(o,i){var s=r.createHiddenIframe();setTimeout(function(){s?(s.src=t,o(s)):i("Unable to load iframe")},r.navigateFrameWait)})},e.prototype.loadFrameSync=function(t){var r=this.createHiddenIframe();return r.src=t,r},e.prototype.createHiddenIframe=function(){var t=document.createElement("iframe");return t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height="0",t.style.border="0",t.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(t),t},e.prototype.removeHiddenIframe=function(t){document.body===t.parentNode&&document.body.removeChild(t)},e}(Rr),Rn=function(n){function e(t,r,o,i,s,c,u,d,g,C,_){var N=n.call(this,t,r,o,i,s,c,d,C,_)||this;return N.apiId=u,N.nativeStorage=g,N}return he(e,n),e.prototype.acquireToken=function(t){return p(this,void 0,void 0,function(){var r,o,i,s,c;return O(this,function(u){switch(u.label){case 0:if(this.logger.verbose("acquireTokenByIframe called"),r=this.performanceClient.startMeasurement(ue.SilentIframeClientAcquireToken,t.correlationId),y.isEmpty(t.loginHint)&&y.isEmpty(t.sid)&&(!t.account||y.isEmpty(t.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),t.prompt&&t.prompt!==be.NONE&&t.prompt!==be.NO_SESSION)throw r.endMeasurement({success:!1}),E.createSilentPromptValueError(t.prompt);return[4,this.initializeAuthorizationRequest(D(D({},t),{prompt:t.prompt||be.NONE}),V.Silent)];case 1:o=u.sent(),this.browserStorage.updateCacheEntries(o.state,o.nonce,o.authority,o.loginHint||v.EMPTY_STRING,o.account||null),i=this.initializeServerTelemetryManager(this.apiId),u.label=2;case 2:return u.trys.push([2,5,,6]),[4,this.createAuthCodeClient(i,o.authority,o.azureCloudOptions)];case 3:return s=u.sent(),this.logger.verbose("Auth code client created"),[4,this.silentTokenHelper(s,o).then(function(d){return r.endMeasurement({success:!0,fromCache:!1,requestId:d.requestId}),d})];case 4:return[2,u.sent()];case 5:throw(c=u.sent())instanceof S&&c.setCorrelationId(this.correlationId),i.cacheFailedRequest(c),this.browserStorage.cleanRequestByState(o.state),r.endMeasurement({errorCode:c instanceof S&&c.errorCode||void 0,subErrorCode:c instanceof S&&c.subError||void 0,success:!1}),c;case 6:return[2]}})})},e.prototype.logout=function(){return Promise.reject(E.createSilentLogoutUnsupportedError())},e.prototype.silentTokenHelper=function(t,r){return p(this,void 0,void 0,function(){var o,i,s,c,u,d,g,C,_,N=this;return O(this,function(F){switch(F.label){case 0:return[4,this.initializeAuthorizationCodeRequest(r)];case 1:return o=F.sent(),[4,t.getAuthCodeUrl(D(D({},r),{nativeBroker:xt.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,r.authenticationScheme)}))];case 2:return i=F.sent(),[4,(s=new qr(t,this.browserStorage,o,this.logger,this.config.system)).initiateAuthRequest(i)];case 3:return c=F.sent(),[4,s.monitorIframeForHash(c,this.config.system.iframeHashTimeout)];case 4:if(u=F.sent(),d=Ee.getDeserializedHash(u),g=this.validateAndExtractStateFromHash(d,V.Silent,o.correlationId),d.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw E.createNativeConnectionNotEstablishedError();return C=new Yt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,d.accountId,this.browserStorage,this.correlationId),_=It.parseRequestState(this.browserCrypto,g).userRequestState,[2,C.acquireToken(D(D({},r),{state:_,prompt:r.prompt||be.NONE})).finally(function(){N.browserStorage.cleanRequestByState(g)})]}return[2,s.handleCodeResponseFromHash(u,g,t.authority,this.networkClient)]}})})},e}(Vt),bn=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return he(e,n),e.prototype.acquireToken=function(t){return p(this,void 0,void 0,function(){var r,o,i,s,c,u=this;return O(this,function(d){switch(d.label){case 0:return o=[D({},t)],[4,this.initializeBaseRequest(t)];case 1:return r=D.apply(void 0,o.concat([d.sent()])),i=this.performanceClient.startMeasurement(ue.SilentRefreshClientAcquireToken,r.correlationId),s=this.initializeServerTelemetryManager(Se.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(s,r.authority,r.azureCloudOptions)];case 2:return c=d.sent(),this.logger.verbose("Refresh token client created"),[2,c.acquireTokenByRefreshToken(r).then(function(g){return i.endMeasurement({success:!0,fromCache:g.fromCache,requestId:g.requestId}),g}).catch(function(g){throw g instanceof S&&g.setCorrelationId(u.correlationId),s.cacheFailedRequest(g),i.endMeasurement({errorCode:g.errorCode,subErrorCode:g.subError,success:!1}),g})]}})})},e.prototype.logout=function(){return Promise.reject(E.createSilentLogoutUnsupportedError())},e.prototype.createRefreshTokenClient=function(t,r,o){return p(this,void 0,void 0,function(){var i;return O(this,function(s){switch(s.label){case 0:return[4,this.getClientConfiguration(t,r,o)];case 1:return i=s.sent(),[2,new Gr(i,this.performanceClient)]}})})},e}(Vt),kn=function(){function n(e,t,r,o){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=t,this.logger=r,this.cryptoObj=o}return n.prototype.loadExternalTokens=function(e,t,r){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw E.createUnableToLoadTokenError("Please ensure server response includes id token.");var i,s,o=new Et(t.id_token,this.cryptoObj);if(e.account){var c=this.loadAccount(o,e.account.environment,void 0,void 0,e.account.homeAccountId);i=new dr(c,this.loadIdToken(o,c.homeAccountId,e.account.environment,e.account.tenantId),this.loadAccessToken(e,t,c.homeAccountId,e.account.environment,e.account.tenantId,r),this.loadRefreshToken(e,t,c.homeAccountId,e.account.environment))}else{if(!e.authority)throw E.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var u=fr.generateAuthority(e.authority,e.azureCloudOptions);if(s=new fr(u,this.config.system.networkClient,this.storage,{protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},this.logger),r.clientInfo)this.logger.trace("TokenCache - homeAccountId from options"),c=this.loadAccount(o,s.hostnameAndPort,r.clientInfo,s.authorityType),i=new dr(c,this.loadIdToken(o,c.homeAccountId,s.hostnameAndPort,s.tenant),this.loadAccessToken(e,t,c.homeAccountId,s.hostnameAndPort,s.tenant,r),this.loadRefreshToken(e,t,c.homeAccountId,s.hostnameAndPort));else{if(!t.client_info)throw E.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response"),c=this.loadAccount(o,s.hostnameAndPort,t.client_info,s.authorityType),i=new dr(c,this.loadIdToken(o,c.homeAccountId,s.hostnameAndPort,s.tenant),this.loadAccessToken(e,t,c.homeAccountId,s.hostnameAndPort,s.tenant,r),this.loadRefreshToken(e,t,c.homeAccountId,s.hostnameAndPort))}}return this.generateAuthenticationResult(e,o,i,s)},n.prototype.loadAccount=function(e,t,r,o,i){var s;if(i?s=i:void 0!==o&&r&&(s=Ge.generateHomeAccountId(r,o,this.logger,this.cryptoObj,e)),!s)throw E.createUnableToLoadTokenError("Unexpected missing homeAccountId");var c=r?Ge.createAccount(r,s,e,void 0,void 0,void 0,t):Ge.createGenericAccount(s,e,void 0,void 0,void 0,t);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(c),c;throw E.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},n.prototype.loadIdToken=function(e,t,r,o){var i=Xt.createIdTokenEntity(t,r,e.rawToken,this.config.auth.clientId,o);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(i),i;throw E.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},n.prototype.loadAccessToken=function(e,t,r,o,i,s){if(!t.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!t.expires_in)throw E.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!s.extendedExpiresOn)throw E.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var c=new Ye(e.scopes).printScopes(),u=s.expiresOn||t.expires_in+(new Date).getTime()/1e3,g=$t.createAccessTokenEntity(r,o,t.access_token,this.config.auth.clientId,i,c,u,s.extendedExpiresOn,this.cryptoObj);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(g),g;throw E.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},n.prototype.loadRefreshToken=function(e,t,r,o){if(!t.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;var i=cr.createRefreshTokenEntity(r,o,t.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(i),i;throw E.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},n.prototype.generateAuthenticationResult=function(e,t,r,o){var i,s,c,C,u=v.EMPTY_STRING,d=[],g=null;return r?.accessToken&&(u=r.accessToken.secret,d=Ye.fromString(r.accessToken.target).asArray(),g=new Date(1e3*Number(r.accessToken.expiresOn)),C=new Date(1e3*Number(r.accessToken.extendedExpiresOn))),{authority:o?o.canonicalAuthority:v.EMPTY_STRING,uniqueId:t?.claims.oid||t?.claims.sub||v.EMPTY_STRING,tenantId:t?.claims.tid||v.EMPTY_STRING,scopes:d,account:r?.account?r.account.getAccountInfo():null,idToken:t?t.rawToken:v.EMPTY_STRING,idTokenClaims:t?t.claims:{},accessToken:u,fromCache:!0,expiresOn:g,correlationId:e.correlationId||v.EMPTY_STRING,requestId:v.EMPTY_STRING,extExpiresOn:C,familyId:v.EMPTY_STRING,tokenType:(null===(i=r?.accessToken)||void 0===i?void 0:i.tokenType)||v.EMPTY_STRING,state:v.EMPTY_STRING,cloudGraphHostName:(null===(s=r?.account)||void 0===s?void 0:s.cloudGraphHostName)||v.EMPTY_STRING,msGraphHost:(null===(c=r?.account)||void 0===c?void 0:c.msGraphHost)||v.EMPTY_STRING,code:void 0,fromNativeBroker:!1}},n}(),Nn=function(n){function e(t){var r=n.call(this,t)||this;return r.includeRedirectUri=!1,r}return he(e,n),e}(Hr),On=function(n){function e(t,r,o,i,s,c,u,d,g,C){var _=n.call(this,t,r,o,i,s,c,d,g,C)||this;return _.apiId=u,_}return he(e,n),e.prototype.acquireToken=function(t){return p(this,void 0,void 0,function(){var r,o,i,s,c,d;return O(this,function(g){switch(g.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!t.code)throw E.createAuthCodeRequiredError();return[4,this.initializeAuthorizationRequest(t,V.Silent)];case 1:r=g.sent(),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||v.EMPTY_STRING,r.account||null),o=this.initializeServerTelemetryManager(this.apiId),g.label=2;case 2:return g.trys.push([2,4,,5]),i=D(D({},r),{code:t.code}),[4,this.getClientConfiguration(o,r.authority)];case 3:return s=g.sent(),c=new Nn(s),this.logger.verbose("Auth code client created"),[2,new qr(c,this.browserStorage,i,this.logger,this.config.system).handleCodeResponseFromServer({code:t.code,msgraph_host:t.msGraphHost,cloud_graph_host_name:t.cloudGraphHostName,cloud_instance_host_name:t.cloudInstanceHostName},r.state,c.authority,this.networkClient,!1)];case 4:throw(d=g.sent())instanceof S&&d.setCorrelationId(this.correlationId),o.cacheFailedRequest(d),this.browserStorage.cleanRequestByState(r.state),d;case 5:return[2]}})})},e.prototype.logout=function(){return Promise.reject(E.createSilentLogoutUnsupportedError())},e}(Vt),Pn=function(){function n(e,t){this.correlationId=t,this.measureName="msal.measure."+e+"."+this.correlationId,this.startMark="msal.start."+e+"."+this.correlationId,this.endMark="msal.end."+e+"."+this.correlationId}return n.supportsBrowserPerformance=function(){return typeof window<"u"&&typeof window.performance<"u"&&"function"==typeof window.performance.mark&&"function"==typeof window.performance.measure&&"function"==typeof window.performance.clearMarks&&"function"==typeof window.performance.clearMeasures&&"function"==typeof window.performance.getEntriesByName},n.prototype.startMeasurement=function(){if(n.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch{}},n.prototype.endMeasurement=function(){if(n.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch{}},n.prototype.flushMeasurement=function(){if(n.supportsBrowserPerformance())try{var e=window.performance.getEntriesByName(this.measureName,"measure");if(e.length>0){var t=e[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),t}}catch{}return null},n}(),Mn=function(n){function e(t,r,o,i,s,c,u){var d=n.call(this,t,r,o,i,s,c)||this;return d.browserCrypto=new me(d.logger,u),d.guidGenerator=new Tr(d.browserCrypto),d}return he(e,n),e.prototype.startPerformanceMeasuremeant=function(t,r){return new Pn(t,r)},e.prototype.generateId=function(){return this.guidGenerator.generateGuid()},e.prototype.getPageVisibility=function(){var t;return(null===(t=document.visibilityState)||void 0===t?void 0:t.toString())||null},e.prototype.startMeasurement=function(t,r){var o=this,i=this.getPageVisibility(),s=n.prototype.startMeasurement.call(this,t,r);return D(D({},s),{endMeasurement:function(c){return s.endMeasurement(D({startPageVisibility:i,endPageVisibility:o.getPageVisibility()},c))}})},e}(Or),xn=function(n){function e(t){var r=n.call(this,t)||this;return r.activeSilentTokenRequests=new Map,r}return he(e,n),e.prototype.loginRedirect=function(t){return p(this,void 0,void 0,function(){var r;return O(this,function(o){return r=this.getRequestCorrelationId(t),this.logger.verbose("loginRedirect called",r),[2,this.acquireTokenRedirect(D({correlationId:r},t||rr))]})})},e.prototype.loginPopup=function(t){var r=this.getRequestCorrelationId(t);return this.logger.verbose("loginPopup called",r),this.acquireTokenPopup(D({correlationId:r},t||rr))},e.prototype.acquireTokenSilent=function(t){return p(this,void 0,void 0,function(){var r,o,i,c,u,d,g=this;return O(this,function(C){if(r=this.getRequestCorrelationId(t),(o=this.performanceClient.startMeasurement(ue.AcquireTokenSilent,r)).addStaticFields({cacheLookupPolicy:t.cacheLookupPolicy}),this.preflightBrowserEnvironmentCheck(V.Silent),this.logger.verbose("acquireTokenSilent called",r),!(i=t.account||this.getActiveAccount()))throw E.createNoAccountError();return c=JSON.stringify({clientId:this.config.auth.clientId,authority:t.authority||v.EMPTY_STRING,scopes:t.scopes,homeAccountIdentifier:i.homeAccountId,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid}),typeof(u=this.activeSilentTokenRequests.get(c))>"u"?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",r),d=this.acquireTokenSilentAsync(D(D({},t),{correlationId:r}),i).then(function(_){return g.activeSilentTokenRequests.delete(c),o.addStaticFields({accessTokenSize:_.accessToken.length,idTokenSize:_.idToken.length}),o.endMeasurement({success:!0,fromCache:_.fromCache,isNativeBroker:_.fromNativeBroker,requestId:_.requestId}),o.flushMeasurement(),_}).catch(function(_){throw g.activeSilentTokenRequests.delete(c),o.endMeasurement({errorCode:_.errorCode,subErrorCode:_.subError,success:!1}),o.flushMeasurement(),_}),this.activeSilentTokenRequests.set(c,d),[2,d]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",r),o.endMeasurement({success:!0}),o.discardMeasurement(),[2,u])})})},e.prototype.acquireTokenSilentAsync=function(t,r){return p(this,void 0,void 0,function(){var o,i,s,c,u,d,g=this;return O(this,function(C){switch(C.label){case 0:return this.eventHandler.emitEvent(re.ACQUIRE_TOKEN_START,V.Silent,t),o=this.performanceClient.startMeasurement(ue.AcquireTokenSilentAsync,t.correlationId),xt.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,t.authenticationScheme)&&r.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),s=D(D({},t),{account:r}),i=this.acquireTokenNative(s,Se.acquireTokenSilent_silentFlow).catch(function(_){return p(g,void 0,void 0,function(){return O(this,function(F){if(_ instanceof Tt&&_.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,[2,this.createSilentIframeClient(t.correlationId).acquireToken(t)];throw _})})}),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),[4,(c=this.createSilentCacheClient(t.correlationId)).initializeSilentRequest(t,r)];case 2:u=C.sent(),d=D(D({},t),{cacheLookupPolicy:t.cacheLookupPolicy||Ke.Default}),i=this.acquireTokenFromCache(c,u,d).catch(function(_){if(d.cacheLookupPolicy===Ke.AccessToken)throw _;return Ne.blockReloadInHiddenIframes(),g.eventHandler.emitEvent(re.ACQUIRE_TOKEN_NETWORK_START,V.Silent,u),g.acquireTokenByRefreshToken(u,d).catch(function(N){if((!(N instanceof Q)||"invalid_grant"!==N.errorCode||N instanceof Be||d.cacheLookupPolicy===Ke.AccessTokenAndRefreshToken||d.cacheLookupPolicy===Ke.RefreshToken)&&d.cacheLookupPolicy!==Ke.Skip)throw N;return g.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",t.correlationId),g.acquireTokenBySilentIframe(u)})}),C.label=3;case 3:return[2,i.then(function(_){return g.eventHandler.emitEvent(re.ACQUIRE_TOKEN_SUCCESS,V.Silent,_),o.endMeasurement({success:!0,fromCache:_.fromCache,isNativeBroker:_.fromNativeBroker,requestId:_.requestId}),_}).catch(function(_){throw g.eventHandler.emitEvent(re.ACQUIRE_TOKEN_FAILURE,V.Silent,null,_),o.endMeasurement({errorCode:_.errorCode,subErrorCode:_.subError,success:!1}),_})]}})})},e}(function(){function n(e){this.isBrowserEnvironment=typeof window<"u",this.config=function gn(n,e){var t=n.auth,r=n.cache,o=n.system,i=n.telemetry,s={clientId:v.EMPTY_STRING,authority:""+v.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:v.EMPTY_STRING,authorityMetadata:v.EMPTY_STRING,redirectUri:v.EMPTY_STRING,postLogoutRedirectUri:v.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:Zt.AAD,azureCloudOptions:{azureCloudInstance:zt.None,tenant:v.EMPTY_STRING},skipAuthorityMetadataCache:!1},c={cacheLocation:Me.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1},u={loggerCallback:function(){},logLevel:De.Info,piiLoggingEnabled:!1},d=D(D({},Lr),{loggerOptions:u,networkClient:e?Ne.getBrowserNetworkClient():cn,navigationClient:new dn,loadFrameTimeout:0,windowHashTimeout:o?.loadFrameTimeout||6e4,iframeHashTimeout:o?.loadFrameTimeout||6e3,navigateFrameWait:e&&Ne.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:o?.nativeBrokerHandshakeTimeout||2e3,pollIntervalMilliseconds:30,cryptoOptions:{useMsrCrypto:!1,entropy:void 0}}),g={application:{appName:v.EMPTY_STRING,appVersion:v.EMPTY_STRING}};return{auth:D(D({},s),t),cache:D(D({},c),r),system:D(D({},d),o),telemetry:D(D({},g),i)}}(e,this.isBrowserEnvironment),this.initialized=!1,this.logger=new Nr(this.config.system.loggerOptions,Ir,er),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new Mn(this.config.auth.clientId,this.config.auth.authority,this.logger,Ir,er,this.config.telemetry.application,this.config.system.cryptoOptions):new Wr(this.config.auth.clientId,this.config.auth.authority,this.logger,Ir,er,this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new Vr(this.logger,this.performanceClient,this.config.system.cryptoOptions):sr,this.eventHandler=new mn(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new Sr(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):function(n,e){return new Sr(n,{cacheLocation:Me.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1},sr,e)}(this.config.auth.clientId,this.logger),this.nativeInternalStorage=new Sr(this.config.auth.clientId,{cacheLocation:Me.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1},this.browserCrypto,this.logger),this.tokenCache=new kn(this.config,this.browserStorage,this.logger,this.browserCrypto)}return n.prototype.initialize=function(){return p(this,void 0,void 0,function(){var e,t;return O(this,function(r){switch(r.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.info("initialize has already been called, exiting early."),[2];if(this.eventHandler.emitEvent(re.INITIALIZE_START),!this.config.system.allowNativeBroker)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),e=this,[4,xt.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout)];case 2:return e.nativeExtensionProvider=r.sent(),[3,4];case 3:return t=r.sent(),this.logger.verbose(t),[3,4];case 4:return this.initialized=!0,this.eventHandler.emitEvent(re.INITIALIZE_END),[2]}})})},n.prototype.handleRedirectPromise=function(e){return p(this,void 0,void 0,function(){var t,r,o,i,s,c,u,d,g=this;return O(this,function(C){return this.logger.verbose("handleRedirectPromise called"),Ne.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),t=this.getAllAccounts(),this.isBrowserEnvironment?(typeof(o=this.redirectResponse.get(r=e||v.EMPTY_STRING))>"u"?(this.eventHandler.emitEvent(re.HANDLE_REDIRECT_START,V.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),i=this.browserStorage.getCachedNativeRequest(),s=void 0,i&&xt.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),c=new Yt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Se.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,i.accountId,this.nativeInternalStorage,i.correlationId),s=c.handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),u=this.browserStorage.getTemporaryCache(pe.CORRELATION_ID,!0)||v.EMPTY_STRING,d=this.createRedirectClient(u),s=d.handleRedirectPromise(e)),o=s.then(function(_){return _&&(t.length<g.getAllAccounts().length?(g.eventHandler.emitEvent(re.LOGIN_SUCCESS,V.Redirect,_),g.logger.verbose("handleRedirectResponse returned result, login success")):(g.eventHandler.emitEvent(re.ACQUIRE_TOKEN_SUCCESS,V.Redirect,_),g.logger.verbose("handleRedirectResponse returned result, acquire token success"))),g.eventHandler.emitEvent(re.HANDLE_REDIRECT_END,V.Redirect),_}).catch(function(_){throw g.eventHandler.emitEvent(t.length>0?re.ACQUIRE_TOKEN_FAILURE:re.LOGIN_FAILURE,V.Redirect,null,_),g.eventHandler.emitEvent(re.HANDLE_REDIRECT_END,V.Redirect),_}),this.redirectResponse.set(r,o)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,o]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])})})},n.prototype.acquireTokenRedirect=function(e){return p(this,void 0,void 0,function(){var t,r,o,i,s,c=this;return O(this,function(u){return t=this.getRequestCorrelationId(e),this.logger.verbose("acquireTokenRedirect called",t),this.preflightBrowserEnvironmentCheck(V.Redirect),r=this.getAllAccounts().length>0,this.eventHandler.emitEvent(r?re.ACQUIRE_TOKEN_START:re.LOGIN_START,V.Redirect,e),this.nativeExtensionProvider&&this.canUseNative(e)?(i=new Yt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Se.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId),o=i.acquireTokenRedirect(e).catch(function(d){if(d instanceof Tt&&d.isFatal())return c.nativeExtensionProvider=void 0,c.createRedirectClient(e.correlationId).acquireToken(e);if(d instanceof Be)return c.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),c.createRedirectClient(e.correlationId).acquireToken(e);throw c.browserStorage.setInteractionInProgress(!1),d})):(s=this.createRedirectClient(e.correlationId),o=s.acquireToken(e)),[2,o.catch(function(d){throw c.eventHandler.emitEvent(r?re.ACQUIRE_TOKEN_FAILURE:re.LOGIN_FAILURE,V.Redirect,null,d),d})]})})},n.prototype.acquireTokenPopup=function(e){var t=this,r=this.getRequestCorrelationId(e),o=this.performanceClient.startMeasurement(ue.AcquireTokenPopup,r);try{this.logger.verbose("acquireTokenPopup called",r),this.preflightBrowserEnvironmentCheck(V.Popup)}catch(u){return Promise.reject(u)}var i=this.getAllAccounts();return this.eventHandler.emitEvent(i.length>0?re.ACQUIRE_TOKEN_START:re.LOGIN_START,V.Popup,e),(this.canUseNative(e)?this.acquireTokenNative(e,Se.acquireTokenPopup).then(function(u){return t.browserStorage.setInteractionInProgress(!1),o.endMeasurement({success:!0,isNativeBroker:!0,requestId:u.requestId}),o.flushMeasurement(),u}).catch(function(u){if(u instanceof Tt&&u.isFatal())return t.nativeExtensionProvider=void 0,t.createPopupClient(e.correlationId).acquireToken(e);if(u instanceof Be)return t.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),t.createPopupClient(e.correlationId).acquireToken(e);throw t.browserStorage.setInteractionInProgress(!1),u}):this.createPopupClient(e.correlationId).acquireToken(e)).then(function(u){var d=i.length<t.getAllAccounts().length;return t.eventHandler.emitEvent(d?re.LOGIN_SUCCESS:re.ACQUIRE_TOKEN_SUCCESS,V.Popup,u),o.addStaticFields({accessTokenSize:u.accessToken.length,idTokenSize:u.idToken.length}),o.endMeasurement({success:!0,requestId:u.requestId}),o.flushMeasurement(),u}).catch(function(u){return t.eventHandler.emitEvent(i.length>0?re.ACQUIRE_TOKEN_FAILURE:re.LOGIN_FAILURE,V.Popup,null,u),o.endMeasurement({errorCode:u.errorCode,subErrorCode:u.subError,success:!1}),o.flushMeasurement(),Promise.reject(u)})},n.prototype.ssoSilent=function(e){return p(this,void 0,void 0,function(){var t,r,o,i,s,c=this;return O(this,function(u){return t=this.getRequestCorrelationId(e),r=D(D({},e),{prompt:e.prompt,correlationId:t}),this.preflightBrowserEnvironmentCheck(V.Silent),o=this.performanceClient.startMeasurement(ue.SsoSilent,t),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent(re.SSO_SILENT_START,V.Silent,r),this.canUseNative(r)?i=this.acquireTokenNative(r,Se.ssoSilent).catch(function(d){if(d instanceof Tt&&d.isFatal())return c.nativeExtensionProvider=void 0,c.createSilentIframeClient(r.correlationId).acquireToken(r);throw d}):(s=this.createSilentIframeClient(r.correlationId),i=s.acquireToken(r)),[2,i.then(function(d){return c.eventHandler.emitEvent(re.SSO_SILENT_SUCCESS,V.Silent,d),o.addStaticFields({accessTokenSize:d.accessToken.length,idTokenSize:d.idToken.length}),o.endMeasurement({success:!0,isNativeBroker:d.fromNativeBroker,requestId:d.requestId}),o.flushMeasurement(),d}).catch(function(d){throw c.eventHandler.emitEvent(re.SSO_SILENT_FAILURE,V.Silent,null,d),o.endMeasurement({errorCode:d.errorCode,subErrorCode:d.subError,success:!1}),o.flushMeasurement(),d})]})})},n.prototype.acquireTokenByCode=function(e){return p(this,void 0,void 0,function(){var t,r,o,i,s=this;return O(this,function(c){t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(V.Silent),this.logger.trace("acquireTokenByCode called",t),this.eventHandler.emitEvent(re.ACQUIRE_TOKEN_BY_CODE_START,V.Silent,e),r=this.performanceClient.startMeasurement(ue.AcquireTokenByCode,e.correlationId);try{if(e.code)return(i=this.hybridAuthCodeResponses.get(o=e.code))?(this.logger.verbose("Existing acquireTokenByCode request found",e.correlationId),r.endMeasurement({success:!0}),r.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),i=this.acquireTokenByCodeAsync(D(D({},e),{correlationId:t})).then(function(u){return s.eventHandler.emitEvent(re.ACQUIRE_TOKEN_BY_CODE_SUCCESS,V.Silent,u),s.hybridAuthCodeResponses.delete(o),r.addStaticFields({accessTokenSize:u.accessToken.length,idTokenSize:u.idToken.length}),r.endMeasurement({success:!0,isNativeBroker:u.fromNativeBroker,requestId:u.requestId}),r.flushMeasurement(),u}).catch(function(u){throw s.hybridAuthCodeResponses.delete(o),s.eventHandler.emitEvent(re.ACQUIRE_TOKEN_BY_CODE_FAILURE,V.Silent,null,u),r.endMeasurement({errorCode:u.errorCode,subErrorCode:u.subError,success:!1}),r.flushMeasurement(),u}),this.hybridAuthCodeResponses.set(o,i)),[2,i];if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId))return[2,this.acquireTokenNative(e,Se.acquireTokenByCode,e.nativeAccountId).catch(function(u){throw u instanceof Tt&&u.isFatal()&&(s.nativeExtensionProvider=void 0),u})];throw E.createUnableToAcquireTokenFromNativePlatformError()}throw E.createAuthCodeOrNativeAccountIdRequiredError()}catch(u){throw this.eventHandler.emitEvent(re.ACQUIRE_TOKEN_BY_CODE_FAILURE,V.Silent,null,u),r.endMeasurement({errorCode:u instanceof S&&u.errorCode||void 0,subErrorCode:u instanceof S&&u.subError||void 0,success:!1}),u}return[2]})})},n.prototype.acquireTokenByCodeAsync=function(e){return p(this,void 0,void 0,function(){return O(this,function(o){switch(o.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),[4,this.createSilentAuthCodeClient(e.correlationId).acquireToken(e)];case 1:return[2,o.sent()]}})})},n.prototype.acquireTokenFromCache=function(e,t,r){return p(this,void 0,void 0,function(){return O(this,function(o){switch(r.cacheLookupPolicy){case Ke.Default:case Ke.AccessToken:case Ke.AccessTokenAndRefreshToken:return[2,e.acquireToken(t)];default:throw f.createRefreshRequiredError()}return[2]})})},n.prototype.acquireTokenByRefreshToken=function(e,t){return p(this,void 0,void 0,function(){return O(this,function(o){switch(t.cacheLookupPolicy){case Ke.Default:case Ke.AccessTokenAndRefreshToken:case Ke.RefreshToken:case Ke.RefreshTokenAndNetwork:return[2,this.createSilentRefreshClient(e.correlationId).acquireToken(e)];default:throw f.createRefreshRequiredError()}return[2]})})},n.prototype.acquireTokenBySilentIframe=function(e){return p(this,void 0,void 0,function(){return O(this,function(r){return[2,this.createSilentIframeClient(e.correlationId).acquireToken(e)]})})},n.prototype.logout=function(e){return p(this,void 0,void 0,function(){var t;return O(this,function(r){return t=this.getRequestCorrelationId(e),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),[2,this.logoutRedirect(D({correlationId:t},e))]})})},n.prototype.logoutRedirect=function(e){return p(this,void 0,void 0,function(){var t;return O(this,function(o){return t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(V.Redirect),[2,this.createRedirectClient(t).logout(e)]})})},n.prototype.logoutPopup=function(e){try{var t=this.getRequestCorrelationId(e);return this.preflightBrowserEnvironmentCheck(V.Popup),this.createPopupClient(t).logout(e)}catch(o){return Promise.reject(o)}},n.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},n.prototype.getAccountByUsername=function(e){var t=this.getAllAccounts();return!y.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching username found, returning"),this.logger.verbosePii("Returning signed-in accounts matching username: "+e),t.filter(function(r){return r.username.toLowerCase()===e.toLowerCase()})[0]||null):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},n.prototype.getAccountByHomeId=function(e){var t=this.getAllAccounts();return!y.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching homeAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching homeAccountId: "+e),t.filter(function(r){return r.homeAccountId===e})[0]||null):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},n.prototype.getAccountByLocalId=function(e){var t=this.getAllAccounts();return!y.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching localAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching localAccountId: "+e),t.filter(function(r){return r.localAccountId===e})[0]||null):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},n.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},n.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},n.prototype.preflightBrowserEnvironmentCheck=function(e,t){if(void 0===t&&(t=!0),this.logger.verbose("preflightBrowserEnvironmentCheck started"),Ne.blockNonBrowserEnvironment(this.isBrowserEnvironment),Ne.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),Ne.blockReloadInHiddenIframes(),Ne.blockAcquireTokenInPopups(),Ne.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),e===V.Redirect&&this.config.cache.cacheLocation===Me.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw $.createInMemoryRedirectUnavailableError();(e===V.Redirect||e===V.Popup)&&this.preflightInteractiveRequest(t)},n.prototype.preflightInteractiveRequest=function(e){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),Ne.blockReloadInHiddenIframes(),e&&this.browserStorage.setInteractionInProgress(!0)},n.prototype.acquireTokenNative=function(e,t,r){return p(this,void 0,void 0,function(){return O(this,function(i){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw E.createNativeConnectionNotEstablishedError();return[2,new Yt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)]})})},n.prototype.canUseNative=function(e,t){if(this.logger.trace("canUseNative called"),!xt.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case be.NONE:case be.CONSENT:case be.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+e.prompt+" is not compatible with native flow, returning false"),!1}return!(!t&&!this.getNativeAccountId(e)&&(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),1))},n.prototype.getNativeAccountId=function(e){var t=e.account||this.browserStorage.getAccountInfoByHints(e.loginHint,e.sid)||this.getActiveAccount();return t&&t.nativeAccountId||""},n.prototype.createPopupClient=function(e){return new In(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},n.prototype.createRedirectClient=function(e){return new An(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},n.prototype.createSilentIframeClient=function(e){return new Rn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Se.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},n.prototype.createSilentCacheClient=function(e){return new zr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},n.prototype.createSilentRefreshClient=function(e){return new bn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},n.prototype.createSilentAuthCodeClient=function(e){return new On(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Se.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)},n.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},n.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},n.prototype.addPerformanceCallback=function(e){return this.performanceClient.addPerformanceCallback(e)},n.prototype.removePerformanceCallback=function(e){return this.performanceClient.removePerformanceCallback(e)},n.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},n.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},n.prototype.getTokenCache=function(){return this.tokenCache},n.prototype.getLogger=function(){return this.logger},n.prototype.setLogger=function(e){this.logger=e},n.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)},n.prototype.setNavigationClient=function(e){this.navigationClient=e},n.prototype.getConfiguration=function(){return this.config},n.prototype.getRequestCorrelationId=function(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():v.EMPTY_STRING},n}()),Ct=l(41571),Ln=l(91170),br=l(3410),Hn=l(68423),Dn=l(3469);let ze=(()=>{class n extends A.Loh{constructor(t){super(),this.initialized=!1,this.name=t.name,this.clientId=t.clientId,this.additionalParams=t.additionalParams,this.icon=t.name.toLowerCase()}}return n.FACEBOOK="Facebook",n.GOOGLE="Google",n.MICROSOFT="Microsoft",n.OPENID="OpenIdConnect",n.WSFEDERATION="WsFederation",n.TWITTER="Twitter",n})(),Fn=(()=>{class n{constructor(t,r,o,i,s,c,u,d,g){this._tokenAuthService=t,this._router=r,this._messageService=o,this._tokenService=i,this._logService=s,this.oauthService=c,this.spinnerService=u,this._localStorageService=d,this._twitterService=g,this.externalLoginProviders=[],this.localizationSourceName=h.g.localization.defaultLocalizationSourceName,this.clear()}authenticate(t,r,o){t=t||(()=>{this.spinnerService.hide()});const i=this;this._localStorageService.getItem(n.twoFactorRememberClientTokenName,function(s,c){i.authenticateModel.twoFactorRememberClientToken=c?.token,i.authenticateModel.singleSignIn=T._.getSingleSignIn(),i.authenticateModel.returnUrl=T._.getReturnUrl(),i.authenticateModel.captchaResponse=o,i._tokenAuthService.authenticate(i.authenticateModel).subscribe({next:u=>{i.processAuthenticateResult(u,r),t()},error:u=>{t()}})})}ensureExternalLoginProviderInitialized(t,r){if(t.initialized)r();else if(t.name===ze.FACEBOOK)(new k.$).load("//connect.facebook.net/en_US/sdk.js").then(()=>{FB.init({appId:t.clientId,cookie:!1,xfbml:!0,version:"v2.5"}),FB.getLoginStatus(o=>{this.facebookLoginStatusChangeCallback(o),"connected"!==o.status&&r()})});else if(t.name===ze.GOOGLE)(new k.$).load("https://apis.google.com/js/api.js","https://accounts.google.com/gsi/client").then(()=>{gapi.load("client",()=>{gapi.client.init({}).then(()=>{gapi.client.load("oauth2","v2",()=>{r()})})})});else if(t.name===ze.MICROSOFT)this.MSAL=new xn({auth:{clientId:t.clientId,redirectUri:h.g.appBaseUrl}}),r();else if(t.name===ze.OPENID){const o=this.getOpenIdConnectConfig(t);this.oauthService.configure(o),this.oauthService.initLoginFlow("openIdConnect=1")}else if(t.name===ze.WSFEDERATION){let o=this.getWsFederationConnectConfig(t);this.wsFederationAuthenticationContext=new _e(o),this.wsFederationAuthenticationContext.login()}else t.name===ze.TWITTER&&r()}twitterLoginCallback(t,r){this.spinnerService.show(),this._twitterService.getAccessToken(t,r).subscribe(o=>{const i=new A.pLD;i.authProvider=ze.TWITTER,i.providerAccessCode=o.accessToken+"&"+o.accessTokenSecret,i.providerKey=o.userId,i.singleSignIn=T._.getSingleSignIn(),i.returnUrl=T._.getReturnUrl(),this._tokenAuthService.externalAuthenticate(i).pipe((0,ne.x)(()=>{this.spinnerService.hide()})).subscribe(s=>{s.waitingForActivation?this._messageService.info("You have successfully registered. Waiting for activation!"):this.login(s.accessToken,s.encryptedAccessToken,s.expireInSeconds,s.refreshToken,s.refreshTokenExpireInSeconds,!1,"",s.returnUrl)})})}wsFederationLoginStatusChangeCallback(t,r,o,i){let s=this.wsFederationAuthenticationContext.getCachedUser();const c=new A.pLD;c.authProvider=ze.WSFEDERATION,c.providerAccessCode=r,c.providerKey=s.profile.sub,c.singleSignIn=T._.getSingleSignIn(),c.returnUrl=T._.getReturnUrl(),this._tokenAuthService.externalAuthenticate(c).subscribe(u=>{if(u.waitingForActivation)return this._messageService.info("You have successfully registered. Waiting for activation!"),void this._router.navigate(["account/login"]);this.login(u.accessToken,u.encryptedAccessToken,u.expireInSeconds,u.refreshToken,u.refreshTokenExpireInSeconds,!1,"",u.returnUrl)})}openIdConnectLoginCallback(t){this.initExternalLoginProviders(()=>{let r=(0,P.Z)(this.externalLoginProviders,{name:"OpenIdConnect"})[0],o=this.getOpenIdConnectConfig(r);this.oauthService.configure(o),this.spinnerService.show(),this.oauthService.loadDiscoveryDocumentAndTryLogin().then(()=>{let i=this.oauthService.getIdentityClaims();const s=new A.pLD;s.authProvider=ze.OPENID,s.providerAccessCode=this.oauthService.getIdToken(),s.providerKey=i.sub,s.singleSignIn=T._.getSingleSignIn(),s.returnUrl=T._.getReturnUrl(),this._tokenAuthService.externalAuthenticate(s).pipe((0,ne.x)(()=>{this.spinnerService.hide()})).subscribe(c=>{c.waitingForActivation?this._messageService.info("You have successfully registered. Waiting for activation!"):this.login(c.accessToken,c.encryptedAccessToken,c.expireInSeconds,c.refreshToken,c.refreshTokenExpireInSeconds,!1,"",c.returnUrl)})})})}externalAuthenticate(t){this.ensureExternalLoginProviderInitialized(t,()=>{if(t.name===ze.FACEBOOK)FB.login(r=>{this.facebookLoginStatusChangeCallback(r)},{scope:"email"});else if(t.name===ze.GOOGLE){let r=google.accounts.oauth2.initTokenClient({client_id:t.clientId,scope:"openid profile email",callback:o=>{if(void 0!==o.error)throw o;this.googleLoginStatusChangeCallback(o)}});null===gapi.client.getToken()?r.requestAccessToken({prompt:"consent"}):r.requestAccessToken({prompt:""})}else if(t.name===ze.MICROSOFT){let r=["user.read"];this.spinnerService.show(),this.MSAL.loginPopup({scopes:r}).then(o=>{this.MSAL.acquireTokenSilent({account:this.MSAL.getAllAccounts()[0],scopes:r}).then(i=>{this.microsoftLoginCallback(i),this.spinnerService.hide()}).catch(i=>{abp.log.error(i),abp.message.error(this.localization.localize("CouldNotValidateExternalUser",this.localizationSourceName))})})}else t.name===ze.TWITTER&&this.startTwitterLogin()})}init(){this.initExternalLoginProviders()}processAuthenticateResult(t,r){this.authenticateResult=t,t.shouldResetPassword?(this._router.navigate(["account/reset-password"],{queryParams:{c:t.c}}),this.clear()):t.requiresTwoFactorVerification?this._router.navigate(["account/send-code"]):t.accessToken?(t.returnUrl&&!r&&(r=t.returnUrl),this.login(t.accessToken,t.encryptedAccessToken,t.expireInSeconds,t.refreshToken,t.refreshTokenExpireInSeconds,this.rememberMe,t.twoFactorRememberClientToken,r)):(this._logService.warn("Unexpected authenticateResult!"),this._router.navigate(["account/login"]))}login(t,r,o,i,s,c,u,d){let g=c?new Date((new Date).getTime()+1e3*o):void 0;if(this._tokenService.setToken(t,g),i&&c){let _=c?new Date((new Date).getTime()+1e3*s):void 0;this._tokenService.setRefreshToken(i,_)}let C=this;this._localStorageService.setItem(h.g.authorization.encrptedAuthTokenName,{token:r,expireDate:g},()=>{u?C._localStorageService.setItem(n.twoFactorRememberClientTokenName,{token:u,expireDate:new Date((new Date).getTime()+31536e6)},()=>{C.redirectToLoginResult(d)}):C.redirectToLoginResult(d)})}redirectToLoginResult(t){if(t)location.href=t;else{let r=T._.initialUrl;r.indexOf("/account")>0&&(r=h.g.appBaseUrl),location.href=r}}clear(){this.authenticateModel=new A.u_b,this.authenticateModel.rememberClient=!1,this.authenticateResult=null,this.rememberMe=!1}initExternalLoginProviders(t){this._tokenAuthService.getExternalAuthenticationProviders().subscribe(r=>{this.externalLoginProviders=(0,K.Z)(r,o=>new ze(o)),t&&t()})}getWsFederationConnectConfig(t){let r={clientId:t.clientId,popUp:!0,callback:this.wsFederationLoginStatusChangeCallback.bind(this)};return t.additionalParams.Tenant&&(r.tenant=t.additionalParams.Tenant),r}getOpenIdConnectConfig(t){let r=new le.Tg;return r.loginUrl=t.additionalParams.LoginUrl,r.issuer=t.additionalParams.Authority,r.skipIssuerCheck="false"===t.additionalParams.ValidateIssuer,r.clientId=t.clientId,r.responseType=t.additionalParams.ResponseType,r.strictDiscoveryDocumentValidation=!1,r.redirectUri=window.location.origin+"/account/login",r.scope="openid profile",r.requestAccessToken=!1,r}facebookLoginStatusChangeCallback(t){if("connected"===t.status){const r=new A.pLD;r.authProvider=ze.FACEBOOK,r.providerAccessCode=t.authResponse.accessToken,r.providerKey=t.authResponse.userID,r.singleSignIn=T._.getSingleSignIn(),r.returnUrl=T._.getReturnUrl(),this._tokenAuthService.externalAuthenticate(r).subscribe(o=>{o.waitingForActivation?this._messageService.info("You have successfully registered. Waiting for activation!"):this.login(o.accessToken,o.encryptedAccessToken,o.expireInSeconds,o.refreshToken,o.refreshTokenExpireInSeconds,!1,"",o.returnUrl)})}}startTwitterLogin(){this.spinnerService.show(),this._twitterService.getRequestToken().pipe((0,ne.x)(()=>this.spinnerService.hide())).subscribe(t=>{t.confirmed?window.location.href=t.redirectUrl:this._messageService.error("Couldn't get twitter request token !")})}googleLoginStatusChangeCallback(t){if(void 0===t.error){var r=this;gapi.client.oauth2.userinfo.get().execute(function(o){const i=new A.pLD;i.authProvider=ze.GOOGLE,i.providerAccessCode=t.access_token,i.providerKey=o.id,i.singleSignIn=T._.getSingleSignIn(),i.returnUrl=T._.getReturnUrl(),r._tokenAuthService.externalAuthenticate(i).subscribe(s=>{s.waitingForActivation?r._messageService.info("You have successfully registered. Waiting for activation!"):r.login(s.accessToken,s.encryptedAccessToken,s.expireInSeconds,s.refreshToken,s.refreshTokenExpireInSeconds,!1,"",s.returnUrl)})})}}microsoftLoginCallback(t){const r=new A.pLD;r.authProvider=ze.MICROSOFT,r.providerAccessCode=t.accessToken,r.providerKey=t.uniqueId,r.singleSignIn=T._.getSingleSignIn(),r.returnUrl=T._.getReturnUrl(),this.spinnerService.show(),this._tokenAuthService.externalAuthenticate(r).subscribe(o=>{o.waitingForActivation?this._messageService.info("You have successfully registered. Waiting for activation!"):(this.login(o.accessToken,o.encryptedAccessToken,o.expireInSeconds,o.refreshToken,o.refreshTokenExpireInSeconds,!1,"",o.returnUrl),this.spinnerService.hide())})}}return n.twoFactorRememberClientTokenName="TwoFactorRememberClientToken",n.\u0275fac=function(t){return new(t||n)(Ct.\u0275\u0275inject(A.WH8),Ct.\u0275\u0275inject(Ln.F0),Ct.\u0275\u0275inject(br.ez),Ct.\u0275\u0275inject(br.Br),Ct.\u0275\u0275inject(br.$V),Ct.\u0275\u0275inject(le.Ct),Ct.\u0275\u0275inject(Hn.t2),Ct.\u0275\u0275inject(Dn.n),Ct.\u0275\u0275inject(A.TWG))},n.\u0275prov=Ct.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n})()},6004:(st,U,l)=>{"use strict";l.d(U,{T:()=>A});var h=l(37857),T=l(41571);let A=(()=>{class k{getPaymentGatewayType(K){return parseInt(K)===h.UWJ.Paypal?"Paypal":"Stripe"}getEditionPaymentType(K){return parseInt(K)===h.qLZ.BuyNow?"BuyNow":parseInt(K)===h.qLZ.Extend?"Extend":parseInt(K)===h.qLZ.NewRegistration?"NewRegistration":"Upgrade"}getInitialSelectedPaymentPeriodType(K){return K.dailyPrice>0?h.dw4.Daily:K.weeklyPrice>0?h.dw4.Weekly:K.monthlyPrice>0?h.dw4.Monthly:K.annualPrice>0?h.dw4.Annual:void 0}}return k.\u0275fac=function(K){return new(K||k)},k.\u0275prov=T.\u0275\u0275defineInjectable({token:k,factory:k.\u0275fac}),k})()},91363:(st,U,l)=>{"use strict";l.d(U,{K:()=>T});var h=l(41571);let T=(()=>{class A{}return A.\u0275fac=function(P){return new(P||A)},A.\u0275prov=h.\u0275\u0275defineInjectable({token:A,factory:A.\u0275fac}),A})()},12749:(st,U,l)=>{"use strict";l.d(U,{y:()=>A});var h=l(60263),T=l(41571);let A=(()=>{class k{}return k.\u0275fac=function(K){return new(K||k)},k.\u0275mod=T.\u0275\u0275defineNgModule({type:k}),k.\u0275inj=T.\u0275\u0275defineInjector({imports:[h.o]}),k})()},15260:(st,U,l)=>{"use strict";l.d(U,{o:()=>k});var h=l(41571),T=l(3410),A=l(94700);let k=(()=>{class P{constructor(ne,le){this.setting=ne,this._reCaptchaV3Service=le}getService(){return this._reCaptchaV3Service}useCaptchaOnLogin(){return this.setting.getBoolean("App.UserManagement.UseCaptchaOnLogin")}setCaptchaVisibilityOnLogin(){var ne=document.getElementsByClassName("grecaptcha-badge");!ne||ne.length<=0||(this.useCaptchaOnLogin()?ne[0].classList.remove("d-none"):ne[0].classList.add("d-none"))}useCaptchaOnRegister(){return this.setting.getBoolean("App.UserManagement.UseCaptchaOnRegistration")}setCaptchaVisibilityOnRegister(){var ne=document.getElementsByClassName("grecaptcha-badge");!ne||ne.length<=0||(this.useCaptchaOnRegister()?ne[0].classList.remove("d-none"):ne[0].classList.add("d-none"))}}return P.\u0275fac=function(ne){return new(ne||P)(h.\u0275\u0275inject(T.RC),h.\u0275\u0275inject(A.YC))},P.\u0275prov=h.\u0275\u0275defineInjectable({token:P,factory:P.\u0275fac}),P})()},70685:st=>{var U=function(){"use strict";return U=function(l){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},U.prototype._singletonInstance)return U.prototype._singletonInstance;if(U.prototype._singletonInstance=this,this.instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,l.displayCall&&"function"!=typeof l.displayCall)throw new Error("displayCall is not a function");if(!l.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(l),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},typeof window<"u"&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(l){}}),U.prototype.login=function(){if(this._loginInProgress)this.info("Login in progress");else{this._loginInProgress=!0;var l=this._guid();this.config.state=l,this._idTokenNonce=this._guid();var h=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST);h&&""!==h?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):h=window.location.href,this.verbose("Expected state: "+l+" startPage:"+h),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,h),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,l,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var T=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);this.config.displayCall?this.config.displayCall(T):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(l),this.registerCallback(l,this.config.clientId,this.callback),this._loginPopup(T)):this.promptUser(T)}},U.prototype._openPopup=function(l,h,T,A){try{var k=window.screenLeft?window.screenLeft:window.screenX,P=window.screenTop?window.screenTop:window.screenY,K=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,ne=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,Ae=window.open(l,h,"width="+T+", height="+A+", top="+(ne/2-A/2+P)+", left="+(K/2-T/2+k));return Ae.focus&&Ae.focus(),Ae}catch(he){return this.warn("Error opening popup, "+he.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},U.prototype._handlePopupError=function(l,h,T,A,k){this.warn(A),this._saveItem(this.CONSTANTS.STORAGE.ERROR,T),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,A),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,k),h&&this._activeRenewals[h]&&(this._activeRenewals[h]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,l&&l(A,null,T)},U.prototype._loginPopup=function(l,h,T){var A=this._openPopup(l,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),k=T||this.callback;if(null!=A){if(this._openedWindows.push(A),-1!=this.config.redirectUri.indexOf("#"))var ne=this.config.redirectUri.split("#")[0];else ne=this.config.redirectUri;var le=this,_e=window.setInterval(function(){if(!A||A.closed||void 0===A.closed){var Ae="Popup Window closed",he="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return le.isAngular&&le._broadcast("adal:popUpClosed",he+le.CONSTANTS.RESOURCE_DELIMETER+Ae),le._handlePopupError(k,h,Ae,he,he),void window.clearInterval(_e)}try{var D=A.location;if(-1!=encodeURI(D.href).indexOf(encodeURI(ne)))return le.isAngular?le._broadcast("adal:popUpHashChanged",D.hash):le.handleWindowCallback(D.hash),window.clearInterval(_e),le._loginInProgress=!1,le._acquireTokenInProgress=!1,le.info("Closing popup window"),le._openedWindows=[],void A.close()}catch{}},1)}else{var K="Popup Window is null. This can happen if you are using IE";this._handlePopupError(k,h,"Error opening popup",K,K)}},U.prototype._broadcast=function(l,h){!function(){if("function"==typeof window.CustomEvent)return!1;function A(k,P){P=P||{bubbles:!1,cancelable:!1,detail:void 0};var K=document.createEvent("CustomEvent");return K.initCustomEvent(k,P.bubbles,P.cancelable,P.detail),K}A.prototype=window.Event.prototype,window.CustomEvent=A}();var T=new CustomEvent(l,{detail:h});window.dispatchEvent(T)},U.prototype.loginInProgress=function(){return this._loginInProgress},U.prototype._hasResource=function(l){var h=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return h&&!this._isEmpty(h)&&h.indexOf(l+this.CONSTANTS.RESOURCE_DELIMETER)>-1},U.prototype.getCachedToken=function(l){if(!this._hasResource(l))return null;var h=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+l),T=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+l),A=this.config.expireOffsetSeconds||300;return T&&T>this._now()+A?h:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+l,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+l,0),null)},U.prototype.getCachedUser=function(){if(this._user)return this._user;var l=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(l),this._user},U.prototype.registerCallback=function(l,h,T){this._activeRenewals[h]=l,this._callBacksMappedToRenewStates[l]||(this._callBacksMappedToRenewStates[l]=[]);var A=this;this._callBacksMappedToRenewStates[l].push(T),this._callBackMappedToRenewStates[l]||(this._callBackMappedToRenewStates[l]=function(k,P,K,ne){A._activeRenewals[h]=null;for(var le=0;le<A._callBacksMappedToRenewStates[l].length;++le)try{A._callBacksMappedToRenewStates[l][le](k,P,K,ne)}catch(_e){A.warn(_e)}A._callBacksMappedToRenewStates[l]=null,A._callBackMappedToRenewStates[l]=null})},U.prototype._renewToken=function(l,h,T){this.info("renewToken is called for resource:"+l);var A=this._addAdalFrame("adalRenewFrame"+l),k=this._guid()+"|"+l;this.config.state=k,this._renewStates.push(k),this.verbose("Renew token Expected state: "+k);var P=this._urlRemoveQueryStringParameter(this._getNavigateUrl(T=T||"token",l),"prompt");T===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),P+="&nonce="+encodeURIComponent(this._idTokenNonce)),P=this._addHintParameters(P+="&prompt=none"),this.registerCallback(k,l,h),this.verbosePii("Navigate to:"+P),A.src="about:blank",this._loadFrameTimeout(P,"adalRenewFrame"+l,l)},U.prototype._renewIdToken=function(l,P){this.info("renewIdToken is called");var T=this._addAdalFrame("adalIdTokenFrame"),A=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=A,this._renewStates.push(A),this.verbose("Renew Idtoken Expected state: "+A);var k=null===P||typeof P>"u"?null:this.config.clientId,K=this._urlRemoveQueryStringParameter(this._getNavigateUrl(P=P||"id_token",k),"prompt");K=this._addHintParameters(K+="&prompt=none"),K+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(A,this.config.clientId,l),this.verbosePii("Navigate to:"+K),T.src="about:blank",this._loadFrameTimeout(K,"adalIdTokenFrame",this.config.clientId)},U.prototype._urlContainsQueryStringParameter=function(l,h){return new RegExp("[\\?&]"+l+"=").test(h)},U.prototype._urlRemoveQueryStringParameter=function(l,h){var T=new RegExp("(\\&"+h+"=)[^&]+");return l=l.replace(T,""),T=new RegExp("("+h+"=)[^&]+&"),l=l.replace(T,""),T=new RegExp("("+h+"=)[^&]+"),l.replace(T,"")},U.prototype._loadFrameTimeout=function(l,h,T){this.verbose("Set loading state to pending for: "+T),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+T,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(l,h);var A=this;setTimeout(function(){if(A._getItem(A.CONSTANTS.STORAGE.RENEW_STATUS+T)===A.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS){A.verbose("Loading frame has timed out after: "+A.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+T);var k=A._activeRenewals[T];k&&A._callBackMappedToRenewStates[k]&&A._callBackMappedToRenewStates[k]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),A._saveItem(A.CONSTANTS.STORAGE.RENEW_STATUS+T,A.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED)}},A.CONSTANTS.LOADFRAME_TIMEOUT)},U.prototype._loadFrame=function(l,h){var T=this;T.info("LoadFrame: "+h);var A=h;setTimeout(function(){var k=T._addAdalFrame(A);(""===k.src||"about:blank"===k.src)&&(k.src=l,T._loadFrame(l,A))},500)},U.prototype.acquireToken=function(l,h){if(this._isEmpty(l))return this.warn("resource is required"),void h("resource is required",null,"resource is required");var T=this.getCachedToken(l);return T?(this.info("Token is already in cache for resource:"+l),void h(null,T,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[l]?this.registerCallback(this._activeRenewals[l],l,h):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,l===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(h)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(h,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(l,h)):(this.verbose("renewing idtoken and access_token"),this._renewToken(l,h,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void h("User login is required",null,"login required"))},U.prototype.acquireTokenPopup=function(l,h,T,A){if(this._isEmpty(l))return this.warn("resource is required"),void A("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void A("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void A("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var k=this._guid()+"|"+l;this.config.state=k,this._renewStates.push(k),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+k);var P=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",l),"prompt");if(P+="&prompt=select_account",h&&(P+=h),T&&-1===P.indexOf("&claims"))P+="&claims="+encodeURIComponent(T);else if(T&&-1!==P.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");P=this._addHintParameters(P),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+l),this.registerCallback(k,l,A),this._loginPopup(P,l,A)},U.prototype.acquireTokenRedirect=function(l,h,T){if(this._isEmpty(l))return this.warn("resource is required"),void A("resource is required",null,"resource is required");var A=this.callback;if(!this._user)return this.warn("User login is required"),void A("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void A("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var k=this._guid()+"|"+l;this.config.state=k,this.verbose("Renew token Expected state: "+k);var P=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",l),"prompt");if(P+="&prompt=select_account",h&&(P+=h),T&&-1===P.indexOf("&claims"))P+="&claims="+encodeURIComponent(T);else if(T&&-1!==P.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");P=this._addHintParameters(P),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+l),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,k,!0),this.promptUser(P)},U.prototype.promptUser=function(l){l?(this.infoPii("Navigate to:"+l),window.location.replace(l)):this.info("Navigate url is empty")},U.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var l=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(l)){l=l.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var h=0;h<l.length&&""!==l[h];h++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+l[h],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+l[h],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},U.prototype.clearCacheForResource=function(l){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(l)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+l,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+l,0))},U.prototype.logOut=function(){var l;if(this.clearCache(),this._user=null,this.config.logOutUri)l=this.config.logOutUri;else{var h="common",T="";this.config.tenant&&(h=this.config.tenant),this.config.postLogoutRedirectUri&&(T="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),l=this.instance+h+"/oauth2/logout?"+T}this.infoPii("Logout navigate to: "+l),this.promptUser(l)},U.prototype._isEmpty=function(l){return typeof l>"u"||!l||0===l.length},U.prototype.getUser=function(l){if("function"!=typeof l)throw new Error("callback is not a function");if(this._user)l(null,this._user);else{var h=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(h)?(this.warn("User information is not available"),l("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(h),l(null,this._user))}},U.prototype._addHintParameters=function(l){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==l.indexOf("&prompt=none"))this._urlContainsQueryStringParameter("sid",l)||(l+="&sid="+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",l)||(l+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",l)&&this._user.profile.upn.indexOf("@")>-1)){var h=this._user.profile.upn.split("@");l+="&domain_hint="+encodeURIComponent(h[h.length-1])}return l},U.prototype._createUser=function(l){var h=null,T=this._extractIdToken(l);return T&&T.hasOwnProperty("aud")&&(T.aud.toLowerCase()===this.config.clientId.toLowerCase()?(h={userName:"",profile:T},T.hasOwnProperty("upn")?h.userName=T.upn:T.hasOwnProperty("email")&&(h.userName=T.email)):this.warn("IdToken has invalid aud field")),h},U.prototype._getHash=function(l){return l.indexOf("#/")>-1?l=l.substring(l.indexOf("#/")+2):l.indexOf("#")>-1&&(l=l.substring(1)),l},U.prototype.isCallback=function(l){l=this._getHash(l);var h=this._deserialize(l);return h.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||h.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||h.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},U.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},U.prototype.getRequestInfo=function(l){l=this._getHash(l);var h=this._deserialize(l),T={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(h&&(T.parameters=h,h.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||h.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||h.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){if(T.valid=!0,!h.hasOwnProperty("state"))return this.warn("No state returned"),T;if(this.verbose("State: "+h.state),T.stateResponse=h.state,this._matchState(T))return T;if(!T.stateMatch&&window.parent){T.requestType=this._requestType;for(var k=this._renewStates,P=0;P<k.length;P++)if(k[P]===T.stateResponse){T.stateMatch=!0;break}}}return T},U.prototype._matchNonce=function(l){var h=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(h){h=h.split(this.CONSTANTS.CACHE_DELIMETER);for(var T=0;T<h.length;T++)if(h[T]&&h[T]===l.profile.nonce)return!0}return!1},U.prototype._matchState=function(l){var h=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(h){h=h.split(this.CONSTANTS.CACHE_DELIMETER);for(var T=0;T<h.length;T++)if(h[T]&&h[T]===l.stateResponse)return l.requestType=this.REQUEST_TYPE.LOGIN,l.stateMatch=!0,!0}var A=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(A)for(A=A.split(this.CONSTANTS.CACHE_DELIMETER),T=0;T<A.length;T++)if(A[T]&&A[T]===l.stateResponse)return l.requestType=this.REQUEST_TYPE.RENEW_TOKEN,l.stateMatch=!0,!0;return!1},U.prototype._getResourceFromState=function(l){if(l){var h=l.indexOf("|");if(h>-1&&h+1<l.length)return l.substring(h+1)}return""},U.prototype.saveTokenFromHash=function(l){this.info("State status:"+l.stateMatch+"; Request type:"+l.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var h=this._getResourceFromState(l.stateResponse);if(l.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION))this.infoPii("Error :"+l.parameters.error+"; Error description:"+l.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,l.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,l.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),l.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,l.parameters.error_description));else if(l.stateMatch){var T;this.info("State is right"),l.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,l.parameters[this.CONSTANTS.SESSION_STATE]),l.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(h)||(T=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,T+h+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+h,l.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+h,this._expiresIn(l.parameters[this.CONSTANTS.EXPIRES_IN]))),l.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(l.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,l.parameters[this.CONSTANTS.ID_TOKEN]),this._hasResource(h=this.config.loginResource?this.config.loginResource:this.config.clientId)||(T=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,T+h+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+h,l.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+h,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(l.parameters.error="invalid id_token",l.parameters.error_description="Invalid id_token. id_token: "+l.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+l.parameters[this.CONSTANTS.ID_TOKEN])))}else l.parameters.error="Invalid_state",l.parameters.error_description="Invalid_state. state: "+l.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+l.stateResponse);this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+h,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},U.prototype.getResourceForEndpoint=function(l){if(this.config&&this.config.anonymousEndpoints)for(var h=0;h<this.config.anonymousEndpoints.length;h++)if(l.indexOf(this.config.anonymousEndpoints[h])>-1)return null;if(this.config&&this.config.endpoints)for(var T in this.config.endpoints)if(l.indexOf(T)>-1)return this.config.endpoints[T];return l.indexOf("http://")>-1||l.indexOf("https://")>-1?this._getHostFromUri(l)===this._getHostFromUri(this.config.redirectUri)?this.config.loginResource:null:this.config.loginResource},U.prototype._getHostFromUri=function(l){var h=String(l).replace(/^(https?:)\/\//,"");return h.split("/")[0]},U.prototype.handleWindowCallback=function(l){if(null==l&&(l=window.location.hash),this.isCallback(l)){var h=null,T=!1;this._openedWindows.length>0&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(h=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,T=!0):window.parent&&window.parent._adalInstance&&(h=window.parent._adalInstance);var k,P,A=h.getRequestInfo(l),K=null;P=T||window.parent!==window?h._callBackMappedToRenewStates[A.stateResponse]:h.callback,h.info("Returned from redirect url"),h.saveTokenFromHash(A),A.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?h.verbose("Window is in iframe, acquiring token silently"):h.verbose("acquiring token interactive in progress"),k=A.parameters[h.CONSTANTS.ACCESS_TOKEN]||A.parameters[h.CONSTANTS.ID_TOKEN],K=h.CONSTANTS.ACCESS_TOKEN):A.requestType===this.REQUEST_TYPE.LOGIN&&(k=A.parameters[h.CONSTANTS.ID_TOKEN],K=h.CONSTANTS.ID_TOKEN);var ne=A.parameters[h.CONSTANTS.ERROR_DESCRIPTION],le=A.parameters[h.CONSTANTS.ERROR];try{P&&P(ne,k,le,K)}catch(_e){h.error("Error occurred in user defined callback function: "+_e)}window.parent===window&&!T&&(h.config.navigateToLoginRequestUrl?window.location.href=h._getItem(h.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},U.prototype._getNavigateUrl=function(l,h){var T="common";this.config.tenant&&(T=this.config.tenant);var A=this.instance+T+"/oauth2/authorize"+this._serialize(l,this.config,h)+this._addLibMetadata();return this.info("Navigate url:"+A),A},U.prototype._extractIdToken=function(l){var h=this._decodeJwt(l);if(!h)return null;try{var A=this._base64DecodeStringUrlSafe(h.JWSPayload);return A?JSON.parse(A):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(k){this.error("The returned id_token could not be decoded",k)}return null},U.prototype._base64DecodeStringUrlSafe=function(l){return l=l.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(l))):decodeURIComponent(escape(this._decode(l)))},U.prototype._decode=function(l){var h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",T=(l=String(l).replace(/=+$/,"")).length;if(T%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var A,k,P,K,ne,le,_e,he="",D=0;D<T;D+=4){if(A=h.indexOf(l.charAt(D)),k=h.indexOf(l.charAt(D+1)),P=h.indexOf(l.charAt(D+2)),K=h.indexOf(l.charAt(D+3)),D+2===T-1){le=(ne=A<<18|k<<12|P<<6)>>16&255,_e=ne>>8&255,he+=String.fromCharCode(le,_e);break}if(D+1===T-1){le=(ne=A<<18|k<<12)>>16&255,he+=String.fromCharCode(le);break}le=(ne=A<<18|k<<12|P<<6|K)>>16&255,_e=ne>>8&255,he+=String.fromCharCode(le,_e,255&ne)}return he},U.prototype._decodeJwt=function(l){if(this._isEmpty(l))return null;var T=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(l);return!T||T.length<4?(this.warn("The returned id_token is not parseable."),null):{header:T[1],JWSPayload:T[2],JWSSig:T[3]}},U.prototype._convertUrlSafeToRegularBase64EncodedString=function(l){return l.replace("-","+").replace("_","/")},U.prototype._serialize=function(l,h,T){var A=[];if(null!==h){A.push("?response_type="+l),A.push("client_id="+encodeURIComponent(h.clientId)),T&&A.push("resource="+encodeURIComponent(T)),A.push("redirect_uri="+encodeURIComponent(h.redirectUri)),A.push("state="+encodeURIComponent(h.state)),h.hasOwnProperty("slice")&&A.push("slice="+encodeURIComponent(h.slice)),h.hasOwnProperty("extraQueryParameter")&&A.push(h.extraQueryParameter);var k=h.correlationId?h.correlationId:this._guid();A.push("client-request-id="+encodeURIComponent(k))}return A.join("&")},U.prototype._deserialize=function(l){var h,T=/\+/g,A=/([^&=]+)=([^&]*)/g,k=function(K){return decodeURIComponent(K.replace(T," "))},P={};for(h=A.exec(l);h;)P[k(h[1])]=k(h[2]),h=A.exec(l);return P},U.prototype._decimalToHex=function(l){for(var h=l.toString(16);h.length<2;)h="0"+h;return h},U.prototype._guid=function(){var l=window.crypto||window.msCrypto;if(l&&l.getRandomValues){var h=new Uint8Array(16);return l.getRandomValues(h),h[6]|=64,h[6]&=79,h[8]|=128,h[8]&=191,this._decimalToHex(h[0])+this._decimalToHex(h[1])+this._decimalToHex(h[2])+this._decimalToHex(h[3])+"-"+this._decimalToHex(h[4])+this._decimalToHex(h[5])+"-"+this._decimalToHex(h[6])+this._decimalToHex(h[7])+"-"+this._decimalToHex(h[8])+this._decimalToHex(h[9])+"-"+this._decimalToHex(h[10])+this._decimalToHex(h[11])+this._decimalToHex(h[12])+this._decimalToHex(h[13])+this._decimalToHex(h[14])+this._decimalToHex(h[15])}for(var T="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",A="0123456789abcdef",k=0,P="",K=0;K<36;K++)"-"!==T[K]&&"4"!==T[K]&&(k=16*Math.random()|0),"x"===T[K]?P+=A[k]:"y"===T[K]?(k&=3,P+=A[k|=8]):P+=T[K];return P},U.prototype._expiresIn=function(l){return l||(l=3599),this._now()+parseInt(l,10)},U.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},U.prototype._addAdalFrame=function(l){if(!(typeof l>"u")){this.info("Add adal frame to document:"+l);var h=document.getElementById(l);if(!h){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var T=document.createElement("iframe");T.setAttribute("id",l),T.setAttribute("aria-hidden","true"),T.style.visibility="hidden",T.style.position="absolute",T.style.width=T.style.height=T.borderWidth="0px",h=document.getElementsByTagName("body")[0].appendChild(T)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+l+'" id="'+l+'" style="display:none"></iframe>');window.frames&&window.frames[l]&&(h=window.frames[l])}return h}},U.prototype._saveItem=function(l,h,T){if(this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation){if(!this._supportsLocalStorage())return this.info("Local storage is not supported"),!1;if(T){var A=this._getItem(l)||"";localStorage.setItem(l,A+h+this.CONSTANTS.CACHE_DELIMETER)}else localStorage.setItem(l,h);return!0}return this._supportsSessionStorage()?(sessionStorage.setItem(l,h),!0):(this.info("Session storage is not supported"),!1)},U.prototype._getItem=function(l){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(l):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(l):(this.info("Session storage is not supported"),null)},U.prototype._supportsLocalStorage=function(){try{return!(!window.localStorage||(window.localStorage.setItem("storageTest","A"),"A"!=window.localStorage.getItem("storageTest"))||(window.localStorage.removeItem("storageTest"),window.localStorage.getItem("storageTest")))}catch{return!1}},U.prototype._supportsSessionStorage=function(){try{return!(!window.sessionStorage||(window.sessionStorage.setItem("storageTest","A"),"A"!=window.sessionStorage.getItem("storageTest"))||(window.sessionStorage.removeItem("storageTest"),window.sessionStorage.getItem("storageTest")))}catch{return!1}},U.prototype._cloneConfig=function(l){if(null===l||"object"!=typeof l)return l;var h={};for(var T in l)l.hasOwnProperty(T)&&(h[T]=l[T]);return h},U.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},U.prototype.log=function(l,h,T,A){if(l<=Logging.level){if(!Logging.piiLoggingEnabled&&A)return;var k=(new Date).toUTCString(),P="";P=this.config.correlationId?k+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[l]+" "+h:k+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[l]+" "+h,T&&(P+="\nstack:\n"+T.stack),Logging.log(P)}},U.prototype.error=function(l,h){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,l,h)},U.prototype.warn=function(l){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,l,null)},U.prototype.info=function(l){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,l,null)},U.prototype.verbose=function(l){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,l,null)},U.prototype.errorPii=function(l,h){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,l,h,!0)},U.prototype.warnPii=function(l){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,l,null,!0)},U.prototype.infoPii=function(l){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,l,null,!0)},U.prototype.verbosePii=function(l){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,l,null,!0)},U.prototype._libVersion=function(){return"1.0.18"},st.exports&&(st.exports=U,st.exports.inject=function(l){return new U(l)}),U}()},76447:(st,U,l)=>{"use strict";l.d(U,{Tg:()=>at,zr:()=>Er,Ct:()=>nr});var h=l(15861),T=l(41571),A=l(36895),k=l(80529),P=l(77579),K=l(39646),ne=l(50457),le=l(69751),_e=l(38421);const{isArray:Ae}=Array;var D=l(25403);var O=l(62843),ut=l(39841),dt=l(56451),ue=l(39300),qe=l(18505),Te=l(78372),se=l(34986),j=l(97272),z=l(95698),W=l(54482),Ce=l(25032),fe=l(69718),b=l(95577);function M(R,w){return w?a=>(0,j.z)(w.pipe((0,z.q)(1),function v(){return(0,W.e)((R,w)=>{R.subscribe((0,D.x)(w,Ce.Z))})}()),a.pipe(M(R))):(0,b.z)((a,f)=>R(a,f).pipe((0,z.q)(1),(0,fe.h)(a)))}var G=l(82805);function ae(R,w=se.z){const a=(0,G.H)(R,w);return M(()=>a)}var Z=l(63900),Ze=l(54004),be=l(50590),We=l(70262),Ht=l(51165),_t=l(83888),St=l(39672);const Qe=(0,_t.d)(R=>function(a=null){R(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=a});function oe(R){throw new Qe(R)}class et{validateSignature(w){return Promise.resolve(null)}validateAtHash(w){return Promise.resolve(!0)}}class Ve{}class Pt{}let Rt=(()=>{class R extends Pt{now(){return Date.now()}new(){return new Date}}return R.\u0275fac=function(){let w;return function(f){return(w||(w=T.\u0275\u0275getInheritedFactory(R)))(f||R)}}(),R.\u0275prov=T.\u0275\u0275defineInjectable({token:R,factory:R.\u0275fac}),R})();class Le{}class ke{}let ge=(()=>{class R{constructor(){this.data=new Map}getItem(a){return this.data.get(a)}removeItem(a){this.data.delete(a)}setItem(a,f){this.data.set(a,f)}}return R.\u0275fac=function(a){return new(a||R)},R.\u0275prov=T.\u0275\u0275defineInjectable({token:R,factory:R.\u0275fac}),R})();class kt{constructor(w){this.type=w}}class Oe extends kt{constructor(w,a=null){super(w),this.info=a}}class Pe extends kt{constructor(w,a=null){super(w),this.info=a}}class ye extends kt{constructor(w,a,f=null){super(w),this.reason=a,this.params=f}}function tt(R){const w=R.replace(/\-/g,"+").replace(/\_/g,"/");return decodeURIComponent(atob(w).split("").map(function(a){return"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)}).join(""))}function Je(R){return btoa(R).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}class at{constructor(w){this.clientId="",this.redirectUri="",this.postLogoutRedirectUri="",this.redirectUriAsPostLogoutRedirectUriFallback=!0,this.loginUrl="",this.scope="openid profile",this.resource="",this.rngUrl="",this.oidc=!0,this.requestAccessToken=!0,this.options=null,this.issuer="",this.logoutUrl="",this.clearHashAfterLogin=!0,this.tokenEndpoint=null,this.revocationEndpoint=null,this.customTokenParameters=[],this.userinfoEndpoint=null,this.responseType="",this.showDebugInformation=!1,this.silentRefreshRedirectUri="",this.silentRefreshMessagePrefix="",this.silentRefreshShowIFrame=!1,this.siletRefreshTimeout=2e4,this.silentRefreshTimeout=2e4,this.dummyClientSecret="",this.requireHttps="remoteOnly",this.strictDiscoveryDocumentValidation=!0,this.jwks=null,this.customQueryParams=null,this.silentRefreshIFrameName="angular-oauth-oidc-silent-refresh-iframe",this.timeoutFactor=.75,this.sessionChecksEnabled=!1,this.sessionCheckIntervall=3e3,this.sessionCheckIFrameUrl=null,this.sessionCheckIFrameName="angular-oauth-oidc-check-session-iframe",this.disableAtHashCheck=!1,this.skipSubjectCheck=!1,this.useIdTokenHintForSilentRefresh=!1,this.skipIssuerCheck=!1,this.nonceStateSeparator=";",this.useHttpBasicAuth=!1,this.decreaseExpirationBySec=0,this.waitForTokenInMsec=0,this.disablePKCE=!1,this.preserveRequestedRoute=!1,this.disableIdTokenTimer=!1,this.checkOrigin=!1,this.openUri=a=>{location.href=a},w&&Object.assign(this,w)}}class H{encodeKey(w){return encodeURIComponent(w)}encodeValue(w){return encodeURIComponent(w)}decodeKey(w){return decodeURIComponent(w)}decodeValue(w){return decodeURIComponent(w)}}class B{}let Q=(()=>{class R{getHashFragmentParams(a){let f=a||window.location.hash;if(f=decodeURIComponent(f),0!==f.indexOf("#"))return{};const y=f.indexOf("?");return f=f.substr(y>-1?y+1:1),this.parseQueryString(f)}parseQueryString(a){const f={};let y,m,E,I,x,J,X;if(null===a)return f;y=a.split("&");for(let L=0;L<y.length;L++)m=y[L],E=m.indexOf("="),-1===E?(I=m,x=null):(I=m.substr(0,E),x=m.substr(E+1)),J=decodeURIComponent(I),X=decodeURIComponent(x),"/"===J.substr(0,1)&&(J=J.substr(1)),f[J]=X;return f}}return R.\u0275fac=function(a){return new(a||R)},R.\u0275prov=T.\u0275\u0275defineInjectable({token:R,factory:R.\u0275fac}),R})();const ht=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function Be(R,w,a,f,y){let m,E,I,x,J,X,L,Y,$,ce,Re,yt,pt;for(;y>=64;){for(m=w[0],E=w[1],I=w[2],x=w[3],J=w[4],X=w[5],L=w[6],Y=w[7],ce=0;ce<16;ce++)Re=f+4*ce,R[ce]=(255&a[Re])<<24|(255&a[Re+1])<<16|(255&a[Re+2])<<8|255&a[Re+3];for(ce=16;ce<64;ce++)$=R[ce-2],yt=($>>>17|$<<15)^($>>>19|$<<13)^$>>>10,$=R[ce-15],pt=($>>>7|$<<25)^($>>>18|$<<14)^$>>>3,R[ce]=(yt+R[ce-7]|0)+(pt+R[ce-16]|0);for(ce=0;ce<64;ce++)yt=(((J>>>6|J<<26)^(J>>>11|J<<21)^(J>>>25|J<<7))+(J&X^~J&L)|0)+(Y+(ht[ce]+R[ce]|0)|0)|0,pt=((m>>>2|m<<30)^(m>>>13|m<<19)^(m>>>22|m<<10))+(m&E^m&I^E&I)|0,Y=L,L=X,X=J,J=x+yt|0,x=I,I=E,E=m,m=yt+pt|0;w[0]+=m,w[1]+=E,w[2]+=I,w[3]+=x,w[4]+=J,w[5]+=X,w[6]+=L,w[7]+=Y,f+=64,y-=64}return f}class je{constructor(){this.digestLength=32,this.blockSize=64,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}reset(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this}clean(){for(let w=0;w<this.buffer.length;w++)this.buffer[w]=0;for(let w=0;w<this.temp.length;w++)this.temp[w]=0;this.reset()}update(w,a=w.length){if(this.finished)throw new Error("SHA256: can't update because hash was finished.");let f=0;if(this.bytesHashed+=a,this.bufferLength>0){for(;this.bufferLength<64&&a>0;)this.buffer[this.bufferLength++]=w[f++],a--;64===this.bufferLength&&(Be(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(a>=64&&(f=Be(this.temp,this.state,w,f,a),a%=64);a>0;)this.buffer[this.bufferLength++]=w[f++],a--;return this}finish(w){if(!this.finished){const a=this.bytesHashed,f=this.bufferLength,y=a/536870912|0,m=a<<3,E=a%64<56?64:128;this.buffer[f]=128;for(let I=f+1;I<E-8;I++)this.buffer[I]=0;this.buffer[E-8]=y>>>24&255,this.buffer[E-7]=y>>>16&255,this.buffer[E-6]=y>>>8&255,this.buffer[E-5]=y>>>0&255,this.buffer[E-4]=m>>>24&255,this.buffer[E-3]=m>>>16&255,this.buffer[E-2]=m>>>8&255,this.buffer[E-1]=m>>>0&255,Be(this.temp,this.state,this.buffer,0,E),this.finished=!0}for(let a=0;a<8;a++)w[4*a+0]=this.state[a]>>>24&255,w[4*a+1]=this.state[a]>>>16&255,w[4*a+2]=this.state[a]>>>8&255,w[4*a+3]=this.state[a]>>>0&255;return this}digest(){const w=new Uint8Array(this.digestLength);return this.finish(w),w}_saveState(w){for(let a=0;a<this.state.length;a++)w[a]=this.state[a]}_restoreState(w,a){for(let f=0;f<this.state.length;f++)this.state[f]=w[f];this.bytesHashed=a,this.finished=!1,this.bufferLength=0}}new Uint8Array(32);class V{}let Ot=(()=>{class R{calcHash(a,f){return(0,h.Z)(function*(){return function rr(R){var w,a=[];for(w=0;w<R.length;w++)a.push(String.fromCharCode(R[w]));return a.join("")}(function ct(R){const w=(new je).update(R),a=w.digest();return w.clean(),a}(function kr(R){if("string"!=typeof R)throw new TypeError("expected string");var w,a=R,f=new Uint8Array(a.length);for(w=0;w<a.length;w++)f[w]=a.charCodeAt(w);return f}(a)))})()}toHashString2(a){let f="";for(let y of a)f+=String.fromCharCode(y);return f}toHashString(a){const f=new Uint8Array(a);let y="";for(let m of f)y+=String.fromCharCode(m);return y}}return R.\u0275fac=function(a){return new(a||R)},R.\u0275prov=T.\u0275\u0275defineInjectable({token:R,factory:R.\u0275fac}),R})(),nr=(()=>{class R extends at{constructor(a,f,y,m,E,I,x,J,X,L){super(),this.ngZone=a,this.http=f,this.config=E,this.urlHelper=I,this.logger=x,this.crypto=J,this.dateTimeService=L,this.discoveryDocumentLoaded=!1,this.state="",this.eventsSubject=new P.x,this.discoveryDocumentLoadedSubject=new P.x,this.grantTypesSupported=[],this.inImplicitFlow=!1,this.saveNoncesInLocalStorage=!1,this.debug("angular-oauth2-oidc v10"),this.document=X,E||(E={}),this.discoveryDocumentLoaded$=this.discoveryDocumentLoadedSubject.asObservable(),this.events=this.eventsSubject.asObservable(),m&&(this.tokenValidationHandler=m),E&&this.configure(E);try{y?this.setStorage(y):typeof sessionStorage<"u"&&this.setStorage(sessionStorage)}catch(Y){console.error("No OAuthStorage provided and cannot access default (sessionStorage).Consider providing a custom OAuthStorage implementation in your module.",Y)}if(this.checkLocalStorageAccessable()){const Y=window?.navigator?.userAgent;(Y?.includes("MSIE ")||Y?.includes("Trident"))&&(this.saveNoncesInLocalStorage=!0)}this.setupRefreshTimer()}checkLocalStorageAccessable(){if(typeof window>"u")return!1;const a="test";try{return!(typeof window.localStorage>"u"||(localStorage.setItem(a,a),localStorage.removeItem(a),0))}catch{return!1}}configure(a){Object.assign(this,new at,a),this.config=Object.assign({},new at,a),this.sessionChecksEnabled&&this.setupSessionCheck(),this.configChanged()}configChanged(){this.setupRefreshTimer()}restartSessionChecksIfStillLoggedIn(){this.hasValidIdToken()&&this.initSessionCheck()}restartRefreshTimerIfStillLoggedIn(){this.setupExpirationTimers()}setupSessionCheck(){this.events.pipe((0,ue.h)(a=>"token_received"===a.type)).subscribe(a=>{this.initSessionCheck()})}setupAutomaticSilentRefresh(a={},f,y=!0){let m=!0;this.clearAutomaticRefreshTimer(),this.automaticRefreshSubscription=this.events.pipe((0,qe.b)(E=>{"token_received"===E.type?m=!0:"logout"===E.type&&(m=!1)}),(0,ue.h)(E=>"token_expires"===E.type&&(null==f||"any"===f||E.info===f)),(0,Te.b)(1e3)).subscribe(E=>{m&&this.refreshInternal(a,y).catch(I=>{this.debug("Automatic silent refresh did not work")})}),this.restartRefreshTimerIfStillLoggedIn()}refreshInternal(a,f){return this.useSilentRefresh||"code"!==this.responseType?this.silentRefresh(a,f):this.refreshToken()}loadDiscoveryDocumentAndTryLogin(a=null){return this.loadDiscoveryDocument().then(f=>this.tryLogin(a))}loadDiscoveryDocumentAndLogin(a=null){return this.loadDiscoveryDocumentAndTryLogin(a=a||{}).then(f=>!(!this.hasValidIdToken()||!this.hasValidAccessToken())||(this.initLoginFlow("string"==typeof a.state?a.state:""),!1))}debug(...a){this.showDebugInformation&&this.logger.debug.apply(this.logger,a)}validateUrlFromDiscoveryDocument(a){const f=[],y=this.validateUrlForHttps(a),m=this.validateUrlAgainstIssuer(a);return y||f.push("https for all urls required. Also for urls received by discovery."),m||f.push("Every url in discovery document has to start with the issuer url.Also see property strictDiscoveryDocumentValidation."),f}validateUrlForHttps(a){if(!a)return!0;const f=a.toLowerCase();return!(!1!==this.requireHttps&&(!f.match(/^http:\/\/localhost($|[:\/])/)&&!f.match(/^http:\/\/localhost($|[:\/])/)||"remoteOnly"!==this.requireHttps))||f.startsWith("https://")}assertUrlNotNullAndCorrectProtocol(a,f){if(!a)throw new Error(`'${f}' should not be null`);if(!this.validateUrlForHttps(a))throw new Error(`'${f}' must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).`)}validateUrlAgainstIssuer(a){return!this.strictDiscoveryDocumentValidation||!a||a.toLowerCase().startsWith(this.issuer.toLowerCase())}setupRefreshTimer(){typeof window>"u"?this.debug("timer not supported on this plattform"):((this.hasValidIdToken()||this.hasValidAccessToken())&&(this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.setupExpirationTimers()),this.tokenReceivedSubscription&&this.tokenReceivedSubscription.unsubscribe(),this.tokenReceivedSubscription=this.events.pipe((0,ue.h)(a=>"token_received"===a.type)).subscribe(a=>{this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.setupExpirationTimers()}))}setupExpirationTimers(){this.hasValidAccessToken()&&this.setupAccessTokenTimer(),!this.disableIdTokenTimer&&this.hasValidIdToken()&&this.setupIdTokenTimer()}setupAccessTokenTimer(){const a=this.getAccessTokenExpiration(),f=this.getAccessTokenStoredAt(),y=this.calcTimeout(f,a);this.ngZone.runOutsideAngular(()=>{this.accessTokenTimeoutSubscription=(0,K.of)(new Pe("token_expires","access_token")).pipe(ae(y)).subscribe(m=>{this.ngZone.run(()=>{this.eventsSubject.next(m)})})})}setupIdTokenTimer(){const a=this.getIdTokenExpiration(),f=this.getIdTokenStoredAt(),y=this.calcTimeout(f,a);this.ngZone.runOutsideAngular(()=>{this.idTokenTimeoutSubscription=(0,K.of)(new Pe("token_expires","id_token")).pipe(ae(y)).subscribe(m=>{this.ngZone.run(()=>{this.eventsSubject.next(m)})})})}stopAutomaticRefresh(){this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.clearAutomaticRefreshTimer()}clearAccessTokenTimer(){this.accessTokenTimeoutSubscription&&this.accessTokenTimeoutSubscription.unsubscribe()}clearIdTokenTimer(){this.idTokenTimeoutSubscription&&this.idTokenTimeoutSubscription.unsubscribe()}clearAutomaticRefreshTimer(){this.automaticRefreshSubscription&&this.automaticRefreshSubscription.unsubscribe()}calcTimeout(a,f){const y=this.dateTimeService.now(),E=Math.max(0,(f-a)*this.timeoutFactor-(y-a)),I=2147483647;return E>I?I:E}setStorage(a){this._storage=a,this.configChanged()}loadDiscoveryDocument(a=null){return new Promise((f,y)=>{a||((a=this.issuer||"").endsWith("/")||(a+="/"),a+=".well-known/openid-configuration"),this.validateUrlForHttps(a)?this.http.get(a).subscribe(m=>{if(!this.validateDiscoveryDocument(m))return this.eventsSubject.next(new ye("discovery_document_validation_error",null)),void y("discovery_document_validation_error");this.loginUrl=m.authorization_endpoint,this.logoutUrl=m.end_session_endpoint||this.logoutUrl,this.grantTypesSupported=m.grant_types_supported,this.issuer=m.issuer,this.tokenEndpoint=m.token_endpoint,this.userinfoEndpoint=m.userinfo_endpoint||this.userinfoEndpoint,this.jwksUri=m.jwks_uri,this.sessionCheckIFrameUrl=m.check_session_iframe||this.sessionCheckIFrameUrl,this.discoveryDocumentLoaded=!0,this.discoveryDocumentLoadedSubject.next(m),this.revocationEndpoint=m.revocation_endpoint||this.revocationEndpoint,this.sessionChecksEnabled&&this.restartSessionChecksIfStillLoggedIn(),this.loadJwks().then(E=>{const x=new Oe("discovery_document_loaded",{discoveryDocument:m,jwks:E});this.eventsSubject.next(x),f(x)}).catch(E=>{this.eventsSubject.next(new ye("discovery_document_load_error",E)),y(E)})},m=>{this.logger.error("error loading discovery document",m),this.eventsSubject.next(new ye("discovery_document_load_error",m)),y(m)}):y("issuer  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).")})}loadJwks(){return new Promise((a,f)=>{this.jwksUri?this.http.get(this.jwksUri).subscribe(y=>{this.jwks=y,a(y)},y=>{this.logger.error("error loading jwks",y),this.eventsSubject.next(new ye("jwks_load_error",y)),f(y)}):a(null)})}validateDiscoveryDocument(a){let f;return this.skipIssuerCheck||a.issuer===this.issuer?(f=this.validateUrlFromDiscoveryDocument(a.authorization_endpoint),f.length>0?(this.logger.error("error validating authorization_endpoint in discovery document",f),!1):(f=this.validateUrlFromDiscoveryDocument(a.end_session_endpoint),f.length>0?(this.logger.error("error validating end_session_endpoint in discovery document",f),!1):(f=this.validateUrlFromDiscoveryDocument(a.token_endpoint),f.length>0&&this.logger.error("error validating token_endpoint in discovery document",f),f=this.validateUrlFromDiscoveryDocument(a.revocation_endpoint),f.length>0&&this.logger.error("error validating revocation_endpoint in discovery document",f),f=this.validateUrlFromDiscoveryDocument(a.userinfo_endpoint),f.length>0?(this.logger.error("error validating userinfo_endpoint in discovery document",f),!1):(f=this.validateUrlFromDiscoveryDocument(a.jwks_uri),f.length>0?(this.logger.error("error validating jwks_uri in discovery document",f),!1):(this.sessionChecksEnabled&&!a.check_session_iframe&&this.logger.warn("sessionChecksEnabled is activated but discovery document does not contain a check_session_iframe field"),!0))))):(this.logger.error("invalid issuer in discovery document","expected: "+this.issuer,"current: "+a.issuer),!1)}fetchTokenUsingPasswordFlowAndLoadUserProfile(a,f,y=new k.WM){return this.fetchTokenUsingPasswordFlow(a,f,y).then(()=>this.loadUserProfile())}loadUserProfile(){if(!this.hasValidAccessToken())throw new Error("Can not load User Profile without access_token");if(!this.validateUrlForHttps(this.userinfoEndpoint))throw new Error("userinfoEndpoint must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");return new Promise((a,f)=>{const y=(new k.WM).set("Authorization","Bearer "+this.getAccessToken());this.http.get(this.userinfoEndpoint,{headers:y,observe:"response",responseType:"text"}).subscribe(m=>{if(this.debug("userinfo received",JSON.stringify(m)),m.headers.get("content-type").startsWith("application/json")){let E=JSON.parse(m.body);const I=this.getIdentityClaims()||{};if(!this.skipSubjectCheck&&this.oidc&&(!I.sub||E.sub!==I.sub))return void f("if property oidc is true, the received user-id (sub) has to be the user-id of the user that has logged in with oidc.\nif you are not using oidc but just oauth2 password flow set oidc to false");E=Object.assign({},I,E),this._storage.setItem("id_token_claims_obj",JSON.stringify(E)),this.eventsSubject.next(new Oe("user_profile_loaded")),a({info:E})}else this.debug("userinfo is not JSON, treating it as JWE/JWS"),this.eventsSubject.next(new Oe("user_profile_loaded")),a(JSON.parse(m.body))},m=>{this.logger.error("error loading user info",m),this.eventsSubject.next(new ye("user_profile_load_error",m)),f(m)})})}fetchTokenUsingPasswordFlow(a,f,y=new k.WM){return this.fetchTokenUsingGrant("password",{username:a,password:f},y)}fetchTokenUsingGrant(a,f,y=new k.WM){this.assertUrlNotNullAndCorrectProtocol(this.tokenEndpoint,"tokenEndpoint");let m=new k.LE({encoder:new H}).set("grant_type",a).set("scope",this.scope);if(this.useHttpBasicAuth){const E=btoa(`${this.clientId}:${this.dummyClientSecret}`);y=y.set("Authorization","Basic "+E)}if(this.useHttpBasicAuth||(m=m.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(m=m.set("client_secret",this.dummyClientSecret)),this.customQueryParams)for(const E of Object.getOwnPropertyNames(this.customQueryParams))m=m.set(E,this.customQueryParams[E]);for(const E of Object.keys(f))m=m.set(E,f[E]);return y=y.set("Content-Type","application/x-www-form-urlencoded"),new Promise((E,I)=>{this.http.post(this.tokenEndpoint,m,{headers:y}).subscribe(x=>{this.debug("tokenResponse",x),this.storeAccessTokenResponse(x.access_token,x.refresh_token,x.expires_in||this.fallbackAccessTokenExpirationTimeInSec,x.scope,this.extractRecognizedCustomParameters(x)),this.oidc&&x.id_token&&this.processIdToken(x.id_token,x.access_token).then(J=>{this.storeIdToken(J),E(x)}),this.eventsSubject.next(new Oe("token_received")),E(x)},x=>{this.logger.error("Error performing ${grantType} flow",x),this.eventsSubject.next(new ye("token_error",x)),I(x)})})}refreshToken(){return this.assertUrlNotNullAndCorrectProtocol(this.tokenEndpoint,"tokenEndpoint"),new Promise((a,f)=>{let y=new k.LE({encoder:new H}).set("grant_type","refresh_token").set("scope",this.scope).set("refresh_token",this._storage.getItem("refresh_token")),m=(new k.WM).set("Content-Type","application/x-www-form-urlencoded");if(this.useHttpBasicAuth){const E=btoa(`${this.clientId}:${this.dummyClientSecret}`);m=m.set("Authorization","Basic "+E)}if(this.useHttpBasicAuth||(y=y.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(y=y.set("client_secret",this.dummyClientSecret)),this.customQueryParams)for(const E of Object.getOwnPropertyNames(this.customQueryParams))y=y.set(E,this.customQueryParams[E]);this.http.post(this.tokenEndpoint,y,{headers:m}).pipe((0,Z.w)(E=>this.oidc&&E.id_token?(0,ne.D)(this.processIdToken(E.id_token,E.access_token,!0)).pipe((0,qe.b)(I=>this.storeIdToken(I)),(0,Ze.U)(I=>E)):(0,K.of)(E))).subscribe(E=>{this.debug("refresh tokenResponse",E),this.storeAccessTokenResponse(E.access_token,E.refresh_token,E.expires_in||this.fallbackAccessTokenExpirationTimeInSec,E.scope,this.extractRecognizedCustomParameters(E)),this.eventsSubject.next(new Oe("token_received")),this.eventsSubject.next(new Oe("token_refreshed")),a(E)},E=>{this.logger.error("Error refreshing token",E),this.eventsSubject.next(new ye("token_refresh_error",E)),f(E)})})}removeSilentRefreshEventListener(){this.silentRefreshPostMessageEventListener&&(window.removeEventListener("message",this.silentRefreshPostMessageEventListener),this.silentRefreshPostMessageEventListener=null)}setupSilentRefreshEventListener(){this.removeSilentRefreshEventListener(),this.silentRefreshPostMessageEventListener=a=>{const f=this.processMessageEventMessage(a);this.checkOrigin&&a.origin!==location.origin&&console.error("wrong origin requested silent refresh!"),this.tryLogin({customHashFragment:f,preventClearHashAfterLogin:!0,customRedirectUri:this.silentRefreshRedirectUri||this.redirectUri}).catch(y=>this.debug("tryLogin during silent refresh failed",y))},window.addEventListener("message",this.silentRefreshPostMessageEventListener)}silentRefresh(a={},f=!0){const y=this.getIdentityClaims()||{};if(this.useIdTokenHintForSilentRefresh&&this.hasValidIdToken()&&(a.id_token_hint=this.getIdToken()),!this.validateUrlForHttps(this.loginUrl))throw new Error("loginUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");if(typeof this.document>"u")throw new Error("silent refresh is not supported on this platform");const m=this.document.getElementById(this.silentRefreshIFrameName);m&&this.document.body.removeChild(m),this.silentRefreshSubject=y.sub;const E=this.document.createElement("iframe");return E.id=this.silentRefreshIFrameName,this.setupSilentRefreshEventListener(),this.createLoginUrl(null,null,this.silentRefreshRedirectUri||this.redirectUri,f,a).then(L=>{E.setAttribute("src",L),this.silentRefreshShowIFrame||(E.style.display="none"),this.document.body.appendChild(E)}),function mt(...R){return 1===(R=function he(R){return 1===R.length&&Ae(R[0])?R[0]:R}(R)).length?(0,_e.Xf)(R[0]):new le.y(function p(R){return w=>{let a=[];for(let f=0;a&&!w.closed&&f<R.length;f++)a.push((0,_e.Xf)(R[f]).subscribe((0,D.x)(w,y=>{if(a){for(let m=0;m<a.length;m++)m!==f&&a[m].unsubscribe();a=null}w.next(y)})))}}(R))}([this.events.pipe((0,ue.h)(L=>L instanceof ye),(0,be.P)()),this.events.pipe((0,ue.h)(L=>"token_received"===L.type),(0,be.P)()),(0,K.of)(new ye("silent_refresh_timeout",null)).pipe(ae(this.silentRefreshTimeout))]).pipe((0,Ze.U)(L=>{if(L instanceof ye)throw"silent_refresh_timeout"===L.type||(L=new ye("silent_refresh_error",L)),this.eventsSubject.next(L),L;return"token_received"===L.type&&(L=new Oe("silently_refreshed"),this.eventsSubject.next(L)),L})).toPromise()}initImplicitFlowInPopup(a){return this.initLoginFlowInPopup(a)}initLoginFlowInPopup(a){return a=a||{},this.createLoginUrl(null,null,this.silentRefreshRedirectUri,!1,{display:"popup"}).then(f=>new Promise((y,m)=>{let x,I=null;a.windowRef?a.windowRef&&!a.windowRef.closed&&(I=a.windowRef,I.location.href=f):I=window.open(f,"ngx-oauth2-oidc-login",this.calculatePopupFeatures(a));const J=ce=>{this.tryLogin({customHashFragment:ce,preventClearHashAfterLogin:!0,customRedirectUri:this.silentRefreshRedirectUri}).then(()=>{L(),y(!0)},Re=>{L(),m(Re)})};I?x=window.setInterval(()=>{(!I||I.closed)&&(L(),m(new ye("popup_closed",{})))},500):m(new ye("popup_blocked",{}));const L=()=>{window.clearInterval(x),window.removeEventListener("storage",$),window.removeEventListener("message",Y),null!==I&&I.close(),I=null},Y=ce=>{const Re=this.processMessageEventMessage(ce);Re&&null!==Re?(window.removeEventListener("storage",$),J(Re)):console.log("false event firing")},$=ce=>{"auth_hash"===ce.key&&(window.removeEventListener("message",Y),J(ce.newValue))};window.addEventListener("message",Y),window.addEventListener("storage",$)}))}calculatePopupFeatures(a){const f=a.height||470,y=a.width||500,m=window.screenLeft+(window.outerWidth-y)/2;return`location=no,toolbar=no,width=${y},height=${f},top=${window.screenTop+(window.outerHeight-f)/2},left=${m}`}processMessageEventMessage(a){let f="#";if(this.silentRefreshMessagePrefix&&(f+=this.silentRefreshMessagePrefix),!a||!a.data||"string"!=typeof a.data)return;const y=a.data;return y.startsWith(f)?"#"+y.substr(f.length):void 0}canPerformSessionCheck(){return!(!this.sessionChecksEnabled||(this.sessionCheckIFrameUrl?this.getSessionState()?typeof this.document>"u":(console.warn("sessionChecksEnabled is activated but there is no session_state"),1):(console.warn("sessionChecksEnabled is activated but there is no sessionCheckIFrameUrl"),1)))}setupSessionCheckEventListener(){this.removeSessionCheckEventListener(),this.sessionCheckEventListener=a=>{const f=a.origin.toLowerCase(),y=this.issuer.toLowerCase();if(this.debug("sessionCheckEventListener"),y.startsWith(f)){switch(a.data){case"unchanged":this.ngZone.run(()=>{this.handleSessionUnchanged()});break;case"changed":this.ngZone.run(()=>{this.handleSessionChange()});break;case"error":this.ngZone.run(()=>{this.handleSessionError()})}this.debug("got info from session check inframe",a)}else this.debug("sessionCheckEventListener","wrong origin",f,"expected",y,"event",a)},this.ngZone.runOutsideAngular(()=>{window.addEventListener("message",this.sessionCheckEventListener)})}handleSessionUnchanged(){this.debug("session check","session unchanged"),this.eventsSubject.next(new Pe("session_unchanged"))}handleSessionChange(){this.eventsSubject.next(new Pe("session_changed")),this.stopSessionCheckTimer(),this.useSilentRefresh||"code"!==this.responseType?this.silentRefreshRedirectUri?(this.silentRefresh().catch(a=>this.debug("silent refresh failed after session changed")),this.waitForSilentRefreshAfterSessionChange()):(this.eventsSubject.next(new Pe("session_terminated")),this.logOut(!0)):this.refreshToken().then(a=>{this.debug("token refresh after session change worked")}).catch(a=>{this.debug("token refresh did not work after session changed"),this.eventsSubject.next(new Pe("session_terminated")),this.logOut(!0)})}waitForSilentRefreshAfterSessionChange(){this.events.pipe((0,ue.h)(a=>"silently_refreshed"===a.type||"silent_refresh_timeout"===a.type||"silent_refresh_error"===a.type),(0,be.P)()).subscribe(a=>{"silently_refreshed"!==a.type&&(this.debug("silent refresh did not work after session changed"),this.eventsSubject.next(new Pe("session_terminated")),this.logOut(!0))})}handleSessionError(){this.stopSessionCheckTimer(),this.eventsSubject.next(new Pe("session_error"))}removeSessionCheckEventListener(){this.sessionCheckEventListener&&(window.removeEventListener("message",this.sessionCheckEventListener),this.sessionCheckEventListener=null)}initSessionCheck(){if(!this.canPerformSessionCheck())return;const a=this.document.getElementById(this.sessionCheckIFrameName);a&&this.document.body.removeChild(a);const f=this.document.createElement("iframe");f.id=this.sessionCheckIFrameName,this.setupSessionCheckEventListener(),f.setAttribute("src",this.sessionCheckIFrameUrl),f.style.display="none",this.document.body.appendChild(f),this.startSessionCheckTimer()}startSessionCheckTimer(){this.stopSessionCheckTimer(),this.ngZone.runOutsideAngular(()=>{this.sessionCheckTimer=setInterval(this.checkSession.bind(this),this.sessionCheckIntervall)})}stopSessionCheckTimer(){this.sessionCheckTimer&&(clearInterval(this.sessionCheckTimer),this.sessionCheckTimer=null)}checkSession(){const a=this.document.getElementById(this.sessionCheckIFrameName);a||this.logger.warn("checkSession did not find iframe",this.sessionCheckIFrameName);const f=this.getSessionState();f||this.stopSessionCheckTimer(),a.contentWindow.postMessage(this.clientId+" "+f,this.issuer)}createLoginUrl(a="",f="",y="",m=!1,E={}){var I=this;return(0,h.Z)(function*(){const x=I;let J;J=y||I.redirectUri;const X=yield I.createAndSaveNonce();if(a=a?X+I.config.nonceStateSeparator+encodeURIComponent(a):X,!I.requestAccessToken&&!I.oidc)throw new Error("Either requestAccessToken or oidc or both must be true");I.responseType=I.config.responseType?I.config.responseType:I.oidc&&I.requestAccessToken?"id_token token":I.oidc&&!I.requestAccessToken?"id_token":"token";const L=x.loginUrl.indexOf("?")>-1?"&":"?";let Y=x.scope;I.oidc&&!Y.match(/(^|\s)openid($|\s)/)&&(Y="openid "+Y);let $=x.loginUrl+L+"response_type="+encodeURIComponent(x.responseType)+"&client_id="+encodeURIComponent(x.clientId)+"&state="+encodeURIComponent(a)+"&redirect_uri="+encodeURIComponent(J)+"&scope="+encodeURIComponent(Y);if(I.responseType.includes("code")&&!I.disablePKCE){const[ce,Re]=yield I.createChallangeVerifierPairForPKCE();I.saveNoncesInLocalStorage&&typeof window.localStorage<"u"?localStorage.setItem("PKCE_verifier",Re):I._storage.setItem("PKCE_verifier",Re),$+="&code_challenge="+ce,$+="&code_challenge_method=S256"}f&&($+="&login_hint="+encodeURIComponent(f)),x.resource&&($+="&resource="+encodeURIComponent(x.resource)),x.oidc&&($+="&nonce="+encodeURIComponent(X)),m&&($+="&prompt=none");for(const ce of Object.keys(E))$+="&"+encodeURIComponent(ce)+"="+encodeURIComponent(E[ce]);if(I.customQueryParams)for(const ce of Object.getOwnPropertyNames(I.customQueryParams))$+="&"+ce+"="+encodeURIComponent(I.customQueryParams[ce]);return $})()}initImplicitFlowInternal(a="",f=""){if(this.inImplicitFlow)return;if(this.inImplicitFlow=!0,!this.validateUrlForHttps(this.loginUrl))throw new Error("loginUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");let y={},m=null;"string"==typeof f?m=f:"object"==typeof f&&(y=f),this.createLoginUrl(a,m,null,!1,y).then(this.config.openUri).catch(E=>{console.error("Error in initImplicitFlow",E),this.inImplicitFlow=!1})}initImplicitFlow(a="",f=""){""!==this.loginUrl?this.initImplicitFlowInternal(a,f):this.events.pipe((0,ue.h)(y=>"discovery_document_loaded"===y.type)).subscribe(y=>this.initImplicitFlowInternal(a,f))}resetImplicitFlow(){this.inImplicitFlow=!1}callOnTokenReceivedIfExists(a){const f=this;if(a.onTokenReceived){const y={idClaims:f.getIdentityClaims(),idToken:f.getIdToken(),accessToken:f.getAccessToken(),state:f.state};a.onTokenReceived(y)}}storeAccessTokenResponse(a,f,y,m,E){if(this._storage.setItem("access_token",a),m&&!Array.isArray(m)?this._storage.setItem("granted_scopes",JSON.stringify(m.split(" "))):m&&Array.isArray(m)&&this._storage.setItem("granted_scopes",JSON.stringify(m)),this._storage.setItem("access_token_stored_at",""+this.dateTimeService.now()),y){const I=1e3*y,J=this.dateTimeService.new().getTime()+I;this._storage.setItem("expires_at",""+J)}f&&this._storage.setItem("refresh_token",f),E&&E.forEach((I,x)=>{this._storage.setItem(x,I)})}tryLogin(a=null){return"code"===this.config.responseType?this.tryLoginCodeFlow(a).then(f=>!0):this.tryLoginImplicitFlow(a)}parseQueryString(a){return a&&0!==a.length?("?"===a.charAt(0)&&(a=a.substr(1)),this.urlHelper.parseQueryString(a)):{}}tryLoginCodeFlow(a=null){var f=this;return(0,h.Z)(function*(){const y=(a=a||{}).customHashFragment?a.customHashFragment.substring(1):window.location.search,m=f.getCodePartsFromUrl(y),E=m.code,I=m.state,x=m.session_state;if(!a.preventClearHashAfterLogin){const L=location.origin+location.pathname+location.search.replace(/code=[^&\$]*/,"").replace(/scope=[^&\$]*/,"").replace(/state=[^&\$]*/,"").replace(/session_state=[^&\$]*/,"").replace(/^\?&/,"?").replace(/&$/,"").replace(/^\?$/,"").replace(/&+/g,"&").replace(/\?&/,"?").replace(/\?$/,"")+location.hash;history.replaceState(null,window.name,L)}let[J,X]=f.parseState(I);if(f.state=X,m.error){f.debug("error trying to login"),f.handleLoginError(a,m);const L=new ye("code_error",{},m);return f.eventsSubject.next(L),Promise.reject(L)}if(!a.disableNonceCheck){if(!J)return f.saveRequestedRoute(),Promise.resolve();if(!a.disableOAuth2StateCheck&&!f.validateNonce(J)){const Y=new ye("invalid_nonce_in_state",null);return f.eventsSubject.next(Y),Promise.reject(Y)}}return f.storeSessionState(x),E&&(yield f.getTokenFromCode(E,a),f.restoreRequestedRoute()),Promise.resolve()})()}saveRequestedRoute(){this.config.preserveRequestedRoute&&this._storage.setItem("requested_route",window.location.pathname+window.location.search)}restoreRequestedRoute(){const a=this._storage.getItem("requested_route");a&&history.replaceState(null,"",window.location.origin+a)}getCodePartsFromUrl(a){return a&&0!==a.length?("?"===a.charAt(0)&&(a=a.substr(1)),this.urlHelper.parseQueryString(a)):this.urlHelper.getHashFragmentParams()}getTokenFromCode(a,f){let y=new k.LE({encoder:new H}).set("grant_type","authorization_code").set("code",a).set("redirect_uri",f.customRedirectUri||this.redirectUri);if(!this.disablePKCE){let m;m=this.saveNoncesInLocalStorage&&typeof window.localStorage<"u"?localStorage.getItem("PKCE_verifier"):this._storage.getItem("PKCE_verifier"),m?y=y.set("code_verifier",m):console.warn("No PKCE verifier found in oauth storage!")}return this.fetchAndProcessToken(y,f)}fetchAndProcessToken(a,f){f=f||{},this.assertUrlNotNullAndCorrectProtocol(this.tokenEndpoint,"tokenEndpoint");let y=(new k.WM).set("Content-Type","application/x-www-form-urlencoded");if(this.useHttpBasicAuth){const m=btoa(`${this.clientId}:${this.dummyClientSecret}`);y=y.set("Authorization","Basic "+m)}return this.useHttpBasicAuth||(a=a.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(a=a.set("client_secret",this.dummyClientSecret)),new Promise((m,E)=>{if(this.customQueryParams)for(let I of Object.getOwnPropertyNames(this.customQueryParams))a=a.set(I,this.customQueryParams[I]);this.http.post(this.tokenEndpoint,a,{headers:y}).subscribe(I=>{this.debug("refresh tokenResponse",I),this.storeAccessTokenResponse(I.access_token,I.refresh_token,I.expires_in||this.fallbackAccessTokenExpirationTimeInSec,I.scope,this.extractRecognizedCustomParameters(I)),this.oidc&&I.id_token?this.processIdToken(I.id_token,I.access_token,f.disableNonceCheck).then(x=>{this.storeIdToken(x),this.eventsSubject.next(new Oe("token_received")),this.eventsSubject.next(new Oe("token_refreshed")),m(I)}).catch(x=>{this.eventsSubject.next(new ye("token_validation_error",x)),console.error("Error validating tokens"),console.error(x),E(x)}):(this.eventsSubject.next(new Oe("token_received")),this.eventsSubject.next(new Oe("token_refreshed")),m(I))},I=>{console.error("Error getting token",I),this.eventsSubject.next(new ye("token_refresh_error",I)),E(I)})})}tryLoginImplicitFlow(a=null){let f;f=(a=a||{}).customHashFragment?this.urlHelper.getHashFragmentParams(a.customHashFragment):this.urlHelper.getHashFragmentParams(),this.debug("parsed url",f);const y=f.state;let[m,E]=this.parseState(y);if(this.state=E,f.error){this.debug("error trying to login"),this.handleLoginError(a,f);const L=new ye("token_error",{},f);return this.eventsSubject.next(L),Promise.reject(L)}const I=f.access_token,x=f.id_token,J=f.session_state,X=f.scope;if(!this.requestAccessToken&&!this.oidc)return Promise.reject("Either requestAccessToken or oidc (or both) must be true.");if(this.requestAccessToken&&!I||this.requestAccessToken&&!a.disableOAuth2StateCheck&&!y||this.oidc&&!x)return Promise.resolve(!1);if(this.sessionChecksEnabled&&!J&&this.logger.warn("session checks (Session Status Change Notification) were activated in the configuration but the id_token does not contain a session_state claim"),this.requestAccessToken&&!a.disableNonceCheck&&!this.validateNonce(m)){const Y=new ye("invalid_nonce_in_state",null);return this.eventsSubject.next(Y),Promise.reject(Y)}return this.requestAccessToken&&this.storeAccessTokenResponse(I,null,f.expires_in||this.fallbackAccessTokenExpirationTimeInSec,X),this.oidc?this.processIdToken(x,I,a.disableNonceCheck).then(L=>a.validationHandler?a.validationHandler({accessToken:I,idClaims:L.idTokenClaims,idToken:L.idToken,state:y}).then(Y=>L):L).then(L=>(this.storeIdToken(L),this.storeSessionState(J),this.clearHashAfterLogin&&!a.preventClearHashAfterLogin&&this.clearLocationHash(),this.eventsSubject.next(new Oe("token_received")),this.callOnTokenReceivedIfExists(a),this.inImplicitFlow=!1,!0)).catch(L=>(this.eventsSubject.next(new ye("token_validation_error",L)),this.logger.error("Error validating tokens"),this.logger.error(L),Promise.reject(L))):(this.eventsSubject.next(new Oe("token_received")),this.clearHashAfterLogin&&!a.preventClearHashAfterLogin&&this.clearLocationHash(),this.callOnTokenReceivedIfExists(a),Promise.resolve(!0))}parseState(a){let f=a,y="";if(a){const m=a.indexOf(this.config.nonceStateSeparator);m>-1&&(f=a.substr(0,m),y=a.substr(m+this.config.nonceStateSeparator.length))}return[f,y]}validateNonce(a){let f;return f=this.saveNoncesInLocalStorage&&typeof window.localStorage<"u"?localStorage.getItem("nonce"):this._storage.getItem("nonce"),f===a||(console.error("Validating access_token failed, wrong state/nonce.",f,a),!1)}storeIdToken(a){this._storage.setItem("id_token",a.idToken),this._storage.setItem("id_token_claims_obj",a.idTokenClaimsJson),this._storage.setItem("id_token_expires_at",""+a.idTokenExpiresAt),this._storage.setItem("id_token_stored_at",""+this.dateTimeService.now())}storeSessionState(a){this._storage.setItem("session_state",a)}getSessionState(){return this._storage.getItem("session_state")}handleLoginError(a,f){a.onLoginError&&a.onLoginError(f),this.clearHashAfterLogin&&!a.preventClearHashAfterLogin&&this.clearLocationHash()}getClockSkewInMsec(a=6e5){return this.clockSkewInSec||0===this.clockSkewInSec?1e3*this.clockSkewInSec:a}processIdToken(a,f,y=!1){const m=a.split("."),I=tt(this.padBase64(m[0])),x=JSON.parse(I),X=tt(this.padBase64(m[1])),L=JSON.parse(X);let Y;if(Y=this.saveNoncesInLocalStorage&&typeof window.localStorage<"u"?localStorage.getItem("nonce"):this._storage.getItem("nonce"),Array.isArray(L.aud)){if(L.aud.every(me=>me!==this.clientId)){const me="Wrong audience: "+L.aud.join(",");return this.logger.warn(me),Promise.reject(me)}}else if(L.aud!==this.clientId){const me="Wrong audience: "+L.aud;return this.logger.warn(me),Promise.reject(me)}if(!L.sub){const me="No sub claim in id_token";return this.logger.warn(me),Promise.reject(me)}if(this.sessionChecksEnabled&&this.silentRefreshSubject&&this.silentRefreshSubject!==L.sub){const me=`After refreshing, we got an id_token for another user (sub). Expected sub: ${this.silentRefreshSubject}, received sub: ${L.sub}`;return this.logger.warn(me),Promise.reject(me)}if(!L.iat){const me="No iat claim in id_token";return this.logger.warn(me),Promise.reject(me)}if(!this.skipIssuerCheck&&L.iss!==this.issuer){const me="Wrong issuer: "+L.iss;return this.logger.warn(me),Promise.reject(me)}if(!y&&L.nonce!==Y){const me="Wrong nonce: "+L.nonce;return this.logger.warn(me),Promise.reject(me)}if(this.hasOwnProperty("responseType")&&("code"===this.responseType||"id_token"===this.responseType)&&(this.disableAtHashCheck=!0),!this.disableAtHashCheck&&this.requestAccessToken&&!L.at_hash){const me="An at_hash is needed!";return this.logger.warn(me),Promise.reject(me)}const $=this.dateTimeService.now(),ce=1e3*L.iat,Re=1e3*L.exp,yt=this.getClockSkewInMsec();if(ce-yt>=$||Re+yt-this.decreaseExpirationBySec<=$){const me="Token has expired";return console.error(me),console.error({now:$,issuedAtMSec:ce,expiresAtMSec:Re}),Promise.reject(me)}const pt={accessToken:f,idToken:a,jwks:this.jwks,idTokenClaims:L,idTokenHeader:x,loadKeys:()=>this.loadJwks()};return this.disableAtHashCheck?this.checkSignature(pt).then(me=>({idToken:a,idTokenClaims:L,idTokenClaimsJson:X,idTokenHeader:x,idTokenHeaderJson:I,idTokenExpiresAt:Re})):this.checkAtHash(pt).then(me=>{if(!this.disableAtHashCheck&&this.requestAccessToken&&!me){const Kt="Wrong at_hash";return this.logger.warn(Kt),Promise.reject(Kt)}return this.checkSignature(pt).then(Kt=>{const Qt={idToken:a,idTokenClaims:L,idTokenClaimsJson:X,idTokenHeader:x,idTokenHeaderJson:I,idTokenExpiresAt:Re};return this.disableAtHashCheck?Qt:this.checkAtHash(pt).then(Mt=>{if(this.requestAccessToken&&!Mt){const ir="Wrong at_hash";return this.logger.warn(ir),Promise.reject(ir)}return Qt})})})}getIdentityClaims(){const a=this._storage.getItem("id_token_claims_obj");return a?JSON.parse(a):null}getGrantedScopes(){const a=this._storage.getItem("granted_scopes");return a?JSON.parse(a):null}getIdToken(){return this._storage?this._storage.getItem("id_token"):null}padBase64(a){for(;a.length%4!=0;)a+="=";return a}getAccessToken(){return this._storage?this._storage.getItem("access_token"):null}getRefreshToken(){return this._storage?this._storage.getItem("refresh_token"):null}getAccessTokenExpiration(){return this._storage.getItem("expires_at")?parseInt(this._storage.getItem("expires_at"),10):null}getAccessTokenStoredAt(){return parseInt(this._storage.getItem("access_token_stored_at"),10)}getIdTokenStoredAt(){return parseInt(this._storage.getItem("id_token_stored_at"),10)}getIdTokenExpiration(){return this._storage.getItem("id_token_expires_at")?parseInt(this._storage.getItem("id_token_expires_at"),10):null}hasValidAccessToken(){if(this.getAccessToken()){const a=this._storage.getItem("expires_at"),f=this.dateTimeService.new();return!(a&&parseInt(a,10)-this.decreaseExpirationBySec<f.getTime()-this.getClockSkewInMsec())}return!1}hasValidIdToken(){if(this.getIdToken()){const a=this._storage.getItem("id_token_expires_at"),f=this.dateTimeService.new();return!(a&&parseInt(a,10)-this.decreaseExpirationBySec<f.getTime()-this.getClockSkewInMsec())}return!1}getCustomTokenResponseProperty(a){return this._storage&&this.config.customTokenParameters&&this.config.customTokenParameters.indexOf(a)>=0&&null!==this._storage.getItem(a)?JSON.parse(this._storage.getItem(a)):null}authorizationHeader(){return"Bearer "+this.getAccessToken()}logOut(a={},f=""){let y=!1;"boolean"==typeof a&&(y=a,a={});const m=this.getIdToken();if(this._storage.removeItem("access_token"),this._storage.removeItem("id_token"),this._storage.removeItem("refresh_token"),this.saveNoncesInLocalStorage?(localStorage.removeItem("nonce"),localStorage.removeItem("PKCE_verifier")):(this._storage.removeItem("nonce"),this._storage.removeItem("PKCE_verifier")),this._storage.removeItem("expires_at"),this._storage.removeItem("id_token_claims_obj"),this._storage.removeItem("id_token_expires_at"),this._storage.removeItem("id_token_stored_at"),this._storage.removeItem("access_token_stored_at"),this._storage.removeItem("granted_scopes"),this._storage.removeItem("session_state"),this.config.customTokenParameters&&this.config.customTokenParameters.forEach(I=>this._storage.removeItem(I)),this.silentRefreshSubject=null,this.eventsSubject.next(new Pe("logout")),!this.logoutUrl||y)return;let E;if(!this.validateUrlForHttps(this.logoutUrl))throw new Error("logoutUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");if(this.logoutUrl.indexOf("{{")>-1)E=this.logoutUrl.replace(/\{\{id_token\}\}/,encodeURIComponent(m)).replace(/\{\{client_id\}\}/,encodeURIComponent(this.clientId));else{let I=new k.LE({encoder:new H});m&&(I=I.set("id_token_hint",m));const x=this.postLogoutRedirectUri||this.redirectUriAsPostLogoutRedirectUriFallback&&this.redirectUri||"";x&&(I=I.set("post_logout_redirect_uri",x),f&&(I=I.set("state",f)));for(let J in a)I=I.set(J,a[J]);E=this.logoutUrl+(this.logoutUrl.indexOf("?")>-1?"&":"?")+I.toString()}this.config.openUri(E)}createAndSaveNonce(){const a=this;return this.createNonce().then(function(f){return a.saveNoncesInLocalStorage&&typeof window.localStorage<"u"?localStorage.setItem("nonce",f):a._storage.setItem("nonce",f),f})}ngOnDestroy(){this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.removeSilentRefreshEventListener();const a=this.document.getElementById(this.silentRefreshIFrameName);a&&a.remove(),this.stopSessionCheckTimer(),this.removeSessionCheckEventListener();const f=this.document.getElementById(this.sessionCheckIFrameName);f&&f.remove()}createNonce(){return new Promise(a=>{if(this.rngUrl)throw new Error("createNonce with rng-web-api has not been implemented so far");const f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~";let y=45,m="";const E=typeof self>"u"?null:self.crypto||self.msCrypto;if(E){let I=new Uint8Array(y);E.getRandomValues(I),I.map||(I.map=Array.prototype.map),I=I.map(x=>f.charCodeAt(x%f.length)),m=String.fromCharCode.apply(null,I)}else for(;0<y--;)m+=f[Math.random()*f.length|0];a(Je(m))})}checkAtHash(a){var f=this;return(0,h.Z)(function*(){return f.tokenValidationHandler?f.tokenValidationHandler.validateAtHash(a):(f.logger.warn("No tokenValidationHandler configured. Cannot check at_hash."),!0)})()}checkSignature(a){return this.tokenValidationHandler?this.tokenValidationHandler.validateSignature(a):(this.logger.warn("No tokenValidationHandler configured. Cannot check signature."),Promise.resolve(null))}initLoginFlow(a="",f={}){return"code"===this.responseType?this.initCodeFlow(a,f):this.initImplicitFlow(a,f)}initCodeFlow(a="",f={}){""!==this.loginUrl?this.initCodeFlowInternal(a,f):this.events.pipe((0,ue.h)(y=>"discovery_document_loaded"===y.type)).subscribe(y=>this.initCodeFlowInternal(a,f))}initCodeFlowInternal(a="",f={}){if(!this.validateUrlForHttps(this.loginUrl))throw new Error("loginUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");let y={},m=null;"string"==typeof f?m=f:"object"==typeof f&&(y=f),this.createLoginUrl(a,m,null,!1,y).then(this.config.openUri).catch(E=>{console.error("Error in initAuthorizationCodeFlow"),console.error(E)})}createChallangeVerifierPairForPKCE(){var a=this;return(0,h.Z)(function*(){if(!a.crypto)throw new Error("PKCE support for code flow needs a CryptoHander. Did you import the OAuthModule using forRoot() ?");const f=yield a.createNonce();return[Je(yield a.crypto.calcHash(f,"sha-256")),f]})()}extractRecognizedCustomParameters(a){let f=new Map;return this.config.customTokenParameters&&this.config.customTokenParameters.forEach(y=>{a[y]&&f.set(y,JSON.stringify(a[y]))}),f}revokeTokenAndLogout(a={},f=!1){let y=this.revocationEndpoint,m=this.getAccessToken(),E=this.getRefreshToken();if(!m)return Promise.resolve();let I=new k.LE({encoder:new H}),x=(new k.WM).set("Content-Type","application/x-www-form-urlencoded");if(this.useHttpBasicAuth){const J=btoa(`${this.clientId}:${this.dummyClientSecret}`);x=x.set("Authorization","Basic "+J)}if(this.useHttpBasicAuth||(I=I.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(I=I.set("client_secret",this.dummyClientSecret)),this.customQueryParams)for(const J of Object.getOwnPropertyNames(this.customQueryParams))I=I.set(J,this.customQueryParams[J]);return new Promise((J,X)=>{let L,Y;if(m){let $=I.set("token",m).set("token_type_hint","access_token");L=this.http.post(y,$,{headers:x})}else L=(0,K.of)(null);if(E){let $=I.set("token",E).set("token_type_hint","refresh_token");Y=this.http.post(y,$,{headers:x})}else Y=(0,K.of)(null);f&&(L=L.pipe((0,We.K)($=>0===$.status?(0,K.of)(null):(0,O._)($))),Y=Y.pipe((0,We.K)($=>0===$.status?(0,K.of)(null):(0,O._)($)))),(0,ut.a)([L,Y]).subscribe($=>{this.logOut(a),J($),this.logger.info("Token successfully revoked")},$=>{this.logger.error("Error revoking token",$),this.eventsSubject.next(new ye("token_revoke_error",$)),X($)})})}clearLocationHash(){""!=location.hash&&(location.hash="")}}return R.\u0275fac=function(a){return new(a||R)(T.\u0275\u0275inject(T.NgZone),T.\u0275\u0275inject(k.eN),T.\u0275\u0275inject(ke,8),T.\u0275\u0275inject(B,8),T.\u0275\u0275inject(at,8),T.\u0275\u0275inject(Q),T.\u0275\u0275inject(Le),T.\u0275\u0275inject(V,8),T.\u0275\u0275inject(A.K0),T.\u0275\u0275inject(Pt))},R.\u0275prov=T.\u0275\u0275defineInjectable({token:R,factory:R.\u0275fac}),R})();class Ft{}class vr{handleError(w){return(0,O._)(w)}}let yr=(()=>{class R{constructor(a,f,y){this.oAuthService=a,this.errorHandler=f,this.moduleConfig=y}checkUrl(a){return this.moduleConfig.resourceServer.customUrlValidation?this.moduleConfig.resourceServer.customUrlValidation(a):!this.moduleConfig.resourceServer.allowedUrls||!!this.moduleConfig.resourceServer.allowedUrls.find(f=>a.toLowerCase().startsWith(f.toLowerCase()))}intercept(a,f){const y=a.url.toLowerCase();return this.moduleConfig&&this.moduleConfig.resourceServer&&this.checkUrl(y)?this.moduleConfig.resourceServer.sendAccessToken?(0,dt.T)((0,K.of)(this.oAuthService.getAccessToken()).pipe((0,ue.h)(E=>!!E)),this.oAuthService.events.pipe((0,ue.h)(E=>"token_received"===E.type),function Ue(R,w){const{first:a,each:f,with:y=oe,scheduler:m=w??se.z,meta:E=null}=(0,Ht.q)(R)?{first:R}:"number"==typeof R?{each:R}:R;if(null==a&&null==f)throw new TypeError("No timeout provided.");return(0,W.e)((I,x)=>{let J,X,L=null,Y=0;const $=ce=>{X=(0,St.f)(x,m,()=>{try{J.unsubscribe(),(0,_e.Xf)(y({meta:E,lastValue:L,seen:Y})).subscribe(x)}catch(Re){x.error(Re)}},ce)};J=I.subscribe((0,D.x)(x,ce=>{X?.unsubscribe(),Y++,x.next(L=ce),f>0&&$(f)},void 0,void 0,()=>{X?.closed||X?.unsubscribe(),L=null})),!Y&&$(null!=a?"number"==typeof a?a:+a-m.now():f)})}(this.oAuthService.waitForTokenInMsec||0),(0,We.K)(E=>(0,K.of)(null)),(0,Ze.U)(E=>this.oAuthService.getAccessToken()))).pipe((0,z.q)(1),(0,b.z)(E=>{if(E){const x=a.headers.set("Authorization","Bearer "+E);a=a.clone({headers:x})}return f.handle(a).pipe((0,We.K)(I=>this.errorHandler.handleError(I)))})):f.handle(a).pipe((0,We.K)(E=>this.errorHandler.handleError(E))):f.handle(a)}}return R.\u0275fac=function(a){return new(a||R)(T.\u0275\u0275inject(nr),T.\u0275\u0275inject(Ft),T.\u0275\u0275inject(Ve,8))},R.\u0275prov=T.\u0275\u0275defineInjectable({token:R,factory:R.\u0275fac}),R})();function Ke(){return console}function Bt(){return typeof sessionStorage<"u"?sessionStorage:new ge}function or(R=null,w=et){return(0,T.makeEnvironmentProviders)([nr,Q,{provide:Le,useFactory:Ke},{provide:ke,useFactory:Bt},{provide:B,useClass:w},{provide:V,useClass:Ot},{provide:Ft,useClass:vr},{provide:Ve,useValue:R},{provide:k.TP,useClass:yr,multi:!0},{provide:Pt,useClass:Rt}])}let Er=(()=>{class R{static forRoot(a=null,f=et){return{ngModule:R,providers:[or(a,f)]}}}return R.\u0275fac=function(a){return new(a||R)},R.\u0275mod=T.\u0275\u0275defineNgModule({type:R}),R.\u0275inj=T.\u0275\u0275defineInjector({imports:[A.ez]}),R})();new T.InjectionToken("AUTH_CONFIG")},94700:(st,U,l)=>{"use strict";l.d(U,{We:()=>le,YC:()=>ut,dw:()=>dt});var h=l(41571),T=l(36895),A=l(77579);const k=new h.InjectionToken("recaptcha-language"),P=new h.InjectionToken("recaptcha-base-url"),K=new h.InjectionToken("recaptcha-nonce-tag"),le=(new h.InjectionToken("recaptcha-settings"),new h.InjectionToken("recaptcha-v3-site-key")),Ae_loadScript=function _e(Te,se,j,z,W){window.ng2recaptchaloaded=()=>{se(grecaptcha)};const Ce=document.createElement("script");Ce.innerHTML="",Ce.src=`${z||"https://www.google.com/recaptcha/api.js"}?render=${Te}&onload=ng2recaptchaloaded${j}`,W&&(Ce.nonce=W),Ce.async=!0,Ce.defer=!0,document.head.appendChild(Ce)};let ut=(()=>{class Te{constructor(j,z,W,Ce,v,fe){this.onLoadComplete=b=>{this.grecaptcha=b,this.actionBacklog&&this.actionBacklog.length>0&&(this.actionBacklog.forEach(([M,G])=>this.executeActionWithSubject(M,G)),this.actionBacklog=void 0)},this.zone=j,this.isBrowser=(0,T.NF)(W),this.siteKey=z,this.nonce=v,this.language=fe,this.baseUrl=Ce,this.init()}get onExecute(){return this.onExecuteSubject||(this.onExecuteSubject=new A.x,this.onExecuteObservable=this.onExecuteSubject.asObservable()),this.onExecuteObservable}get onExecuteError(){return this.onExecuteErrorSubject||(this.onExecuteErrorSubject=new A.x,this.onExecuteErrorObservable=this.onExecuteErrorSubject.asObservable()),this.onExecuteErrorObservable}execute(j){const z=new A.x;return this.isBrowser&&(this.grecaptcha?this.executeActionWithSubject(j,z):(this.actionBacklog||(this.actionBacklog=[]),this.actionBacklog.push([j,z]))),z.asObservable()}executeActionWithSubject(j,z){const W=Ce=>{this.zone.run(()=>{z.error(Ce),this.onExecuteErrorSubject&&this.onExecuteErrorSubject.next({action:j,error:Ce})})};this.zone.runOutsideAngular(()=>{try{this.grecaptcha.execute(this.siteKey,{action:j}).then(Ce=>{this.zone.run(()=>{z.next(Ce),z.complete(),this.onExecuteSubject&&this.onExecuteSubject.next({action:j,token:Ce})})},W)}catch(Ce){W(Ce)}})}init(){this.isBrowser&&("grecaptcha"in window?this.grecaptcha=grecaptcha:Ae_loadScript(this.siteKey,this.onLoadComplete,this.language?"&hl="+this.language:"",this.baseUrl,this.nonce))}}return Te.\u0275fac=function(j){return new(j||Te)(h.\u0275\u0275inject(h.NgZone),h.\u0275\u0275inject(le),h.\u0275\u0275inject(h.PLATFORM_ID),h.\u0275\u0275inject(P,8),h.\u0275\u0275inject(K,8),h.\u0275\u0275inject(k,8))},Te.\u0275prov=h.\u0275\u0275defineInjectable({token:Te,factory:Te.\u0275fac}),Te})(),dt=(()=>{class Te{}return Te.\u0275fac=function(j){return new(j||Te)},Te.\u0275mod=h.\u0275\u0275defineNgModule({type:Te}),Te.\u0275inj=h.\u0275\u0275defineInjector({providers:[ut]}),Te})()},73425:(st,U,l)=>{"use strict";l.d(U,{QK:()=>se,gz:()=>Ce});var h=l(41571),T=l(36895),A=l(37340),k=l(24006),P=l(19592),K=l(10805),ne=l(60982),le=l(51740);const _e=["input"];function Ae(v,fe){if(1&v){const b=h.\u0275\u0275getCurrentView();h.\u0275\u0275elementStart(0,"i",5),h.\u0275\u0275listener("click",function(){h.\u0275\u0275restoreView(b);const G=h.\u0275\u0275nextContext();return h.\u0275\u0275resetView(G.clear())}),h.\u0275\u0275elementEnd()}}function he(v,fe){if(1&v){const b=h.\u0275\u0275getCurrentView();h.\u0275\u0275elementStart(0,"i",6),h.\u0275\u0275listener("click",function(){h.\u0275\u0275restoreView(b);const G=h.\u0275\u0275nextContext();return h.\u0275\u0275resetView(G.onMaskToggle())}),h.\u0275\u0275pipe(1,"mapper"),h.\u0275\u0275elementEnd()}if(2&v){const b=h.\u0275\u0275nextContext();h.\u0275\u0275property("ngClass",h.\u0275\u0275pipeBind2(1,1,b.unmasked,b.toggleIconClass))}}function D(v,fe){1&v&&h.\u0275\u0275elementContainer(0)}function mt(v,fe){1&v&&h.\u0275\u0275elementContainer(0)}function p(v,fe){if(1&v&&(h.\u0275\u0275elementContainerStart(0),h.\u0275\u0275template(1,mt,1,0,"ng-container",8),h.\u0275\u0275elementContainerEnd()),2&v){const b=h.\u0275\u0275nextContext(2);h.\u0275\u0275advance(1),h.\u0275\u0275property("ngTemplateOutlet",b.contentTemplate)}}const O=function(v){return{width:v}};function ut(v,fe){if(1&v&&(h.\u0275\u0275elementStart(0,"div",11),h.\u0275\u0275element(1,"div",0),h.\u0275\u0275pipe(2,"mapper"),h.\u0275\u0275elementEnd(),h.\u0275\u0275elementStart(3,"div",12),h.\u0275\u0275text(4),h.\u0275\u0275elementEnd()),2&v){const b=h.\u0275\u0275nextContext(2);h.\u0275\u0275advance(1),h.\u0275\u0275property("ngClass",h.\u0275\u0275pipeBind2(2,3,b.meter,b.strengthClass))("ngStyle",h.\u0275\u0275pureFunction1(6,O,b.meter?b.meter.width:"")),h.\u0275\u0275advance(3),h.\u0275\u0275textInterpolate(b.infoText)}}function dt(v,fe){1&v&&h.\u0275\u0275elementContainer(0)}const ue=function(v,fe){return{showTransitionParams:v,hideTransitionParams:fe}},qe=function(v){return{value:"visible",params:v}};function Te(v,fe){if(1&v){const b=h.\u0275\u0275getCurrentView();h.\u0275\u0275elementStart(0,"div",6,7),h.\u0275\u0275listener("click",function(G){h.\u0275\u0275restoreView(b);const ae=h.\u0275\u0275nextContext();return h.\u0275\u0275resetView(ae.onOverlayClick(G))})("@overlayAnimation.start",function(G){h.\u0275\u0275restoreView(b);const ae=h.\u0275\u0275nextContext();return h.\u0275\u0275resetView(ae.onAnimationStart(G))})("@overlayAnimation.done",function(G){h.\u0275\u0275restoreView(b);const ae=h.\u0275\u0275nextContext();return h.\u0275\u0275resetView(ae.onAnimationEnd(G))}),h.\u0275\u0275template(2,D,1,0,"ng-container",8),h.\u0275\u0275template(3,p,2,1,"ng-container",9),h.\u0275\u0275template(4,ut,5,8,"ng-template",null,10,h.\u0275\u0275templateRefExtractor),h.\u0275\u0275template(6,dt,1,0,"ng-container",8),h.\u0275\u0275elementEnd()}if(2&v){const b=h.\u0275\u0275reference(5),M=h.\u0275\u0275nextContext();h.\u0275\u0275property("ngClass","p-password-panel p-component")("@overlayAnimation",h.\u0275\u0275pureFunction1(9,qe,h.\u0275\u0275pureFunction2(6,ue,M.showTransitionOptions,M.hideTransitionOptions))),h.\u0275\u0275advance(2),h.\u0275\u0275property("ngTemplateOutlet",M.headerTemplate),h.\u0275\u0275advance(1),h.\u0275\u0275property("ngIf",M.contentTemplate)("ngIfElse",b),h.\u0275\u0275advance(3),h.\u0275\u0275property("ngTemplateOutlet",M.footerTemplate)}}let se=(()=>{class v{constructor(b,M){this.el=b,this.zone=M,this.promptLabel="Enter a password",this.weakLabel="Weak",this.mediumLabel="Medium",this.strongLabel="Strong",this.feedback=!0}set showPassword(b){this.el.nativeElement.type=b?"text":"password"}ngDoCheck(){this.updateFilledState()}onInput(b){this.updateFilledState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}createPanel(){this.panel=document.createElement("div"),this.panel.className="p-password-panel p-component p-password-panel-overlay p-connected-overlay",this.meter=document.createElement("div"),this.meter.className="p-password-meter",this.info=document.createElement("div"),this.info.className="p-password-info",this.info.textContent=this.promptLabel,this.panel.appendChild(this.meter),this.panel.appendChild(this.info),this.panel.style.minWidth=P.p.getOuterWidth(this.el.nativeElement)+"px",document.body.appendChild(this.panel)}showOverlay(){this.feedback&&(this.panel||this.createPanel(),this.panel.style.zIndex=String(++P.p.zindex),this.panel.style.display="block",this.zone.runOutsideAngular(()=>{setTimeout(()=>{P.p.addClass(this.panel,"p-connected-overlay-visible"),this.bindScrollListener(),this.bindDocumentResizeListener()},1)}),P.p.absolutePosition(this.panel,this.el.nativeElement))}hideOverlay(){this.feedback&&this.panel&&(P.p.addClass(this.panel,"p-connected-overlay-hidden"),P.p.removeClass(this.panel,"p-connected-overlay-visible"),this.unbindScrollListener(),this.unbindDocumentResizeListener(),this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.ngOnDestroy()},150)}))}onFocus(){this.showOverlay()}onBlur(){this.hideOverlay()}onKeyup(b){if(this.feedback){let G=b.target.value,ae=null,Z=null;if(0===G.length)ae=this.promptLabel,Z="0px 0px";else{var M=this.testStrength(G);M<30?(ae=this.weakLabel,Z="0px -10px"):M>=30&&M<80?(ae=this.mediumLabel,Z="0px -20px"):M>=80&&(ae=this.strongLabel,Z="0px -30px")}(!this.panel||!P.p.hasClass(this.panel,"p-connected-overlay-visible"))&&this.showOverlay(),this.meter.style.backgroundPosition=Z,this.info.textContent=ae}}testStrength(b){let G,M=0;return G=b.match("[0-9]"),M+=25*this.normalize(G?G.length:1/4,1),G=b.match("[a-zA-Z]"),M+=10*this.normalize(G?G.length:.5,3),G=b.match("[!@#$%^&*?_~.,;=]"),M+=35*this.normalize(G?G.length:1/6,1),G=b.match("[A-Z]"),M+=30*this.normalize(G?G.length:1/6,1),M*=b.length/8,M>100?100:M}normalize(b,M){return b-M<=0?b/M:1+b/(b+M/4)*.5}get disabled(){return this.el.nativeElement.disabled}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new P.V(this.el.nativeElement,()=>{P.p.hasClass(this.panel,"p-connected-overlay-visible")&&this.hideOverlay()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}bindDocumentResizeListener(){this.documentResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.documentResizeListener)}unbindDocumentResizeListener(){this.documentResizeListener&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}onWindowResize(){P.p.isTouchDevice()||this.hideOverlay()}ngOnDestroy(){this.panel&&(this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.unbindDocumentResizeListener(),document.body.removeChild(this.panel),this.panel=null,this.meter=null,this.info=null)}}return v.\u0275fac=function(b){return new(b||v)(h.\u0275\u0275directiveInject(h.ElementRef),h.\u0275\u0275directiveInject(h.NgZone))},v.\u0275dir=h.\u0275\u0275defineDirective({type:v,selectors:[["","pPassword",""]],hostAttrs:[1,"p-inputtext","p-component","p-element"],hostVars:2,hostBindings:function(b,M){1&b&&h.\u0275\u0275listener("input",function(ae){return M.onInput(ae)})("focus",function(){return M.onFocus()})("blur",function(){return M.onBlur()})("keyup",function(ae){return M.onKeyup(ae)}),2&b&&h.\u0275\u0275classProp("p-filled",M.filled)},inputs:{promptLabel:"promptLabel",weakLabel:"weakLabel",mediumLabel:"mediumLabel",strongLabel:"strongLabel",feedback:"feedback",showPassword:"showPassword"}}),v})(),j=(()=>{class v{transform(b,M,...G){return M(b,...G)}}return v.\u0275fac=function(b){return new(b||v)},v.\u0275pipe=h.\u0275\u0275definePipe({name:"mapper",type:v,pure:!0}),v})();const z={provide:k.NG_VALUE_ACCESSOR,useExisting:(0,h.forwardRef)(()=>W),multi:!0};let W=(()=>{class v{constructor(b,M,G,ae){this.cd=b,this.config=M,this.el=G,this.overlayService=ae,this.mediumRegex="^(((?=.*[a-z])(?=.*[A-Z]))|((?=.*[a-z])(?=.*[0-9]))|((?=.*[A-Z])(?=.*[0-9])))(?=.{6,})",this.strongRegex="^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,})",this.feedback=!0,this.showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)",this.hideTransitionOptions=".1s linear",this.showClear=!1,this.onFocus=new h.EventEmitter,this.onBlur=new h.EventEmitter,this.onClear=new h.EventEmitter,this.overlayVisible=!1,this.focused=!1,this.unmasked=!1,this.value=null,this.onModelChange=()=>{},this.onModelTouched=()=>{}}ngAfterContentInit(){this.templates.forEach(b=>{switch(b.getType()){case"content":default:this.contentTemplate=b.template;break;case"header":this.headerTemplate=b.template;break;case"footer":this.footerTemplate=b.template}})}ngOnInit(){this.infoText=this.promptText(),this.mediumCheckRegExp=new RegExp(this.mediumRegex),this.strongCheckRegExp=new RegExp(this.strongRegex),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.updateUI(this.value||"")})}onAnimationStart(b){switch(b.toState){case"visible":this.overlay=b.element,ne.P9.set("overlay",this.overlay,this.config.zIndex.overlay),this.appendContainer(),this.alignOverlay(),this.bindScrollListener(),this.bindResizeListener();break;case"void":this.unbindScrollListener(),this.unbindResizeListener(),this.overlay=null}}onAnimationEnd(b){"void"===b.toState&&ne.P9.clear(b.element)}appendContainer(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.overlay):document.getElementById(this.appendTo).appendChild(this.overlay))}alignOverlay(){this.appendTo?(this.overlay.style.minWidth=P.p.getOuterWidth(this.input.nativeElement)+"px",P.p.absolutePosition(this.overlay,this.input.nativeElement)):P.p.relativePosition(this.overlay,this.input.nativeElement)}onInput(b){this.value=b.target.value,this.onModelChange(this.value),this.onModelTouched()}onInputFocus(b){this.focused=!0,this.feedback&&(this.overlayVisible=!0),this.onFocus.emit(b)}onInputBlur(b){this.focused=!1,this.feedback&&(this.overlayVisible=!1),this.onBlur.emit(b)}onKeyDown(b){"Escape"===b.key&&(this.overlayVisible=!1)}onKeyUp(b){this.feedback&&(this.updateUI(b.target.value),this.overlayVisible||(this.overlayVisible=!0))}updateUI(b){let M=null,G=null;switch(this.testStrength(b)){case 1:M=this.weakText(),G={strength:"weak",width:"33.33%"};break;case 2:M=this.mediumText(),G={strength:"medium",width:"66.66%"};break;case 3:M=this.strongText(),G={strength:"strong",width:"100%"};break;default:M=this.promptText(),G=null}this.meter=G,this.infoText=M}onMaskToggle(){this.unmasked=!this.unmasked}onOverlayClick(b){this.overlayService.add({originalEvent:b,target:this.el.nativeElement})}testStrength(b){let M=0;return this.strongCheckRegExp.test(b)?M=3:this.mediumCheckRegExp.test(b)?M=2:b.length&&(M=1),M}writeValue(b){this.value=void 0===b?null:b,this.feedback&&this.updateUI(this.value||""),this.cd.markForCheck()}registerOnChange(b){this.onModelChange=b}registerOnTouched(b){this.onModelTouched=b}setDisabledState(b){this.disabled=b}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new P.V(this.input.nativeElement,()=>{this.overlayVisible&&(this.overlayVisible=!1)})),this.scrollHandler.bindScrollListener()}bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.overlayVisible&&!P.p.isTouchDevice()&&(this.overlayVisible=!1)},window.addEventListener("resize",this.resizeListener))}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)}containerClass(b){return{"p-password p-component p-inputwrapper":!0,"p-input-icon-right":b}}inputFieldClass(b){return{"p-password-input":!0,"p-disabled":b}}toggleIconClass(b){return b?"pi pi-eye-slash":"pi pi-eye"}strengthClass(b){return`p-password-strength ${b?b.strength:""}`}filled(){return null!=this.value&&this.value.toString().length>0}promptText(){return this.promptLabel||this.getTranslation(K.ws.PASSWORD_PROMPT)}weakText(){return this.weakLabel||this.getTranslation(K.ws.WEAK)}mediumText(){return this.mediumLabel||this.getTranslation(K.ws.MEDIUM)}strongText(){return this.strongLabel||this.getTranslation(K.ws.STRONG)}restoreAppend(){this.overlay&&this.appendTo&&("body"===this.appendTo?document.body.removeChild(this.overlay):document.getElementById(this.appendTo).removeChild(this.overlay))}inputType(b){return b?"text":"password"}getTranslation(b){return this.config.getTranslation(b)}clear(){this.value=null,this.onModelChange(this.value),this.writeValue(this.value),this.onClear.emit()}ngOnDestroy(){this.overlay&&(ne.P9.clear(this.overlay),this.overlay=null),this.restoreAppend(),this.unbindResizeListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.translationSubscription&&this.translationSubscription.unsubscribe()}}return v.\u0275fac=function(b){return new(b||v)(h.\u0275\u0275directiveInject(h.ChangeDetectorRef),h.\u0275\u0275directiveInject(K.b4),h.\u0275\u0275directiveInject(h.ElementRef),h.\u0275\u0275directiveInject(K.F0))},v.\u0275cmp=h.\u0275\u0275defineComponent({type:v,selectors:[["p-password"]],contentQueries:function(b,M,G){if(1&b&&h.\u0275\u0275contentQuery(G,K.jx,4),2&b){let ae;h.\u0275\u0275queryRefresh(ae=h.\u0275\u0275loadQuery())&&(M.templates=ae)}},viewQuery:function(b,M){if(1&b&&h.\u0275\u0275viewQuery(_e,5),2&b){let G;h.\u0275\u0275queryRefresh(G=h.\u0275\u0275loadQuery())&&(M.input=G.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:8,hostBindings:function(b,M){2&b&&h.\u0275\u0275classProp("p-inputwrapper-filled",M.filled())("p-inputwrapper-focus",M.focused)("p-password-clearable",M.showClear)("p-password-mask",M.toggleMask)},inputs:{ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",label:"label",disabled:"disabled",promptLabel:"promptLabel",mediumRegex:"mediumRegex",strongRegex:"strongRegex",weakLabel:"weakLabel",mediumLabel:"mediumLabel",strongLabel:"strongLabel",inputId:"inputId",feedback:"feedback",appendTo:"appendTo",toggleMask:"toggleMask",inputStyleClass:"inputStyleClass",panelStyle:"panelStyle",panelStyleClass:"panelStyleClass",styleClass:"styleClass",style:"style",inputStyle:"inputStyle",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",placeholder:"placeholder",showClear:"showClear"},outputs:{onFocus:"onFocus",onBlur:"onBlur",onClear:"onClear"},features:[h.\u0275\u0275ProvidersFeature([z])],decls:9,vars:27,consts:[[3,"ngClass","ngStyle"],["pInputText","",3,"ngClass","ngStyle","value","input","focus","blur","keyup","keydown"],["input",""],["class","p-password-clear-icon pi pi-times",3,"click",4,"ngIf"],[3,"ngClass","click",4,"ngIf"],[1,"p-password-clear-icon","pi","pi-times",3,"click"],[3,"ngClass","click"],["overlay",""],[4,"ngTemplateOutlet"],[4,"ngIf","ngIfElse"],["content",""],[1,"p-password-meter"],["className","p-password-info"]],template:function(b,M){1&b&&(h.\u0275\u0275elementStart(0,"div",0),h.\u0275\u0275pipe(1,"mapper"),h.\u0275\u0275elementStart(2,"input",1,2),h.\u0275\u0275listener("input",function(ae){return M.onInput(ae)})("focus",function(ae){return M.onInputFocus(ae)})("blur",function(ae){return M.onInputBlur(ae)})("keyup",function(ae){return M.onKeyUp(ae)})("keydown",function(ae){return M.onKeyDown(ae)}),h.\u0275\u0275pipe(4,"mapper"),h.\u0275\u0275pipe(5,"mapper"),h.\u0275\u0275elementEnd(),h.\u0275\u0275template(6,Ae,1,0,"i",3),h.\u0275\u0275template(7,he,2,4,"i",4),h.\u0275\u0275template(8,Te,7,11,"div",4),h.\u0275\u0275elementEnd()),2&b&&(h.\u0275\u0275classMap(M.styleClass),h.\u0275\u0275property("ngClass",h.\u0275\u0275pipeBind2(1,18,M.toggleMask,M.containerClass))("ngStyle",M.style),h.\u0275\u0275advance(2),h.\u0275\u0275classMap(M.inputStyleClass),h.\u0275\u0275property("ngClass",h.\u0275\u0275pipeBind2(4,21,M.disabled,M.inputFieldClass))("ngStyle",M.inputStyle)("value",M.value),h.\u0275\u0275attribute("label",M.label)("aria-label",M.ariaLabel)("aria-labelledBy",M.ariaLabelledBy)("id",M.inputId)("type",h.\u0275\u0275pipeBind2(5,24,M.unmasked,M.inputType))("placeholder",M.placeholder),h.\u0275\u0275advance(4),h.\u0275\u0275property("ngIf",M.showClear&&null!=M.value),h.\u0275\u0275advance(1),h.\u0275\u0275property("ngIf",M.toggleMask),h.\u0275\u0275advance(1),h.\u0275\u0275property("ngIf",M.overlayVisible))},dependencies:[T.mk,T.O5,T.tP,T.PC,le.o,j],styles:[".p-password{position:relative;display:inline-flex}.p-password-panel{position:absolute;top:0;left:0}.p-password .p-password-panel{min-width:100%}.p-password-meter{height:10px}.p-password-strength{height:100%;width:0%;transition:width 1s ease-in-out}.p-fluid .p-password{display:flex}.p-password-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-password-clearable{position:relative}\n"],encapsulation:2,data:{animation:[(0,A.X$)("overlayAnimation",[(0,A.eR)(":enter",[(0,A.oB)({opacity:0,transform:"scaleY(0.8)"}),(0,A.jt)("{{showTransitionParams}}")]),(0,A.eR)(":leave",[(0,A.jt)("{{hideTransitionParams}}",(0,A.oB)({opacity:0}))])])]},changeDetection:0}),v})(),Ce=(()=>{class v{}return v.\u0275fac=function(b){return new(b||v)},v.\u0275mod=h.\u0275\u0275defineNgModule({type:v}),v.\u0275inj=h.\u0275\u0275defineInjector({imports:[T.ez,le.j,K.m8]}),v})()}}]);