"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[84330],{84330:(A,d,i)=>{i.r(d),i.d(d,{PaypalPurchaseModule:()=>R});var u=i(60263),o=i(91170),m=i(58127),y=i(32351),h=i(64369),v=i(84232),l=i(37857),e=i(41571),P=i(91363),p=i(36895),f=i(17806),g=i(73565);function I(n,s){if(1&n&&(e.\u0275\u0275elementStart(0,"div",13)(1,"span",14),e.\u0275\u0275element(2,"i",15),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",16)(4,"h4",17),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"span")(7,"p")(8,"span"),e.\u0275\u0275text(9),e.\u0275\u0275elementStart(10,"strong"),e.\u0275\u0275text(11),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(12,"br"),e.\u0275\u0275elementStart(13,"span"),e.\u0275\u0275text(14),e.\u0275\u0275elementStart(15,"strong"),e.\u0275\u0275text(16),e.\u0275\u0275elementEnd()()()()()()),2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1(" ",t.l("DemoPayPalAccount"),""),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1("",t.l("UserName"),": "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.config.demoUsername),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("",t.l("Password"),": "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.config.demoPassword)}}function b(n,s){if(1&n&&e.\u0275\u0275element(0,"div",18),2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("busyIf",t.paypalIsLoading)}}const x=[{path:"",component:(()=>{class n extends m.c{constructor(t,a,r,c,U,j){super(t),this._activatedRoute=a,this._payPalPaymentAppService=r,this._paymentAppService=c,this._router=U,this._tenantRegistrationHelper=j,this.paypalIsLoading=!0,this.subscriptionPaymentGateway=l.UWJ,this.totalAmount=0,this.description=""}ngOnInit(){this.setTenantIdCookieIfNeeded(),this.paymentId=this._activatedRoute.snapshot.queryParams.paymentId,this.redirectUrl=this._activatedRoute.snapshot.queryParams.redirectUrl,this._payPalPaymentAppService.getConfiguration().subscribe(t=>{this.config=t;let a=this.GetDisabledFundingsQueryString(t);(new y.$).load("https://www.paypal.com/sdk/js?client-id="+t.clientId+"&currency="+this.appSession.application.currency+a).then(()=>{this._paymentAppService.getPayment(this.paymentId).subscribe(r=>{this.description=r.description,this.totalAmount=r.amount,this.successCallbackUrl=r.successUrl,this.errorCallbackUrl=r.errorUrl,this.subscriptionPaymentGateway=r.gateway,this.paypalIsLoading=!1,this.preparePaypalButton()})})})}preparePaypalButton(){const t=this;window.paypal.Buttons({createOrder:function(a,r){return r.order.create({purchase_units:[{amount:{value:t.totalAmount,currency_code:t.appSession.application.currency}}]})},onApprove:function(a,r){t._payPalPaymentAppService.confirmPayment(t.paymentId,a.orderID).subscribe(()=>{v.I.ajax("post",t.successCallbackUrl+(t.successCallbackUrl.includes("?")?"&":"?")+"paymentId="+t.paymentId,null,null,c=>{t._tenantRegistrationHelper.registrationResult&&(t._tenantRegistrationHelper.registrationResult.isActive=!0),t._router.navigate([t.redirectUrl])})})}}).render("#paypal-button")}GetDisabledFundingsQueryString(t){return!t.disabledFundings||t.disabledFundings.length<=0?"":"&disable-funding="+t.disabledFundings.join()}setTenantIdCookieIfNeeded(){if(!this._activatedRoute.snapshot.queryParams.tenantId)return;let t=parseInt(this._activatedRoute.snapshot.queryParams.tenantId);abp.multiTenancy.setTenantIdCookie(t)}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(e.Injector),e.\u0275\u0275directiveInject(o.gz),e.\u0275\u0275directiveInject(l.ou5),e.\u0275\u0275directiveInject(l.KC),e.\u0275\u0275directiveInject(o.F0),e.\u0275\u0275directiveInject(P.K))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["paypal-purchase-component"]],inputs:{editionPaymentType:"editionPaymentType"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:23,vars:14,consts:[[1,"login-form"],[1,"card","card-bordered"],[1,"card-header","align-items-center"],[1,"fw-bolder","text-dark","fs-h4","fs-h1-lg"],[1,"card-body"],[1,"mb-5","row"],[1,"col-sm-4"],[1,"col-sm-8","text-end"],[1,"fw-bold"],["id","totalPrice",1,"fw-bold"],["class","alert bg-light-primary d-flex align-items-center p-5 mb-10",4,"ngIf"],["id","paypal-button"],[3,"busyIf",4,"ngIf"],[1,"alert","bg-light-primary","d-flex","align-items-center","p-5","mb-10"],[1,"svg-icon","svg-icon-2hx","svg-icon-primary","me-4"],[1,"fas","fa-info-circle","fs-1"],[1,"d-flex","flex-column"],[1,"mb-1","text-primary"],[3,"busyIf"]],template:function(t,a){1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"div",4)(7,"div",5)(8,"label",6),e.\u0275\u0275text(9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"div",7)(11,"p",8),e.\u0275\u0275text(12),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(13,"div",5)(14,"label",6),e.\u0275\u0275text(15),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"div",7)(17,"p",9),e.\u0275\u0275text(18),e.\u0275\u0275pipe(19,"number"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(20,I,17,5,"div",10),e.\u0275\u0275element(21,"div",11),e.\u0275\u0275template(22,b,1,1,"div",12),e.\u0275\u0275elementEnd()()()),2&t&&(e.\u0275\u0275property("@routerTransition",void 0),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(5,9,"TenantSignUp")," "),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(a.l("Item")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",a.description," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(a.l("Price")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate2(" ",a.appSession.application.currencySign,"",e.\u0275\u0275pipeBind2(19,11,a.totalAmount,"1.2-2")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",a.config&&a.config.demoUsername&&a.config.demoPassword),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",a.paypalIsLoading))},dependencies:[p.O5,f.U,p.JJ,g.F],encapsulation:2,data:{animation:[(0,h.RP)()]}}),n})(),pathMatch:"full"}];let S=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({imports:[o.Bz.forChild(x),o.Bz]}),n})();var C=i(12749);let R=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({imports:[u.o,C.y,S]}),n})()}}]);